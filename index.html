<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Slang Language Specification</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in § N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *     -> ins/del.c### for candidate and proposed changes (amendments)
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *   - .correction for "candidate corrections"       (div, aside, details, section)
 *   - .addition   for "candidate additions"         (div, aside, details, section)
 *   - .correction.proposed for "proposed corrections" (div, aside, details, section)
 *   - .addition.proposed   for "proposed additions"   (div, aside, details, section)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Outdated warning for old specs
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/* color variables included separately for reliability */

/******************************************************************************/
/*                                    Body                                    */
/******************************************************************************/

	html {
	}

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;			  /* limit line length to 50em for readability   */
		margin: 0 auto;				/* center text within page                    */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag    */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		color: black;
		color: var(--text);
		background: white top left fixed no-repeat;
		background: var(--bg) top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em; }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border: solid var(--logo-bg);
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		background: var(--logo-bg);
		color: white;
		color: var(--logo-text);
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		background: var(--logo-active-bg);
		border-color: #c00;
		border-color: var(--logo-active-bg);
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small; }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 3;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;

			color: #707070;
			color: var(--tocnav-normal-text);
			background: white;
			background: var(--tocnav-normal-bg);
		}
		#toc-nav > a:hover,
		#toc-nav > a:focus {
			color: black;
			color: var(--tocnav-hover-text);
			background: #f8f8f8;
			background: var(--tocnav-hover-bg);
		}
		#toc-nav > a:active {
			color: #c00;
			color: var(--tocnav-active-text);
			background: white;
			background: var(--tocnav-active-bg);
		}

		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			color: black;
			color: var(--tocsidebar-text);
			background: inherit;
			background-color: #f7f8f9;
			background-color: var(--tocsidebar-bg);
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
			box-shadow: -.1em 0 .25em var(--tocsidebar-shadow) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
			color: var(--tocsidebar-heading-text);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			color: black;
			color: var(--tocsidebar-text);
			background: inherit;
			background-color: #f7f8f9;
			background-color: var(--tocsidebar-bg);
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
			box-shadow: -.1em 0 .25em var(--tocsidebar-shadow) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
			color: var(--tocsidebar-heading-text);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;	/* Inherit the font family. */
		line-height: 1.2;		/* Keep wrapped headings compact */
		hyphens: manual;		/* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		color: var(--heading-text);
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#profile-and-date {
		/* #profile-and-date is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > :not(.head) + hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		color: black;
		color: var(--hr-text);
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	border-left: 0.5em solid #DEF;
	border-left: 0.5em solid var(--algo-border);
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	 padding: .5em;
	 border: thin solid #ddd;
	 border: thin solid var(--algo-border);
	 border-radius: .5em;
	 margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	 margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	 margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	margin-left: -2em;
	}
	dl.switch {
	padding-left: 2em;
	}
	dl.switch > dt {
	text-indent: -1.5em;
	margin-top: 1em;
	}
	dl.switch > dt + dt {
	margin-top: 0;
	}
	dl.switch > dt::before {
	content: '\21AA';
	padding: 0 0.5em 0 0;
	display: inline-block;
	width: 1em;
	text-align: right;
	line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: inherit;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del {
		color: #aa0000;
		color: var(--del-text);
		background: transparent;
		background: var(--del-bg);
		text-decoration: line-through;
	}
	ins {
		color: #006100;
		color: var(--ins-text);
		background: transparent;
		background: var(--ins-bg);
		text-decoration: underline;
	}

	/* for amendments (candidate/proposed changes) */

	.amendment ins, .correction ins, .addition ins,
	ins[class^=c] {
		text-decoration-style: dotted;
	}
	.amendment del, .correction del, .addition del,
	del[class^=c] {
		text-decoration-style: dotted;
	}
	.amendment.proposed ins, .correction.proposed ins, .addition.proposed ins,
	ins[class^=c].proposed {
		text-decoration-style: double;
	}
	.amendment.proposed del, .correction.proposed del, .addition.proposed del,
	del[class^=c].proposed {
		text-decoration-style: double;
	}

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		hyphens: none;
		text-transform: none;
		text-align: left;
		text-align: start;
		font-variant: normal;
		orphans: 3;
		widows: 3;
		page-break-before: avoid;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

	/* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		color: var(--a-normal-text);
		text-decoration: underline #707070;
		text-decoration: underline var(--a-normal-underline);
		text-decoration-skip-ink: none;
	}
	a:visited {
		color: #034575;
		color: var(--a-visited-text);
		text-decoration-color: #bbb;
		text-decoration-color: var(--a-visited-underline);
	}

	/* Indicate interaction with the link */
	a[href]:focus,
	a[href]:hover {
		text-decoration-thickness: 2px;
	}
	a[href]:active {
		color: #c00;
		color: var(--a-active-text);
		text-decoration-color: #c00;
		text-decoration-color: var(--a-active-underline);
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	img, svg {
		/* Intentionally not color-scheme aware. */
		background: white;
	}

	/* For autogen numbers, add
	  .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,	.sidefigure img,	figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
		height: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em;
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em; }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote,
	.amendment, .correction, .addition {
		margin: 1em auto;
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	blockquote > :first-child,
	.note  > p:first-child,
	.issue > p:first-child,
	.amendment > p:first-child,
	.correction > p:first-child,
	.addition > p:first-child {
		margin-top: 0;
	}
	blockquote > :last-child,
	.note  > p:last-child,
	.issue > p:last-child,
	.amendment > p:last-child,
	.correction > p:last-child,
	.addition > p:last-child {
		margin-bottom: 0;
	}


	.issue::before, .issue > .marker,
	.example::before, .example > .marker,
	.note::before, .note > .marker,
	details.note > summary > .marker,
	.amendment::before, .amendment > .marker,
	details.amendment > summary > .marker,
	.addition::before, .addition > .marker,
	addition.amendment > summary > .marker,
	.correction::before, .correction > .marker,
	correction.amendment > summary > .marker
	{
		text-transform: uppercase;
		padding-right: 1em;
	}

	.example::before, .example > .marker {
		display: block;
		padding-right: 0em;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
		border-color: var(--blockquote-border);
		background: transparent;
		background: var(--blockquote-bg);
		color: currentcolor;
		color: var(--blockquote-text);
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #e05252;
		border-color: var(--issue-border);
		background: #fbe9e9;
		background: var(--issue-bg);
		color: black;
		color: var(--issue-text);
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		color: #831616;
		color: var(--issueheading-text);
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	  or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #e0cb52;
		border-color: var(--example-border);
		background: #fcfaee;
		background: var(--example-bg);
		color: black;
		color: var(--example-text);
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		color: #574b0f;
		color: var(--exampleheading-text);
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	  or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52e052;
		border-color: var(--note-border);
		background: #e9fbe9;
		background: var(--note-bg);
		color: black;
		color: var(--note-text);
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary {
		color: hsl(120, 70%, 30%);
		color: var(--noteheading-text);
	}
	/* Add .note::before { content: "Note "; } for autogen label,
	  or use class="marker" to mark up the label in source. */

	details.note[open] > summary {
		border-bottom: 1px silver solid;
		border-bottom: 1px var(--notesummary-underline) solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		border-color: var(--assertion-border);
		background: #EEE;
		background: var(--assertion-bg);
		color: black;
		color: var(--assertion-text);
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-color: var(--advisement-border);
		border-style: none solid;
		background: #fec;
		background: var(--advisement-bg);
		color: black;
		color: var(--advisement-text);
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement::before, .advisement > .marker {
		color: #b35f00;
		color: var(--advisementheading-text);
	}

/** Amendment Box *************************************************************/

	.amendment, .correction, .addition {
		border-color: #330099;
		border-color: var(--amendment-border);
		background: #F5F0FF;
		background: var(--amendment-bg);
		color: black;
		color: var(--amendment-text);
	}
	.amendment.proposed, .correction.proposed, .addition.proposed {
		border-style: solid;
		border-block-width: 0.25em;
	}
	.amendment::before, .amendment > .marker,
	details.amendment > summary::before, details.amendment > summary > .marker,
	.correction::before, .correction > .marker,
	details.correction > summary::before, details.correction > summary > .marker,
	.addition::before, .addition > .marker,
	details.addition > summary::before, details.addition > summary > .marker {
		color: #220066;
		color: var(--amendmentheading-text);
	}
	.amendment.proposed::before, .amendment.proposed > .marker,
	details.amendment.proposed > summary::before, details.amendment.proposed > summary > .marker,
	.correction.proposed::before, .correction.proposed > .marker,
	details.correction.proposed > summary::before, details.correction.proposed > summary > .marker,
	.addition.proposed::before, .addition.proposed > .marker,
	details.addition.proposed > summary::before, details.addition.proposed > summary > .marker {
		font-weight: bold;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: hsla(40,100%,50%,0.95);
		background: var(--warning-bg);
		color: black;
		color: var(--warning-text);
		padding: .75em 1em;
		border: red;
		border: var(--warning-border);
		border-style: solid none;
		box-shadow: 0 2px 8px black;
		text-align: center;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 0;
		right: 0;
		bottom: 2em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #def;
		background: var(--def-bg);
		margin: 1.2em 0;
		border-left: 0.5em solid #8ccbf2;
		border-left: 0.5em solid var(--def-border);
		color: black;
		color: var(--def-text);
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
		border-bottom: 1px solid var(--defrow-border);
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def td.footnote {
		padding-top: 0.6em;
	}
	table.def td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		<table class="data"> highlights structural relationships in a table
		when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		Use class="complex data" for particularly complicated tables --
		(This will draw more lines: busier, but clearer.)

		Use class="long" on table cells with paragraph-like contents
		(This will adjust text alignment accordingly.)
		Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-color: var(--datacell-border);
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		border-top: 1px solid var(--datacell-border);
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		border: 1px solid var(--datacell-border);
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
		vertical-align: baseline;
		text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding: 0.1rem 1px 0;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Switch to using border-bottom for underlines */
		text-decoration: none;
		border-bottom: 1px solid;
		/* Reverse color scheme */
		color: black;
		color: var(--toclink-text);
		border-color: #3980b5;
		border-color: var(--toclink-underline);
	}
	.toc a:visited {
		color: black;
		color: var(--toclink-visited-text);
		border-color: #054572;
		border-color: var(--toclink-visited-underline);
	}
	.toc a:focus,
	.toc a:hover {
		background: rgba(75%, 75%, 75%, .25);
		background: var(--a-hover-bg);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
	}
	.toc {
		line-height: 1.1em;
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li			{ font-weight: bold;   }
	.toc > li li		 { font-weight: normal; }
	.toc > li li li	  { font-size:   95%;	}
	.toc > li li li li	{ font-size:   90%;	}
	.toc > li li li li li { font-size:   85%;	}

	/* @supports not (display:grid) { */
		.toc > li			{ margin: 1.5rem 0;	}
		.toc > li li		 { margin: 0.3rem 0;	}
		.toc > li li li	  { margin-left: 2rem;   }

		/* Section numbers in a column of their own */
		.toc .secno {
			float: left;
			width: 4rem;
			white-space: nowrap;
		}
		.toc > li li li li .secno { font-size: 85%; }
		.toc > li li li li li .secno { font-size: 100%; }

		.toc li {
			clear: both;
		}

		:not(li) > .toc			 { margin-left:  5rem; }
		.toc .secno				 { margin-left: -5rem; }
		.toc > li li li .secno	  { margin-left: -7rem; }
		.toc > li li li li .secno	{ margin-left: -9rem; }
		.toc > li li li li li .secno { margin-left: -11rem; }

		/* Tighten up indentation in narrow ToCs */
		@media (max-width: 30em) {
			:not(li) > .toc			 { margin-left:  4rem; }
			.toc .secno				 { margin-left: -4rem; }
			.toc > li li li			 { margin-left:  1rem; }
			.toc > li li li .secno	  { margin-left: -5rem; }
			.toc > li li li li .secno	{ margin-left: -6rem; }
			.toc > li li li li li .secno { margin-left: -7rem; }
		}
		/* Loosen it on wide screens */
		@media screen and (min-width: 78em) {
			body:not(.toc-inline) :not(li) > .toc			 { margin-left:  4rem; }
			body:not(.toc-inline) .toc .secno				 { margin-left: -4rem; }
			body:not(.toc-inline) .toc > li li li			 { margin-left:  1rem; }
			body:not(.toc-inline) .toc > li li li .secno	  { margin-left: -5rem; }
			body:not(.toc-inline) .toc > li li li li .secno	{ margin-left: -6rem; }
			body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	/* } */

	@supports (display:grid) and (display:contents) {
		/* Use #toc over .toc to override non-@supports rules. */
		#toc {
			display: grid;
			align-content: start;
			grid-template-columns: auto 1fr;
			grid-column-gap: 1rem;
			column-gap: 1rem;
			grid-row-gap: .6rem;
			row-gap: .6rem;
		}
		#toc h2 {
			grid-column: 1 / -1;
			margin-bottom: 0;
		}
		#toc ol,
		#toc li,
		#toc a {
			display: contents;
			/* Switch <a> to subgrid when supported */
		}
		#toc span {
			margin: 0;
		}
		#toc > .toc > li > a > span {
			/* The spans of the top-level list,
			  comprising the first items of each top-level section. */
			margin-top: 1.1rem;
		}
		#toc#toc .secno { /* Ugh, need more specificity to override base.css */
			grid-column: 1;
			width: auto;
			margin-left: 0;
		}
		#toc .content {
			grid-column: 2;
			width: auto;
			margin-right: 1rem;
			border-bottom: 3px solid transparent;
			margin-bottom: -3px;
		}
		#toc .content:hover,
		#toc .content:focus {
			background: rgba(75%, 75%, 75%, .25);
			background: var(--a-hover-bg);
			border-bottom-color: #054572;
			border-bottom-color: var(--toclink-underline);
		}
		#toc li li li .content {
			margin-left: 1rem;
		}
		#toc li li li li .content {
			margin-left: 2rem;
		}
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index	  { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li	{ margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em; }
	ul.index dl	{ margin-top: 0; }
	ul.index dt	{ margin: .2em 0 .2em 20px;}
	ul.index dd	{ margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li a + span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
			color: var(--indexinfo-text);
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		color: black;
		color: var(--indextable-hover-text);
		background: #f7f8f9;
		background: var(--indextable-hover-bg);
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/** Outdated warning **********************************************************/

.outdated-spec {
	color: black;
	color: var(--outdatedspec-text);
	background-color: rgba(0,0,0,0.5);
	background-color: var(--outdatedspec-bg);
}

.outdated-warning {
	position: fixed;
	bottom: 50%;
	left: 0;
	right: 0;
	margin: 0 auto;
	width: 50%;
	background: maroon;
	background: var(--outdated-bg);
	color: white;
	color: var(--outdated-text);
	border-radius: 1em;
	box-shadow: 0 0 1em red;
	box-shadow: 0 0 1em var(--outdated-shadow);
	padding: 2em;
	text-align: center;
	z-index: 2;
}

.outdated-warning a {
	color: currentcolor;
	background: transparent;
}

.edited-rec-warning {
	background: darkorange;
	background: var(--editedrec-bg);
	box-shadow: 0 0 1em;
}

.outdated-warning button {
	color: var(--outdated-text);
	border-radius: 1em;
	box-shadow: 0 0 1em red;
	box-shadow: 0 0 1em var(--outdated-shadow);
	padding: 2em;
	text-align: center;
	z-index: 2;
}

.outdated-warning a {
	color: currentcolor;
	background: transparent;
}

.edited-rec-warning {
	background: darkorange;
	background: var(--editedrec-bg);
	box-shadow: 0 0 1em;
}

.outdated-warning button {
	position: absolute;
	top: 0;
	right:0;
	margin: 0;
	border: 0;
	padding: 0.25em 0.5em;
	background: transparent;
	color: white;
	color: var(--outdated-text);
	font:1em sans-serif;
	text-align:center;
}

.outdated-warning span {
	display: block;
}

.outdated-collapsed {
	bottom: 0;
	border-radius: 0;
	width: 100%;
	padding: 0;
}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}

		.outdated-warning {
			position: absolute;
			border-style: solid;
			border-color: red;
		}

		.outdated-warning input {
			display: none;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge {
		/* Magic to create good item positioning:
		  "content column" is 50ems wide at max; less on smaller screens.
		  Extra space (after ToC + content) is empty on the right.

		  1. When item < content column, centers item in column.
		  2. When content < item < available, left-aligns.
		  3. When item > available, fills available + scroll bar.
		*/
		display: grid;
		grid-template-columns: minmax(0, 50em);
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			* http://lea.verou.me/2012/04/background-attachment-local/
			*
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
						top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
						top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
						top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
						white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <meta content="Bikeshed version 742f3d674, updated Mon Nov 4 14:56:54 2024 -0800" name="generator">
  <link href="https://github.com/shader-slang/spec/" rel="canonical">
  <meta content="18bfcc5fc48636e58d530532f2260fae3d35eb51" name="revision">
  <meta content="dark light" name="color-scheme">
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
    --dfnpanel-target-bg: #ffc;
    --dfnpanel-target-outline: orange;
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
        --dfnpanel-target-bg: #333;
        --dfnpanel-target-outline: silver;
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel a:focus {
    outline: 5px auto Highlight;
    outline: 5px auto -webkit-focus-ring-color;
}
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: 8px;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
    transition: left 1s ease-out, bottom 1s ease-out;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3px;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }

.highlighted {
    animation: target-fade 3s;
}

@keyframes target-fade {
    from {
        background-color: var(--dfnpanel-target-bg);
        outline: 5px solid var(--dfnpanel-target-outline);
    }
    to {
        color: var(--a-normal-text);
        background-color: transparent;
        outline: transparent;
    }
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-ref-hints */
:root {
    --ref-hint-bg: #ddd;
    --ref-hint-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --ref-hint-bg: #222;
        --ref-hint-text: var(--text);
    }
}

.ref-hint {
    display: inline-block;
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.5em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--ref-hint-bg);
    color: var(--ref-hint-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}

.ref-hint * { margin: 0; padding: 0; text-indent: 0; }

.ref-hint ul { padding: 0 0 0 1em; list-style: none; }
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-var-click-highlighting */
/*
Colors were chosen in Lab using https://nixsensor.com/free-color-converter/
D50 2deg illuminant, L in [0,100], a and b in [-128, 128]
0 = lab(85,0,85)
1 = lab(85,80,30)
2 = lab(85,-40,40)
3 = lab(85,-50,0)
4 = lab(85,5,15)
5 = lab(85,-10,-50)
6 = lab(85,35,-15)

For darkmode:
0 = oklab(50%   0%  108%)
1 = oklab(50% -51%   51%)
2 = oklab(50% -64%  -20%)
3 = oklab(50%   6%   19%)
4 = oklab(50% -12%  -64%)
5 = oklab(50%  44%  -19%)  
6 = oklab(50% 102%   38%)
*/

[data-algorithm] var { cursor: pointer; }
var[data-var-color] { background-color: var(--var-bg); box-shadow: 0 0 0 2px var(--var-bg); }

var[data-var-color] { --var-bg: #F4D200; }
var[data-var-color="1"] { --var-bg: #FF87A2; }
var[data-var-color="2"] { --var-bg: #96E885; }
var[data-var-color="3"] { --var-bg: #3EEED2; }
var[data-var-color="4"] { --var-bg: #EACFB6; }
var[data-var-color="5"] { --var-bg: #82DDFF; }
var[data-var-color="6"] { --var-vg: #FFBCF2; }

@media (prefers-color-scheme: dark) {
	var[data-var-color] { --var-bg: #bc1a00; }
	var[data-var-color="1"] { --var-bg: #007f00; }
	var[data-var-color="2"] { --var-bg: #008698; }
	var[data-var-color="3"] { --var-bg: #7f5b2b; }
	var[data-var-color="4"] { --var-bg: #004df3; }
	var[data-var-color="5"] { --var-bg: #a1248a; }
	var[data-var-color="6"] { --var-vg: #ff0000; }
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">Slang Language Specification</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="profile-and-date"><span class="content">Living Standard, <time class="dt-updated" datetime="2024-11-19">19 November 2024</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://github.com/shader-slang/spec/">https://github.com/shader-slang/spec/</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/shader-slang/spec/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-url url" href="https://tess-factor.com/">Theresa Foley</a> (<a class="p-org org" href="https://www.nvidia.com">NVIDIA</a>) <a class="u-email email" href="mailto:tfoley@nvidia.com">tfoley@nvidia.com</a>
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://creativecommons.org/publicdomain/zero/1.0/" rel="license"><img alt="CC0" height="15" src="https://licensebuttons.net/p/zero/1.0/80x15.png" width="80"></a> To the extent possible under law, the editors have waived all copyright
and related or neighboring rights to this work.
In addition, as of 19 November 2024,
the editors have made this specification available under the <a href="https://www.openwebfoundation.org/the-agreements/the-owf-1-0-agreements-granted-claims/owfa-1-0" rel="license">Open Web Foundation Agreement Version 1.0</a>,
which is available at https://www.openwebfoundation.org/the-agreements/the-owf-1-0-agreements-granted-claims/owfa-1-0.
Parts of this work may be from another specification document.  If so, those parts are instead covered by the license of that specification document. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>Slang is a programming language primarily intended for use in <em>shader programming</em>--that is, real-time graphics programming on GPUs.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#intro.scope"><span class="secno">1.1</span> <span class="content">Scope</span></a>
      <li><a href="#intro.conformance"><span class="secno">1.2</span> <span class="content">Conformance</span></a>
      <li><a href="#intro.stdlib"><span class="secno">1.3</span> <span class="content">The Slang Standard Library</span></a>
     </ol>
    <li>
     <a href="#lex"><span class="secno">2</span> <span class="content">Lexical Structure</span></a>
     <ol class="toc">
      <li><a href="#lex.source-unit"><span class="secno">2.1</span> <span class="content">Source Units</span></a>
      <li><a href="#lex.encoding"><span class="secno">2.2</span> <span class="content">Encoding</span></a>
      <li><a href="#lex.phase"><span class="secno">2.3</span> <span class="content">Phases</span></a>
      <li>
       <a href="#lex.lexeme"><span class="secno">2.4</span> <span class="content">Lexemes</span></a>
       <ol class="toc">
        <li>
         <a href="#trivia"><span class="secno">2.4.1</span> <span class="content">Trivia</span></a>
         <ol class="toc">
          <li>
           <a href="#whitespace"><span class="secno">2.4.1.1</span> <span class="content">Whitespace</span></a>
           <ol class="toc">
            <li><a href="#line"><span class="secno">2.4.1.1.1</span> <span class="content">Line Breaks</span></a>
           </ol>
          <li><a href="#comment"><span class="secno">2.4.1.2</span> <span class="content">Comments</span></a>
         </ol>
        <li>
         <a href="#token"><span class="secno">2.4.2</span> <span class="content">Tokens</span></a>
         <ol class="toc">
          <li><a href="#ident"><span class="secno">2.4.2.1</span> <span class="content">Identifiers</span></a>
          <li>
           <a href="#literal"><span class="secno">2.4.2.2</span> <span class="content">Literals</span></a>
           <ol class="toc">
            <li><a href="#literal.numeric"><span class="secno">2.4.2.2.1</span> <span class="content">Numeric Literals</span></a>
           </ol>
          <li><a href="#int"><span class="secno">2.4.2.3</span> <span class="content">Integer Literals</span></a>
          <li><a href="#float"><span class="secno">2.4.2.4</span> <span class="content">Floating-Point Literals</span></a>
         </ol>
        <li>
         <a href="#lex.lit.text"><span class="secno">2.4.3</span> <span class="content">Text Literals</span></a>
         <ol class="toc">
          <li><a href="#string"><span class="secno">2.4.3.1</span> <span class="content">String Literals</span></a>
          <li><a href="#char"><span class="secno">2.4.3.2</span> <span class="content">Character Literals</span></a>
         </ol>
       </ol>
      <li><a href="#lex.punctuation"><span class="secno">2.5</span> <span class="content">Operators and Punctuation</span></a>
     </ol>
    <li>
     <a href="#prepro"><span class="secno">3</span> <span class="content">Preprocessor</span></a>
     <ol class="toc">
      <li><a href="#prepro.changes"><span class="secno">3.1</span> <span class="content">Changes</span></a>
      <li><a href="#prepro.extensions"><span class="secno">3.2</span> <span class="content">Extensions</span></a>
     </ol>
    <li>
     <a href="#check"><span class="secno">4</span> <span class="content">Semantic Checking</span></a>
     <ol class="toc">
      <li><a href="#check.context"><span class="secno">4.1</span> <span class="content">Contexts</span></a>
      <li>
       <a href="#check.expr"><span class="secno">4.2</span> <span class="content">Expressions</span></a>
       <ol class="toc">
        <li><a href="#check.synth"><span class="secno">4.2.1</span> <span class="content">Synthesis</span></a>
        <li><a href="#check.check"><span class="secno">4.2.2</span> <span class="content">Checking</span></a>
       </ol>
      <li><a href="#check.stmt"><span class="secno">4.3</span> <span class="content">Statements</span></a>
      <li><a href="#check.decl"><span class="secno">4.4</span> <span class="content">Declarations</span></a>
     </ol>
    <li>
     <a href="#parse"><span class="secno">5</span> <span class="content">Parsing</span></a>
     <ol class="toc">
      <li><a href="#parse.context"><span class="secno">5.1</span> <span class="content">Contexts</span></a>
      <li>
       <a href="#parse.strat"><span class="secno">5.2</span> <span class="content">Strategies</span></a>
       <ol class="toc">
        <li><a href="#parse.strat.ordered"><span class="secno">5.2.1</span> <span class="content">Ordered</span></a>
        <li><a href="#parse.strat.unordered"><span class="secno">5.2.2</span> <span class="content">Unordered</span></a>
       </ol>
      <li>
       <a href="#parse.angle"><span class="secno">5.3</span> <span class="content">Angle Brackets</span></a>
       <ol class="toc">
        <li>
         <a href="#parse.angle.open"><span class="secno">5.3.1</span> <span class="content">Opening Angle Brackets</span></a>
         <ol class="toc">
          <li><a href="#ordered①"><span class="secno">5.3.1.1</span> <span class="content">Ordered Mode</span></a>
          <li><a href="#unordered①"><span class="secno">5.3.1.2</span> <span class="content">Unordered Mode</span></a>
         </ol>
        <li><a href="#parse.angle.close"><span class="secno">5.3.2</span> <span class="content">Closing Angle Brackets</span></a>
       </ol>
     </ol>
    <li><a href="#exec"><span class="secno">6</span> <span class="content">Execution Model</span></a>
    <li>
     <a href="#module"><span class="secno">7</span> <span class="content">Modules</span></a>
     <ol class="toc">
      <li><a href="#module.source.primary"><span class="secno">7.1</span> <span class="content">Primary Source Unit</span></a>
      <li>
       <a href="#module.source.secondary"><span class="secno">7.2</span> <span class="content">Seconary Source Units</span></a>
       <ol class="toc">
        <li><a href="#module.include"><span class="secno">7.2.1</span> <span class="content">Include Declarations</span></a>
        <li><a href="#module.implementing"><span class="secno">7.2.2</span> <span class="content">Implementing Declarations</span></a>
       </ol>
      <li><a href="#module.import"><span class="secno">7.3</span> <span class="content">Import Declarations</span></a>
     </ol>
    <li>
     <a href="#decl"><span class="secno">8</span> <span class="content">Declarations</span></a>
     <ol class="toc">
      <li>
       <a href="#decl.shared"><span class="secno">8.1</span> <span class="content">Shared Concepts</span></a>
       <ol class="toc">
        <li><a href="#decl.body"><span class="secno">8.1.1</span> <span class="content">Bodies</span></a>
        <li><a href="#decl.base"><span class="secno">8.1.2</span> <span class="content">Bases</span></a>
        <li><a href="#decl.param"><span class="secno">8.1.3</span> <span class="content">Parameters</span></a>
        <li><a href="#decl.accessor"><span class="secno">8.1.4</span> <span class="content">Accessors</span></a>
       </ol>
      <li><a href="#decl.generic"><span class="secno">8.2</span> <span class="content">Generics</span></a>
      <li>
       <a href="#decl.type"><span class="secno">8.3</span> <span class="content">Type Declarations</span></a>
       <ol class="toc">
        <li>
         <a href="#decl.agg"><span class="secno">8.3.1</span> <span class="content">Aggregate Types</span></a>
         <ol class="toc">
          <li><a href="#static"><span class="secno">8.3.1.1</span> <span class="content">Instance and Static Members</span></a>
          <li><a href="#field"><span class="secno">8.3.1.2</span> <span class="content">Fields</span></a>
          <li><a href="#method"><span class="secno">8.3.1.3</span> <span class="content">Methods</span></a>
         </ol>
        <li>
         <a href="#decl.agg.bases"><span class="secno">8.3.2</span> <span class="content">Bases</span></a>
         <ol class="toc">
          <li>
           <a href="#decl.agg.syntax"><span class="secno">8.3.2.1</span> <span class="content">Traditional Syntax</span></a>
           <ol class="toc">
            <li><a href="#trailing-semicolon"><span class="secno">8.3.2.1.1</span> <span class="content">Trailing Semicolon #####</span></a>
            <li><a href="#decl.agg.type-specifier"><span class="secno">8.3.2.1.2</span> <span class="content">Aggregate Type Specifiers</span></a>
           </ol>
         </ol>
        <li>
         <a href="#decl.enum"><span class="secno">8.3.3</span> <span class="content"><code>enum</code> Declarations</span></a>
         <ol class="toc">
          <li><a href="#case"><span class="secno">8.3.3.1</span> <span class="content">Cases</span></a>
         </ol>
        <li>
         <a href="#decl.type.alias"><span class="secno">8.3.4</span> <span class="content">Type Aliases</span></a>
         <ol class="toc">
          <li><a href="#decl.type.alias.syntax.traditional"><span class="secno">8.3.4.1</span> <span class="content">Traditional Syntax</span></a>
         </ol>
        <li><a href="#decl.type.associated"><span class="secno">8.3.5</span> <span class="content">Associated Types</span></a>
       </ol>
      <li>
       <a href="#decl.var"><span class="secno">8.4</span> <span class="content">Variables</span></a>
       <ol class="toc">
        <li><a href="#decl.var.traditional"><span class="secno">8.4.1</span> <span class="content">Traditional Variable Declarations</span></a>
        <li>
         <a href="#decl.var.global"><span class="secno">8.4.2</span> <span class="content">Variables at Global Scope</span></a>
         <ol class="toc">
          <li><a href="#const"><span class="secno">8.4.2.1</span> <span class="content">Global Constants</span></a>
          <li><a href="#global.static"><span class="secno">8.4.2.2</span> <span class="content">Static Global Variables</span></a>
          <li><a href="#global.param"><span class="secno">8.4.2.3</span> <span class="content">Global Shader Parameters</span></a>
         </ol>
        <li>
         <a href="#decl.var.func"><span class="secno">8.4.3</span> <span class="content">Variables at Function Scope</span></a>
         <ol class="toc">
          <li><a href="#const①"><span class="secno">8.4.3.1</span> <span class="content">Function-Scope Constants</span></a>
          <li><a href="#static①"><span class="secno">8.4.3.2</span> <span class="content">Function-Scope Static Variables</span></a>
          <li><a href="#local"><span class="secno">8.4.3.3</span> <span class="content">Local Variables</span></a>
         </ol>
       </ol>
      <li>
       <a href="#decl.func"><span class="secno">8.5</span> <span class="content">Functions</span></a>
       <ol class="toc">
        <li>
         <a href="#decl.param①"><span class="secno">8.5.1</span> <span class="content">Parameters</span></a>
         <ol class="toc">
          <li>
           <a href="#dir"><span class="secno">8.5.1.1</span> <span class="content">Directions</span></a>
           <ol class="toc">
            <li><a href="#dir.in"><span class="secno">8.5.1.1.1</span> <span class="content"><code>in</code></span></a>
            <li><a href="#out"><span class="secno">8.5.1.1.2</span> <span class="content"><code>out</code></span></a>
            <li><a href="#take"><span class="secno">8.5.1.1.3</span> <span class="content"><code>take</code></span></a>
            <li><a href="#borrow"><span class="secno">8.5.1.1.4</span> <span class="content"><code>borrow</code></span></a>
            <li><a href="#inout"><span class="secno">8.5.1.1.5</span> <span class="content"><code>inout</code></span></a>
            <li><a href="#ref"><span class="secno">8.5.1.1.6</span> <span class="content"><code>ref</code></span></a>
           </ol>
         </ol>
        <li><a href="#decl.func.result"><span class="secno">8.5.2</span> <span class="content">Result Type</span></a>
        <li><a href="#decl.func.body"><span class="secno">8.5.3</span> <span class="content">Body</span></a>
        <li><a href="#decl.func.traditional"><span class="secno">8.5.4</span> <span class="content">Traditional Function Declarations</span></a>
        <li><a href="#decl.func.entry"><span class="secno">8.5.5</span> <span class="content">Entry Points</span></a>
       </ol>
      <li><a href="#decl.init"><span class="secno">8.6</span> <span class="content">Constructors</span></a>
      <li>
       <a href="#decl.prop"><span class="secno">8.7</span> <span class="content">Properties</span></a>
       <ol class="toc">
        <li><a href="#decl.accessor①"><span class="secno">8.7.1</span> <span class="content">Accessors</span></a>
       </ol>
      <li><a href="#decl.subscript"><span class="secno">8.8</span> <span class="content">Subscripts</span></a>
      <li><a href="#decl.extension"><span class="secno">8.9</span> <span class="content">Extensions</span></a>
      <li>
       <a href="#decl.generic①"><span class="secno">8.10</span> <span class="content">Generics</span></a>
       <ol class="toc">
        <li><a href="#decl.generic.param"><span class="secno">8.10.1</span> <span class="content">Generic Parameters</span></a>
        <li><a href="#decl.generic.specialize.explicit"><span class="secno">8.10.2</span> <span class="content">Explicit Specialization</span></a>
        <li><a href="#decl.generic.specialize.implicit"><span class="secno">8.10.3</span> <span class="content">Implicit Specialization</span></a>
        <li><a href="#decl.generic.syntax"><span class="secno">8.10.4</span> <span class="content">Syntax Details</span></a>
       </ol>
      <li><a href="#decl.buffer"><span class="secno">8.11</span> <span class="content">Traditional Buffer Declarations</span></a>
     </ol>
    <li><a href="#attribute"><span class="secno">9</span> <span class="content">Attributes</span></a>
    <li><a href="#vis"><span class="secno">10</span> <span class="content">Visibility Control</span></a>
    <li>
     <a href="#stmt"><span class="secno">11</span> <span class="content">Statements</span></a>
     <ol class="toc">
      <li><a href="#stmt.expr"><span class="secno">11.1</span> <span class="content">Expression Statement</span></a>
      <li><a href="#expr.decl"><span class="secno">11.2</span> <span class="content">Declaration Statement</span></a>
      <li><a href="#stmt.block"><span class="secno">11.3</span> <span class="content">Block Statement</span></a>
      <li><a href="#stmt.empty"><span class="secno">11.4</span> <span class="content">Empty Statement</span></a>
      <li>
       <a href="#stmt.cond"><span class="secno">11.5</span> <span class="content">Conditional Statements</span></a>
       <ol class="toc">
        <li><a href="#stmt.if"><span class="secno">11.5.1</span> <span class="content">If Statement</span></a>
        <li><a href="#stmt.switch"><span class="secno">11.5.2</span> <span class="content">Switch Statement</span></a>
       </ol>
      <li>
       <a href="#stmt.loop"><span class="secno">11.6</span> <span class="content">Loop Statements</span></a>
       <ol class="toc">
        <li><a href="#stmt.for"><span class="secno">11.6.1</span> <span class="content">For Statement</span></a>
        <li><a href="#stmt.while"><span class="secno">11.6.2</span> <span class="content">While Statement</span></a>
        <li><a href="#stmt.do-while"><span class="secno">11.6.3</span> <span class="content">Do-While Statement</span></a>
       </ol>
      <li>
       <a href="#stmt.control"><span class="secno">11.7</span> <span class="content">Control Transfer Statements</span></a>
       <ol class="toc">
        <li><a href="#stmt.break"><span class="secno">11.7.1</span> <span class="content"><code>break</code> Statement</span></a>
        <li><a href="#stmt.continue"><span class="secno">11.7.2</span> <span class="content">Continue Statement</span></a>
        <li><a href="#stmt.continue①"><span class="secno">11.7.3</span> <span class="content">Return Statement</span></a>
        <li><a href="#stmt.discard"><span class="secno">11.7.4</span> <span class="content">Discard Statement</span></a>
       </ol>
     </ol>
    <li><a href="#conformance"><span class="secno"></span> <span class="content"> Conformance</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ol>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <h3 class="heading settled" data-level="1.1" id="intro.scope"><span class="secno">1.1. </span><span class="content">Scope</span><a class="self-link" href="#intro.scope"></a></h3>
   <p>This document is a specification for the Slang programming language.</p>
   <p>Slang is language primarily designed for use in <em>shader programming</em>: performance oriented GPU programming for real-time graphics.</p>
   <h3 class="heading settled" data-level="1.2" id="intro.conformance"><span class="secno">1.2. </span><span class="content">Conformance</span><a class="self-link" href="#intro.conformance"></a></h3>
   <p>This document aspires to specify the Slang language, and the behaviors expected of conforming implementations, with a high level of rigor.</p>
   <p>The open-source Slang compiler <em>implementation</em> may deviate from the language as specified here, in a few key ways:</p>
   <ul>
    <li data-md>
     <p>The implementation is necessarily imperfect, and can have bugs.</p>
    <li data-md>
     <p>The implementation may not fully support constructs specified here, or their capabilities may not be as complete as what is required by the specification.</p>
    <li data-md>
     <p>The implementation may support certain constructs that are experimental, deprecated, or are otherwise intentionally unspecified (or even undocumented).</p>
   </ul>
   <p>Where practical, this document will call out known deviations between the language as specified, and the current implementation in the open-source Slang compiler.</p>
   <h3 class="heading settled" data-level="1.3" id="intro.stdlib"><span class="secno">1.3. </span><span class="content">The Slang Standard Library</span><a class="self-link" href="#intro.stdlib"></a></h3>
   <p>Many constructs that appear to users of Slang as built-in syntax are instead defined as part of the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="standard-library">standard library</dfn> for Slang.
This document may, of neccessity, refer to constructs from the Slang standard library (e.g., the <code>Texture2D</code> type) that are not defined herein.</p>
   <p>This document does not provide a normative definition of all of the types, functions, attributes, modifiers, capabilities, etc. that are defined in the Slang standard library.
The normative reference for standard-library constructs not defined in this document is the Slang Standard Library Reference.</p>
   <p class="issue" id="issue-cebba3e7"><a class="self-link" href="#issue-cebba3e7"></a> Need to turn that into a link.</p>
   <p>In cases where a language construct is described in <em>both</em> this specification and the Standard Library Reference, the construct has all the capabilities and restrictions defined in either source.
In cases where the two sources disagree, there is a correctness issue in one or the other.</p>
   <h2 class="heading settled" data-level="2" id="lex"><span class="secno">2. </span><span class="content">Lexical Structure</span><a class="self-link" href="#lex"></a></h2>
   <p>This chapter describes how a <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit">source unit</a> is decomposed into a sequence of [<a data-link-type="dfn" href="#lexeme" id="ref-for-lexeme">lexemes</a>].</p>
   <h3 class="heading settled" data-level="2.1" id="lex.source-unit"><span class="secno">2.1. </span><span class="content">Source Units</span><a class="self-link" href="#lex.source-unit"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="source-unit">source unit</dfn> comprises a sequence of zero or more [<a data-link-type="dfn" href="#character" id="ref-for-character">characters</a>].
For the purposes of this document, a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="character">character</dfn> is defined as a <a data-link-type="biblio" href="#biblio-unicode" title="The Unicode Standard">[Unicode]</a> scalar value.</p>
   <p class="note" role="note"><span class="marker">Note:</span> A Unicode scalar value is a Unicode code point that is not a surrogate code point.</p>
   <p>Implementations may accept <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit①">source units</a> stored as files on disk, buffers in memory, or any appropriate implementation-specified means.</p>
   <h3 class="heading settled" data-level="2.2" id="lex.encoding"><span class="secno">2.2. </span><span class="content">Encoding</span><a class="self-link" href="#lex.encoding"></a></h3>
   <p>Implementations must support <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit②">source units</a> encoded using UTF-8, if they support any encoding of <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit③">source units</a> as byte sequences.</p>
   <p>Implementations should default to the UTF-8 encoding for all text input/output.</p>
   <p>Implementations may support additional implementation-specified encodings.</p>
   <h3 class="heading settled" data-level="2.3" id="lex.phase"><span class="secno">2.3. </span><span class="content">Phases</span><a class="self-link" href="#lex.phase"></a></h3>
   <p>Lexical processing of a [<a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit④">source unit</a>] proceeds <em>as if</em> the following steps are executed in order:</p>
   <ol>
    <li data-md>
     <p>Line numbering (for subsequent diagnostic messages) is noted based on the locations of [<a data-link-type="dfn" href="#line-break" id="ref-for-line-break">line breaks</a>]</p>
    <li data-md>
     <p>[<a data-link-type="dfn" href="#escaped-line-break" id="ref-for-escaped-line-break">Escaped line breaks</a>] are eliminated. No new [<a data-link-type="dfn" href="#character" id="ref-for-character①">characters</a>] are inserted to replace them. Any new [<a data-link-type="dfn" href="#escaped-line-break" id="ref-for-escaped-line-break①">escaped line breaks</a>] introduced by this step are not eliminated.</p>
    <li data-md>
     <p>Each comment is replaced with a single space (U+0020)</p>
    <li data-md>
     <p>The <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit⑤">source unit</a> is <em>lexed</em> into a sequence of [<a data-link-type="dfn" href="#tokens" id="ref-for-tokens">tokens</a>] according to the lexical grammar in this chapter</p>
    <li data-md>
     <p>The lexed sequence of tokens is [<a data-link-type="dfn">preprocessed</a>] to produce a new sequence of tokens</p>
   </ol>
   <p>The final [<a data-link-type="dfn" href="#tokens" id="ref-for-tokens①">token</a>] sequence produced by this process is used as input to subsequent phases of compilation.</p>
   <h3 class="heading settled" data-level="2.4" id="lex.lexeme"><span class="secno">2.4. </span><span class="content">Lexemes</span><a class="self-link" href="#lex.lexeme"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="lexeme">lexeme</dfn> is a contiguous sequence of characters in a single [<a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit⑥">source unit</a>].</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="lexing">Lexing</dfn> is the process by which an implementation decomposes a [<a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit⑦">source unit</a>] into zero or more non-overlapping [<a data-link-type="dfn" href="#lexeme" id="ref-for-lexeme①">lexemes</a>].</p>
   <p>Every [<a data-link-type="dfn" href="#lexeme" id="ref-for-lexeme②">lexeme</a>] is either a [<a data-link-type="dfn" href="#tokens" id="ref-for-tokens②">token</a>] or it is [<a data-link-type="dfn" href="#trivia①" id="ref-for-trivia①">trivia</a>].</p>
<pre class="language-.lexical">Lexeme :
  Token
  | Trivia
  ;
</pre>
   <h4 class="heading settled" data-level="2.4.1" id="trivia"><span class="secno">2.4.1. </span><span class="content">Trivia</span><a class="self-link" href="#trivia"></a></h4>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="trivia①">Trivia</dfn> are [<a data-link-type="dfn" href="#lexeme" id="ref-for-lexeme③">lexemes</a>] that do not appear in the abstract syntax; they are only part of the lexical grammar.
The presence or absence of [<a data-link-type="dfn" href="#trivia①" id="ref-for-trivia①①">trivia</a>] in a sequence of [<a data-link-type="dfn" href="#lexeme" id="ref-for-lexeme④">lexemes</a>] has no semantic impact, except where specifically noted in this specification.</p>
<pre class="language-.lexical">Trivia :
  Whitespace
  | Comment
  ;
</pre>
   <h5 class="heading settled" data-level="2.4.1.1" id="whitespace"><span class="secno">2.4.1.1. </span><span class="content">Whitespace</span><a class="self-link" href="#whitespace"></a></h5>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="whitespace①">Whitespace</dfn> consists of [<a data-link-type="dfn" href="#horizontal-whitespace" id="ref-for-horizontal-whitespace">horizontal whitespace</a>] and [<a data-link-type="dfn" href="#line-break" id="ref-for-line-break①">line breaks</a>].</p>
<pre class="language-.lexical">Whitespace :
  HorizontalSpace
  | LineBreak
  ;
</pre>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="horizontal-whitespace">Horizontal whitespace</dfn> consists of any sequence of space (U+0020) and horizontal tab (U+0009).</p>
<pre class="language-.lexical">HorizontalSpace : (' ' | '\t')+ ;
</pre>
   <h6 class="heading settled" data-level="2.4.1.1.1" id="line"><span class="secno">2.4.1.1.1. </span><span class="content">Line Breaks</span><a class="self-link" href="#line"></a></h6>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="line-break">line break</dfn> consists of a line feed (U+000A), carriage return (U+000D) or a carriage return followed by a line feed (U+000D, U+000A).</p>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="escaped-line-break">escaped line break</dfn> is a backslash (<code>\</code>, U+005C) follow immediately by a [<a data-link-type="dfn" href="#line-break" id="ref-for-line-break②">line break</a>].</p>
   <p>A <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit⑧">source unit</a> is split into <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="lines">lines</dfn>: non-empty sequences of [<a data-link-type="dfn" href="#character" id="ref-for-character②">characters</a>] separated by [<a data-link-type="dfn" href="#line-break" id="ref-for-line-break③">line breaks</a>].</p>
   <p class="note" role="note"><span class="marker">Note:</span> Line breaks are used as line separators rather than terminators; it is not necessary for a <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit⑨">source unit</a> to end with a line break.</p>
   <h5 class="heading settled" data-level="2.4.1.2" id="comment"><span class="secno">2.4.1.2. </span><span class="content">Comments</span><a class="self-link" href="#comment"></a></h5>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="comment①">comment</dfn> is either a [<a data-link-type="dfn" href="#line-comment" id="ref-for-line-comment">line comment</a>] or a [<a data-link-type="dfn" href="#block-comment" id="ref-for-block-comment">block comment</a>].</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="line-comment">line comment</dfn> comprises two forward slashes (<code>/</code>, U+002F) followed by zero or more characters that do not contain a [<a data-link-type="dfn" href="#line-break" id="ref-for-line-break④">line break</a>].
A [<a data-link-type="dfn" href="#line-comment" id="ref-for-line-comment①">line comment</a>] extends up to, but does not include, a subsequent [<a data-link-type="dfn" href="#line-break" id="ref-for-line-break⑤">line break</a>] or the end of the <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit①⓪">source unit</a>.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="block-comment">block comment</dfn> begins with a forward slash (<code>/</code>, U+002F) followed by an asterisk (<code>*</code>, U+0052).
A [<a data-link-type="dfn" href="#block-comment" id="ref-for-block-comment①">block comment</a>] is terminated by the next instance of an asterisk followed by a forward slash (<code>*/</code>).
A [<a data-link-type="dfn" href="#block-comment" id="ref-for-block-comment②">block comment</a>] contains all [<a data-link-type="dfn" href="#character" id="ref-for-character③">characters</a>] between where it begins and where it terminates, including any [<a data-link-type="dfn" href="#line-break" id="ref-for-line-break⑥">line breaks</a>].</p>
   <p class="note" role="note"><span class="marker">Note:</span> [<a data-link-type="dfn" href="#block-comment" id="ref-for-block-comment③">Block comments</a>] do not nest.</p>
   <p>It is an error if a [<a data-link-type="dfn" href="#block-comment" id="ref-for-block-comment④">block comment</a>] that begins in a [<a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit①①">source unit</a>] is not terminated in that [<a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit①②">source unit</a>].</p>
   <h4 class="heading settled" data-level="2.4.2" id="token"><span class="secno">2.4.2. </span><span class="content">Tokens</span><a class="self-link" href="#token"></a></h4>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="tokens">Tokens</dfn> are lexemes that are significant to the abstract syntax.</p>
<pre class="language-.lexical">Token :
    Identifier
    | Literal
    | Operator
    | Puncutation
;
</pre>
   <h5 class="heading settled" data-level="2.4.2.1" id="ident"><span class="secno">2.4.2.1. </span><span class="content">Identifiers</span><a class="self-link" href="#ident"></a></h5>
<pre class="language-.lexical">Identifier :
    IdentifierStart IdentifierContinue*
    ;

IdentifierStart :
    [A-Z]
    | [a-z]
    | '_'
    ;

IdentifierContinue :
    IdentifierStart
    | [0-9]
    ;
</pre>
   <p>The identifier consisting of a single underscore (<code>_</code>) is reserved by the language and must not be used by programs as a name in a declaration or binding.</p>
   <p class="note" role="note"><span class="marker">Note:</span> There are no other fixed keywords or reserved words recognized by the lexical grammar.</p>
   <h5 class="heading settled" data-level="2.4.2.2" id="literal"><span class="secno">2.4.2.2. </span><span class="content">Literals</span><a class="self-link" href="#literal"></a></h5>
<pre class="language-.lexical">Literal :
    NumericLiteral
    | TextLiteral
    ;
</pre>
   <h6 class="heading settled" data-level="2.4.2.2.1" id="literal.numeric"><span class="secno">2.4.2.2.1. </span><span class="content">Numeric Literals</span><a class="self-link" href="#literal.numeric"></a></h6>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="numeric-literal">numeric literal</dfn> is either an [<a data-link-type="dfn" href="#integer-literal" id="ref-for-integer-literal">integer literal</a>] or a [<a data-link-type="dfn" href="#floating-point-literal" id="ref-for-floating-point-literal">floating-point literal</a>].</p>
<pre class="language-.lexical">NumericLiteral :
    IntegerLiteral
    | FloatingPointLiteral
    ;
</pre>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="radix-specifier">radix specifier</dfn> is one of:</p>
   <ul>
    <li data-md>
     <p><code>0x</code> or <code>0X</code> to specify a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="hexadecimal-literal">hexadecimal literal</dfn> (radix 16)</p>
    <li data-md>
     <p><code>0b</code> or <code>0B</code> to specify a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="binary-literal">binary literal</dfn> (radix 2)</p>
   </ul>
   <p>When no radix specifier is present, a numeric literal is a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="decimal-literal">decimal literal</dfn> (radix 10).</p>
   <p class="note" role="note"><span class="marker">Note:</span>Octal literals (radix 8) are not supported.
A <code>0</code> prefix on an integer literal does <em>not</em> specify an octal literal as it does in C.
Implementations may warn on integer literals with a <code>0</code> prefix in case users expect C behavior.</p>
   <p>The grammar of the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="digits">digits</dfn> for a numeric level depend on its radix, as follows:</p>
   <ul>
    <li data-md>
     <p>The digits of a decimal literal may include <code>0</code> through <code>9</code></p>
    <li data-md>
     <p>The digits of a hexadecimal literal may include <code>0</code> through <code>9</code>, the letters <code>A</code> through <code>F</code> and <code>a</code> through <code>f</code>. The letters represent digit values 10 through 15.</p>
    <li data-md>
     <p>The digits of a binary literal may include <code>0</code> and <code>1</code></p>
   </ul>
   <p>Digits for all numeric literals may also include <code>_</code>, which are ignored and have no semantic impact.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="numeric-literal-suffix">numeric literal suffix</dfn> consists of any sequence of characters that would be a valid identifier, that does not start with <code>e</code> or <code>E</code>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> A leading <code>-</code> (U+002D) before a numeric literal is <em>not</em> part of the literal, even if there is no whitespace separating the two.</p>
   <h5 class="heading settled" data-level="2.4.2.3" id="int"><span class="secno">2.4.2.3. </span><span class="content">Integer Literals</span><a class="self-link" href="#int"></a></h5>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="integer-literal">integer literal</dfn> consists of an optional radix specifier followed by digits and an optional numeric literal suffix.</p>
   <p>The suffix on an integer literal may be used to indicate the desired type of the literal:</p>
   <ul>
    <li data-md>
     <p>A <code>u</code> suffix indicates the <code>UInt</code> type</p>
    <li data-md>
     <p>An <code>l</code> or <code>ll</code> suffix indicates the <code>Int64</code> type</p>
    <li data-md>
     <p>A <code>ul</code> or <code>ull</code> suffix indicates the <code>UInt64</code> type</p>
   </ul>
   <h5 class="heading settled" data-level="2.4.2.4" id="float"><span class="secno">2.4.2.4. </span><span class="content">Floating-Point Literals</span><a class="self-link" href="#float"></a></h5>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="floating-point-literal">floating-point literal</dfn> consists of either</p>
   <ul>
    <li data-md>
     <p>An optional radix specifier, followed by digits, followed by a <code>.</code> (U+002E), followed by optional digits, an optional exponent, and an optional numeric literal suffix.</p>
    <li data-md>
     <p>An optional radix specifier, followed by digits, an exponent, and an optional numeric literal suffix.</p>
    <li data-md>
     <p>A <code>.</code> (U+002E) followed by digits, an optional exponent, and an optional numeric literal suffix.</p>
   </ul>
   <p>A floating-point literal may only use dexicmal or hexadecimal radix.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="exponent">exponent</dfn> of a floating-pointer literal consists of either <code>e</code> or <code>E</code>, followed by an optional <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="sign">sign</dfn> of <code>+</code> or <code>-</code>, followed by decimal digits.</p>
   <h4 class="heading settled" data-level="2.4.3" id="lex.lit.text"><span class="secno">2.4.3. </span><span class="content">Text Literals</span><a class="self-link" href="#lex.lit.text"></a></h4>
   <p class="issue" id="issue-9b572b04"><a class="self-link" href="#issue-9b572b04"></a> Need to document supported escape sequences.</p>
   <h5 class="heading settled" data-level="2.4.3.1" id="string"><span class="secno">2.4.3.1. </span><span class="content">String Literals</span><a class="self-link" href="#string"></a></h5>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="string-literal">string literal</dfn> consists of a sequence of characters enclosed between two <code>"</code>, with the constraint that any <code>"</code> within the sequence must be escaped with <code>\</code>.</p>
   <h5 class="heading settled" data-level="2.4.3.2" id="char"><span class="secno">2.4.3.2. </span><span class="content">Character Literals</span><a class="self-link" href="#char"></a></h5>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="character-literal">character literal</dfn> consists of a sequence of characters enclosed between two <code>'</code>, with the constraint that any <code>'</code> within the sequence must be escaped with <code>\</code>.</p>
   <p>The sequence of characters within a character literal must represent a single character.</p>
   <h3 class="heading settled" data-level="2.5" id="lex.punctuation"><span class="secno">2.5. </span><span class="content">Operators and Punctuation</span><a class="self-link" href="#lex.punctuation"></a></h3>
   <p>The following table defines tokens that are used as operators and punctuation in the syntax.
When a given sequence of characters could be interpreted as starting with more than one of the following tokens, the longest matching token is used.
The name or names given to tokens by this table may be used in the rest of this document to refer to those tokens.</p>
<pre class="language-.lexical">
Punctuation :
  | `(`     // left parenthesis
  | `)`     // right parenthesis
  | `[`     // left square bracket, opening square bracket
  | `]`     // right square bracket, closing square bracket
  | `{`    // left curly brace, opening curly brace
  | `}`    // right curly brace, closing curly brace
  | `;`     // semicolon
  | `:`     // colon
  | `,`     // comma
  | `.`     // dot
  | `...`   // ellipsis
  | `::`    // double colon, scope operator
  | `->`    // arrow
    ;

Operator :
  | ```     // backtick
  | `!`     // exclamation mark
  | `@`     // at sign
  | `$`     // dollar sign
  | `%`     // percent sign
  | `~`     //tilde
  | `^`     // caret
  | `&amp;`     // ampersand
  | `*`     // asterisk, multiplication operator
  | `-`     // minus sign, subtraction operator
  | `=`     // equals sign, assignment operator
  | `+`     // plus sign, addition operator
  | `|`     // pipe
  | `&lt;`     // less-than sign, less-than operator
  | `>`     // greater-than sign, greater-than operator
  | `/`     // slash, division operator
  | `?`     // question mark
  | `==`    // double-equals, equal-to operator
  | `!=`    // not-equal operator
  | `%=`    // modulo-assign operator
  | `+=`    // add-assign operator
  | `^=`    // xor-assign operator
  | `&amp;=`    // and-assign operator
  | `*=`    // multiply-assign operator
  | `-=`    // subtract-assign operator
  | `|=`    // or-assign operator
  | `&lt;=`    // less-than-or-equal-to operator
  | `>=`    // greater-than-or-equal-to operator
  | `/=`    // divide-assign operator
  | `&amp;&amp;`    // and-and operator
  | `--`    // decrement operator
  | `++`    // increment operator
  | `||`    // or-or operator
  | `&lt;&lt;`    // left shift operator
  | `>>`    // right shift operator
    ;

</pre>
   <h2 class="heading settled" data-level="3" id="prepro"><span class="secno">3. </span><span class="content">Preprocessor</span><a class="self-link" href="#prepro"></a></h2>
   <p>As the last phase of lexical processing the token sequence of a <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit①③">source unit</a> is preprocessed to produce a new token stream.</p>
   <p>The preprocessor supported by Slang is derived from the C/C++ preprocessor with a few changes and extensions.</p>
   <p class="issue" id="issue-c15d86ec"><a class="self-link" href="#issue-c15d86ec"></a> We either need to pick a normative reference here for some existing preprocessor (and thus bind ourselves to eventually supporting the semantics of that normative reference), or we need to take the time to fully document what the semantics of our current preprocessor are.</p>
   <p>Slang programs may use the following preprocessor directives, with the same semantics as their C/C++ equivalent:</p>
   <ul>
    <li data-md>
     <p><code>#include</code></p>
    <li data-md>
     <p><code>#define</code></p>
    <li data-md>
     <p><code>#undef</code></p>
    <li data-md>
     <p><code>#if</code>, <code>#ifdef</code>, <code>#ifndef</code></p>
    <li data-md>
     <p><code>#else</code>, <code>#elif</code></p>
    <li data-md>
     <p><code>#endif</code></p>
    <li data-md>
     <p><code>#error</code></p>
    <li data-md>
     <p><code>#warning</code></p>
    <li data-md>
     <p><code>#line</code></p>
    <li data-md>
     <p><code>#pragma</code></p>
   </ul>
   <p>An implementation may use any implementation-specified means to resolve paths provided to <code>#include</code> directives.</p>
   <p>An implementation that supports <code>#pragma  once</code> may use any implementation-specified means to determine if two <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit①④">source units</a> are identical.</p>
   <h3 class="heading settled" data-level="3.1" id="prepro.changes"><span class="secno">3.1. </span><span class="content">Changes</span><a class="self-link" href="#prepro.changes"></a></h3>
   <p>The input to the Slang preprocessor is a token sequence produced by the rules in Chapter 2, and does not use the definition of "preprocessor tokens" as they are used by the C/C++ preprocessor.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The key place where this distinction matters is in macros that perform token pasting.
The input to the Slang preprocessor must be a valid sequence of tokens <em>before</em> any token pasting occurs.</p>
   <p>When tokens are pasted with the <code>##</code> operator, the resulting concatenated text is decomposed into one or more new tokens.
It is an error if the concatenated text does not form a valid sequence of tokens.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The C/C++ preprocessor always yields a single token from any token pasting, whether or not that token is valid.</p>
   <h3 class="heading settled" data-level="3.2" id="prepro.extensions"><span class="secno">3.2. </span><span class="content">Extensions</span><a class="self-link" href="#prepro.extensions"></a></h3>
   <p class="issue" id="issue-29446511"><a class="self-link" href="#issue-29446511"></a> At the very least we need to document support for the GLSL <code>#version</code> directive, if we intend to keep it.</p>
   <h2 class="heading settled" data-level="4" id="check"><span class="secno">4. </span><span class="content">Semantic Checking</span><a class="self-link" href="#check"></a></h2>
   <div class="issue" id="issue-60092464">
    <a class="self-link" href="#issue-60092464"></a> The intention of this chapter is to establish the formalisms and notations that will be used for expressing typing judgements and other semantic-checking rules in this specification. 
    <p>The notation being used here is aligned with how papers in the PLT world on type theory, semantics, etc. present a language.</p>
   </div>
   <h3 class="heading settled" data-level="4.1" id="check.context"><span class="secno">4.1. </span><span class="content">Contexts</span><a class="self-link" href="#check.context"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="context">context</dfn> is an ordered sequence of zero or more <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="context-entries">context entries</dfn>.
Context entries include <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="bindings">bindings</dfn> of the name of a variable (an [<a data-link-type="dfn" href="https://drafts.csswg.org/css-values-4/#css-css-identifier" id="ref-for-css-css-identifier">identifier</a>]) to its type.</p>
<pre class="language-.checking">
Context :
    ContextEntry*
    
ContextEntry :
    Binding
    
Binding :
    Identifier : Type // variable
    Identifer = Value // alias
</pre>
   <p>A context <var>c</var> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="binds">binds</dfn> an identifier <var>n</var> if <var>c</var> contains one or more <a data-link-type="dfn" href="#bindings" id="ref-for-bindings">bindings</a> with <var>n</var> on the left-hand side.</p>
   <p class="issue" id="issue-0b447306"><a class="self-link" href="#issue-0b447306"></a> We need to describe here the process by which an identifier resolves to a binding, including overloaded, etc.
The discussion here will have to be a forward reference to the algorithms to be given later.</p>
   <h3 class="heading settled" data-level="4.2" id="check.expr"><span class="secno">4.2. </span><span class="content">Expressions</span><a class="self-link" href="#check.expr"></a></h3>
   <p>Slang use a bidirectional type-checking algorithm.
There are two different judgements used when checking expressions.</p>
   <h4 class="heading settled" data-level="4.2.1" id="check.synth"><span class="secno">4.2.1. </span><span class="content">Synthesis</span><a class="self-link" href="#check.synth"></a></h4>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="synthesis-judgement">synthesis judgement</dfn> determines that, given a <a data-link-type="dfn" href="#context" id="ref-for-context">context</a> <var>c</var> and an <a data-link-type="dfn">expression</a> <var>e</var>, <var>e</var> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="synthesizes">synthesizes</dfn> some <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-type" id="ref-for-concept-document-type">type</a> <var>t</var> in context <var>c</var>.</p>
   <p class="issue" id="issue-0774e2d2"><a class="self-link" href="#issue-0774e2d2"></a> as written here, a synthesis judgement might actually have <em>side effects</em> on the context.
That needs to be specified somehow.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Synthesis judgements are used in places where an expression needs to be checked, but the expected type of that expression in not known.
In algorithmic terms <var>c</var> and <var>e</var> are inputs, while <var>t</var> is an output.</p>
   <h4 class="heading settled" data-level="4.2.2" id="check.check"><span class="secno">4.2.2. </span><span class="content">Checking</span><a class="self-link" href="#check.check"></a></h4>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="checking-judgement">checking judgement</dfn> determines that, given a <a data-link-type="dfn" href="#context" id="ref-for-context①">context</a> <var>c</var>, an <a data-link-type="dfn">expression</a> <var>e</var>, and a <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-type" id="ref-for-concept-document-type①">type</a> <var>t</var>, <var>e</var> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="checks-against">checks against</dfn> <var>t</var> in context <var>c</var>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Checking judgements are used in places where the type that an expression is expected to have is known.
In algorithmic terms <var>c</var>, <var>e</var>, and <var>t</var> are all inputs.</p>
   <h3 class="heading settled" data-level="4.3" id="check.stmt"><span class="secno">4.3. </span><span class="content">Statements</span><a class="self-link" href="#check.stmt"></a></h3>
   <p>Statement also use <a data-link-type="dfn" href="#checking-judgement" id="ref-for-checking-judgement">checking judgements</a>.
A checking judgement for a statement determines that <a data-link-type="dfn" href="#statement" id="ref-for-statement">statement</a> <var>s</var> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="checks">checks</dfn> in <a data-link-type="dfn" href="#context" id="ref-for-context②">context</a> <var>c</var>.</p>
   <h3 class="heading settled" data-level="4.4" id="check.decl"><span class="secno">4.4. </span><span class="content">Declarations</span><a class="self-link" href="#check.decl"></a></h3>
   <p>Declarations also use <a data-link-type="dfn" href="#checking-judgement" id="ref-for-checking-judgement①">checking judgements</a>.
A checking judgement for a declaration determines that <a data-link-type="dfn" href="#declaration" id="ref-for-declaration">declaration</a> <var>d</var> [<a data-link-type="dfn" href="#checks" id="ref-for-checks">checks</a>] in <a data-link-type="dfn" href="#context" id="ref-for-context③">context</a> <var>c</var>.</p>
   <p>Checking of a declaration may modify the context <var>c</var> to include additional bindings.</p>
   <h2 class="heading settled" data-level="5" id="parse"><span class="secno">5. </span><span class="content">Parsing</span><a class="self-link" href="#parse"></a></h2>
   <div class="issue" id="issue-29cd4b9f">
    <a class="self-link" href="#issue-29cd4b9f"></a> The intention of this chapter is to establish the overall rules for the recursive-descent parsing strategy needed for Slang’s grammar. 
    <p>Slang attempts to thread the needle by supporting the familiar C-like syntax of existing shading languages, while also support out-of-order declarations.
The parsing strategy is necessarily complicated as a result, but we hope to isolate most of the details to this chapter so that the grammar for each construct can be presented in its simplest possible fashion.</p>
   </div>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parsing">Parsing</dfn> is the process of matching a sequence of tokens from the lexical grammar with a rule of the abstract syntax grammar.</p>
   <h3 class="heading settled" data-level="5.1" id="parse.context"><span class="secno">5.1. </span><span class="content">Contexts</span><a class="self-link" href="#parse.context"></a></h3>
   <p>Parsing is always performed with respect to a <a data-link-type="dfn" href="#context" id="ref-for-context④">context</a>, which determines which identifiers are bound, and what they are bound to.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="initial-context">initial context</dfn> for parsing includes bindings for syntax rules corresponding to each declaration, statement, and expression keyword defined in this specification.</p>
   <p class="note" role="note"><span class="marker">Note:</span> For example, an <code>if</code> expression begins with the <code>if</code> keyword, so the initial context contains a binding for the identifier <code>if</code> to a syntax rule that parses an <code>if</code> expression.</p>
   <p>The initial context also includes bindings for the declarations in the Slang standard library.
Implementations may include additional bindings in the initial context.</p>
   <h3 class="heading settled" data-level="5.2" id="parse.strat"><span class="secno">5.2. </span><span class="content">Strategies</span><a class="self-link" href="#parse.strat"></a></h3>
   <p>Parsing is always performed in one of two modes: unordered or ordered.
Unless otherwise specified, each grammar rule matches its sub-rules in the same mode.</p>
   <h4 class="heading settled" data-level="5.2.1" id="parse.strat.ordered"><span class="secno">5.2.1. </span><span class="content">Ordered</span><a class="self-link" href="#parse.strat.ordered"></a></h4>
   <p>Parsing in <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="ordered">ordered</dfn> mode interleaves parsing and semantic analysis.
When the parser is in ordered mode and is about to parse a <a data-link-type="dfn" href="#declaration" id="ref-for-declaration①">declaration</a>, <a data-link-type="dfn" href="#statement" id="ref-for-statement①">statement</a>, or <a data-link-type="dfn">expression</a>, and the lookahead is an Identifier, it first looks up that identifier in the context.</p>
   <ul>
    <li data-md>
     <p>If the identifier is bound to a syntax rule <var>s</var>, then the parser attempts to match the corresponding production in the grammar given here.</p>
    <li data-md>
     <p>Otherwise, the parser first matches a <a data-link-type="dfn">term</a>, and then based on whether the result of checking that term is a <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-type" id="ref-for-concept-document-type②">type</a> or an <a data-link-type="dfn">expression</a>, it either considers only productions starting with a <a data-link-type="dfn">type expression</a> or those starting with an <a data-link-type="dfn">expression</a>.</p>
   </ul>
   <p>If the parser is in ordered mode and is about to parse a <a data-link-type="dfn">declaration body</a>, it switches to unordered mode before parsing the body, and switches back to ordered mode afterward.</p>
   <h4 class="heading settled" data-level="5.2.2" id="parse.strat.unordered"><span class="secno">5.2.2. </span><span class="content">Unordered</span><a class="self-link" href="#parse.strat.unordered"></a></h4>
   <p>In <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="unordered">unordered</dfn> mode, semantic analysis is deferred.</p>
   <p>When the parser is in unordered mode and is about to parse a <a data-link-type="dfn" href="#declaration" id="ref-for-declaration②">declaration</a>, and the lookahead is an Identifier, it first looks up that identifier in the context.</p>
   <ul>
    <li data-md>
     <p>If the identifier is bound to a syntax rule <var>s</var>, then the parser attempts to match the corresponding production in the grammar given here.</p>
    <li data-md>
     <p>Otherwise, it considers only productions that start with a <a data-link-type="dfn">type specifier</a>.</p>
   </ul>
<pre class="language-.syntax">BalancedTokens :
    BalancedToken*

BalancedToken :
    `{` BalancedTokens `}`
    | `(` BalancedTokens `)`
    | `[` BalancedTokens `]`
    | /* any token other than `{`, `}`, `(`, `)`, `[`, `]` */
</pre>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="balanced">balanced</dfn> rule in the grammar is one that meets one of the following criteria:</p>
   <ul>
    <li data-md>
     <p>starts with a <code>{</code> and ends with a <code>}</code></p>
    <li data-md>
     <p>starts with a <code>(</code> and ends with a <code>)</code></p>
    <li data-md>
     <p>starts with a <code>[</code> and ends with a <code>]</code></p>
   </ul>
   <p>Whenever the parser is in ordered mode and would attempt to match a balanced rule <var>r</var>, it instead matches the <a data-link-type="dfn">balanced token</a> rule and saves the token sequence that was matched.
Those tokens are then matched against <var>r</var> as part of semantic analysis, using the context that the checking rules specify.</p>
   <h3 class="heading settled" data-level="5.3" id="parse.angle"><span class="secno">5.3. </span><span class="content">Angle Brackets</span><a class="self-link" href="#parse.angle"></a></h3>
   <h4 class="heading settled" data-level="5.3.1" id="parse.angle.open"><span class="secno">5.3.1. </span><span class="content">Opening Angle Brackets</span><a class="self-link" href="#parse.angle.open"></a></h4>
   <h5 class="heading settled" data-level="5.3.1.1" id="ordered①"><span class="secno">5.3.1.1. </span><span class="content">Ordered Mode</span><a class="self-link" href="#ordered①"></a></h5>
   <p>If the parser is in ordered mode with a lookahead of <code>&lt;</code>, and it could match that token as part of either an <a data-link-type="dfn">infix expression</a> or a <a data-link-type="dfn">specialize expression</a>, then it considers the term that has been matched so far:</p>
   <ul>
    <li data-md>
     <p>If the term has a generic type or overloaded type, then the <a data-link-type="dfn">specialize expression</a> case is favored.</p>
    <li data-md>
     <p>Otherwise the <a data-link-type="dfn">infix expression</a> case is favored.</p>
   </ul>
   <h5 class="heading settled" data-level="5.3.1.2" id="unordered①"><span class="secno">5.3.1.2. </span><span class="content">Unordered Mode</span><a class="self-link" href="#unordered①"></a></h5>
   <p>If the parser is in ordered mode with a lookahead of <code>&lt;</code>, and it could match that token as part of either an <a data-link-type="dfn">infix expression</a> or a <a data-link-type="dfn">specialize expression</a>, then it first attempts to match the <a data-link-type="dfn" href="#generic-arguments" id="ref-for-generic-arguments">generic arguments</a> rule. If that rule is matched successfully, then the new lookahead token is inspected:</p>
   <ul>
    <li data-md>
     <p>If the lookahead token is an <a data-link-type="dfn" href="https://drafts.csswg.org/css-values-4/#css-css-identifier" id="ref-for-css-css-identifier①">identifier</a>, <code>(</code>, <a data-link-type="dfn">literal</a>, or <a data-link-type="dfn">prefix operator</a>, then roll back to before the <code>&lt;</code> was matched and favor the <a data-link-type="dfn">infix expression</a> rule.</p>
    <li data-md>
     <p>Otherwise, use the generic arguments already matched as part of matching the <a data-link-type="dfn">specialize expression</a> rule.</p>
   </ul>
   <h4 class="heading settled" data-level="5.3.2" id="parse.angle.close"><span class="secno">5.3.2. </span><span class="content">Closing Angle Brackets</span><a class="self-link" href="#parse.angle.close"></a></h4>
   <p>If the parser is attempting to match the closing <code>></code> in the <a data-link-type="dfn">generic parameters</a> or <a data-link-type="dfn" href="#generic-arguments" id="ref-for-generic-arguments①">generic arguments</a> rules, and the lookahead is any token other than <code>></code> that starts with a <code>></code> character (<code>>=</code>, <code>>></code>, or <code>>>=</code>), then it splits the opening <code>></code> off and matches it, replacing the lookahead with a token comprised of the remaining characters (<code>=</code>, <code>></code>, or <code>>=</code>).</p>
   <h2 class="heading settled" data-level="6" id="exec"><span class="secno">6. </span><span class="content">Execution Model</span><a class="self-link" href="#exec"></a></h2>
   <div class="issue" id="issue-fa20f1ae">
    <a class="self-link" href="#issue-fa20f1ae"></a> Even if we don’t define a completely formal runtime semantics, we need sufficient terminology to be able to explain the intended semantics of language constructs, including things like <code>discard</code>, shared memory, wave-level ops, etc. 
    <p>Key concepts that this chapter will need to discuss:</p>
    <ul>
     <li data-md>
      <p>A concept of systems that might be comprised of multiple <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="devices">devices</dfn>, and which might have multiple distinct <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="memory-spaces">memory spaces</dfn> that may or may not be shared.</p>
     <li data-md>
      <p>The notion of a thread or invocation that runs Slang code in a largely scalar/sequential fashion.</p>
     <li data-md>
      <p>Any notions of groupings of threads (quads, subgroups/waves/warps, thread blocks/workgroups, dispatches/grids/draws, etc.) that might have semantic consequences</p>
     <li data-md>
      <p>A definition of what it means for execution to be <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="convergent">convergent</dfn> for a grouping of threads, and what it means for data to be <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="uniform">uniform</dfn> across such groups.</p>
     <li data-md>
      <p>A definition of what memory <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="objects">objects</dfn> and/or <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="locations">locations</dfn> are, and the kinds of <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="accesses">accesses</dfn> that may be performed to them (reads, writes, atomics, etc.).</p>
     <li data-md>
      <p>Definitions of what an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="activation">activation</dfn> of a function is, and how those activations comprise the call stack of a thread.</p>
     <li data-md>
      <p>A definition of core GPU rendering concepts such as <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="pipelines">pipelines</dfn>, <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="stages">stages</dfn>, <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="kernels">kernels</dfn>, <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="varying">varying</dfn> input/output, <a data-link-type="dfn" href="#uniform" id="ref-for-uniform">uniform</a> shader parameters, etc.</p>
    </ul>
   </div>
   <h2 class="heading settled" data-level="7" id="module"><span class="secno">7. </span><span class="content">Modules</span><a class="self-link" href="#module"></a></h2>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="module①">module</dfn> is a unit of encapsulation for declarations.</p>
   <h3 class="heading settled" data-level="7.1" id="module.source.primary"><span class="secno">7.1. </span><span class="content">Primary Source Unit</span><a class="self-link" href="#module.source.primary"></a></h3>
   <p>One or more <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit①⑤">source units</a> may be compiled together to form a module.
Compilation of a module begins with a single <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit①⑥">source unit</a> that is the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="primary-source-unit">primary source unit</dfn> of the module.
An implementation <em>should</em> use the <a data-link-type="dfn" href="#primary-source-unit" id="ref-for-primary-source-unit">primary source unit</a> as a means to identify a module when resolving references from one module to another.</p>
   <p>A <a data-link-type="dfn" href="#primary-source-unit" id="ref-for-primary-source-unit①">primary source unit</a> may start with a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="module-declaration">module declaration</dfn>, which specifies the name of the module:</p>
<pre class="language-.syntax">ModuleDeclaration :
    `module` Identifier `;`
</pre>
   <p>If a <a data-link-type="dfn" href="#primary-source-unit" id="ref-for-primary-source-unit②">primary source unit</a> does not start with a <a data-link-type="dfn" href="#module-declaration" id="ref-for-module-declaration">module declaration</a>, the module comprises only a single source unit, and the name of the module must be determined by some implementation-specified method.
A <a data-link-type="dfn" href="#primary-source-unit" id="ref-for-primary-source-unit③">primary source unit</a> without a <a data-link-type="dfn" href="#module-declaration" id="ref-for-module-declaration①">module declaration</a> must not contain any <code>include</code> declarations.</p>
   <p class="note" role="note"><span class="marker">Note:</span> An implementation might derive a default module name from a file name/path, command-line arguments, build configuration files, etc.</p>
   <p class="note" role="note"><span class="marker">Note:</span> A module might be defined in a single source unit, but have code spread across multiple files.
For example, <code>#include</code> directives might be used so that the content of a single <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit①⑦">source unit</a> comes from multiple files.</p>
   <p>A <a data-link-type="dfn" href="#module-declaration" id="ref-for-module-declaration②">module declaration</a> must always be the first declaration in its <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit①⑧">source unit</a>.
A <a data-link-type="dfn" href="#module-declaration" id="ref-for-module-declaration③">module declaration</a> must not appear in any <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit①⑨">source unit</a> that is not a primary <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit②⓪">source unit</a>.</p>
   <h3 class="heading settled" data-level="7.2" id="module.source.secondary"><span class="secno">7.2. </span><span class="content">Seconary Source Units</span><a class="self-link" href="#module.source.secondary"></a></h3>
   <p>Any <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit②①">source units</a> in a module other than the <a data-link-type="dfn" href="#primary-source-unit" id="ref-for-primary-source-unit④">primary source unit</a> are <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="secondary-source-units">secondary source units</dfn>.</p>
   <h4 class="heading settled" data-level="7.2.1" id="module.include"><span class="secno">7.2.1. </span><span class="content">Include Declarations</span><a class="self-link" href="#module.include"></a></h4>
   <p>Secondary <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit②②">source units</a> are included into a module via <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="include-declarations">include declarations</dfn>.</p>
<pre class="language-.syntax">IncludeDeclaration :
    `include` path:PathSpecifier `;`

PathSpecifier :
    PathElement ( `.` PathElement )*

PathElement :
    Identifier
    | StringLiteral
</pre>
   <p>An implementation must use the <var>path</var> given in an <a data-link-type="dfn" href="#include-declarations" id="ref-for-include-declarations">include declaration</a> to identify a <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit②③">source unit</a> via implementation-specified means.
It is an error if <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit②④">source unit</a> matching the given name cannot be identified.</p>
   <div class="note" role="note">
     Include declarations should not be confused with preprocessor <code>#include</code> directives. 
    <p>Each <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit②⑤">source unit</a> in a module is preprocessed independently, and the preprocessor state at the point where an <code>include</code> declaration appears does not have any impact on how the <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit②⑥">source unit</a> identified by that include declaration will be preprocessed.</p>
   </div>
   <p>A <a data-link-type="dfn" href="#module①" id="ref-for-module①">module</a> comprises the transitive closure of <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit②⑦">source units</a> referred to via <a data-link-type="dfn" href="#include-declarations" id="ref-for-include-declarations①">include declarations</a>.
An implementation must use an implementation-specified means to determine if multiple <a data-link-type="dfn" href="#include-declarations" id="ref-for-include-declarations②">include declarations</a> refer to the same <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit②⑧">source unit</a> or not.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Circular, and even self-referential, <code>include</code> declarations are allowed.</p>
   <h4 class="heading settled" data-level="7.2.2" id="module.implementing"><span class="secno">7.2.2. </span><span class="content">Implementing Declarations</span><a class="self-link" href="#module.implementing"></a></h4>
   <p>Secondary <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit②⑨">source units</a> must start with an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="implementing-declaration">implementing declaration</dfn>, naming the module that the <a data-link-type="dfn" href="#secondary-source-units" id="ref-for-secondary-source-units">secondary source unit</a> is part of:</p>
<pre class="language-.syntax">ImplementingDeclaration}
    `implementing` PathSpecifier `;`
</pre>
   <p class="note" role="note"><span class="marker">Note:</span> It is an error if the name on an <a data-link-type="dfn" href="#implementing-declaration" id="ref-for-implementing-declaration">implementing declaration</a> in a <a data-link-type="dfn" href="#secondary-source-units" id="ref-for-secondary-source-units①">secondary source unit</a> does not match the name on the <a data-link-type="dfn" href="#module-declaration" id="ref-for-module-declaration④">module declaration</a> of the corresponding primary <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit③⓪">source unit</a>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> <a data-link-type="dfn" href="#implementing-declaration" id="ref-for-implementing-declaration①">implementing declaration</a>s ensure that given a source unit, a tool can always identify the module that the <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit③①">source unit</a> is part of (which can in turn be used to identify all of the <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit③②">source units</a> in the module via its <code>include</code> declarations).</p>
   <p>An <a data-link-type="dfn" href="#implementing-declaration" id="ref-for-implementing-declaration②">implementing declaration</a> must always be the first declaration in its <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit③③">source unit</a>.
An <a data-link-type="dfn" href="#implementing-declaration" id="ref-for-implementing-declaration③">implementing declaration</a> must not appear in any <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit③④">source unit</a> that is not a secondary <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit③⑤">source unit</a>.</p>
   <h3 class="heading settled" data-level="7.3" id="module.import"><span class="secno">7.3. </span><span class="content">Import Declarations</span><a class="self-link" href="#module.import"></a></h3>
   <p>Modules may depend on one another via <code>import</code> declarations.</p>
<pre class="language-.syntax">ImportDeclaration :
  `import` PathSpecifier `;`
</pre>
   <p>An <code>import</code> declaration names a module, and makes the public declarations in the named module visible to the current <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit③⑥">source unit</a>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> An <code>import</code> declaration only applies to the scope of the current source unit, and does not import the chosen module so that it is visible to other <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit③⑦">source units</a> of the current module.</p>
   <p>Implementations must use an implementation-specified method to resolve the name given in an <code>import</code> declaration to a module.
Implementations may resolve an <code>import</code> declaration to a previously compiled module.
Implementations may resolve an <code>import</code> declaration to a source unit, and then attempt to compile a module using that <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit③⑧">source unit</a> as its primary <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit③⑨">source unit</a>.
If an implementation fails to resolve the name given in an <code>import</code> declaration, it must diagnose an error.
If an implementation diagnoses erros when compiling a soure unit named via an <code>import</code> declaration fails, it must diagnose an error.</p>
   <div class="note" role="note">
     The current Slang implementation searches for a module by translating the specified module name into a file path by: 
    <ul>
     <li data-md>
      <p>Replacing any dot (<code>.</code>) separators in a compound name with path separators (e.g., <code>/</code>)</p>
     <li data-md>
      <p>Replacing any underscores (<code>_</code>) in the name with hyphens (<code>-</code>)</p>
     <li data-md>
      <p>Appending the extension <code>.slang</code></p>
    </ul>
    <p>The implementation then looks for a file matching this path on any of its configured search paths.
If such a file is found it is loaded as a module comprising a single <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit④⓪">source unit</a>.</p>
   </div>
   <h2 class="heading settled" data-level="8" id="decl"><span class="secno">8. </span><span class="content">Declarations</span><a class="self-link" href="#decl"></a></h2>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="declaration">declaration</dfn> is a unit of syntax that typically affects what names are visibile in a scope, and how those names are interpreted.
In the abstract syntax, a <a data-link-type="dfn" href="#source-unit" id="ref-for-source-unit④①">source unit</a> comprises a sequence of declarations.</p>
<pre class="language-.syntax">SourceUnit
    ( ModuleDeclaration | ImplementingDeclaration ) ?
    IncludeDeclaration*
    ImportDeclaration*
    ( Declaration )*
</pre>
   <p>A declaration may be preceded by zero or more modifiers.</p>
<pre class="language-.syntax">Declaration
    Modifier Declaration
    | VariableDeclaration
    | FunctionDeclaration
    | TypeDeclaration
</pre>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="binding">binding</dfn> is an association of an identifier with a specific entity, such as a declaration.
A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="scope">scope</dfn> is a set of bindings.</p>
   <p class="note" role="note"><span class="marker">Note:</span> A scope may include more than one binding for the same identifier.</p>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="environment">environment</dfn> is either the unique <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="empty-environment">empty environment</dfn>, or it comprises a scope that is the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="local-scope">local scope</dfn> of that environment, and a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parent-environment">parent environment</dfn>.</p>
   <p>For each production in the abtract syntax, there is a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="input-environment">input environment</dfn> in effect at the start of that production, and an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="output-environment">output environment</dfn> in effect after that production.
Each production determines the input environment used by its sub-terms.
When the description of a production does not say otherwise:</p>
   <ul>
    <li data-md>
     <p>The input environment of a production’s first sub-term is the input environment of that production.</p>
    <li data-md>
     <p>The input environment of each sub-term other than the first is the output environment of the preceding sub-term.</p>
    <li data-md>
     <p>The output environment of the entire production is the output environment of its last sub-term.</p>
   </ul>
   <p>The output environment of a token is its input environment.
The output environment of an empty production is its input environment.</p>
   <p>When we say that a declaration <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="introduces">introduces</dfn> a binding, we mean that its output environment is the output environment of its last sub-term extended with that binding.</p>
   <h3 class="heading settled" data-level="8.1" id="decl.shared"><span class="secno">8.1. </span><span class="content">Shared Concepts</span><a class="self-link" href="#decl.shared"></a></h3>
   <h4 class="heading settled" data-level="8.1.1" id="decl.body"><span class="secno">8.1.1. </span><span class="content">Bodies</span><a class="self-link" href="#decl.body"></a></h4>
   <h4 class="heading settled" data-level="8.1.2" id="decl.base"><span class="secno">8.1.2. </span><span class="content">Bases</span><a class="self-link" href="#decl.base"></a></h4>
   <h4 class="heading settled" data-level="8.1.3" id="decl.param"><span class="secno">8.1.3. </span><span class="content">Parameters</span><a class="self-link" href="#decl.param"></a></h4>
   <h4 class="heading settled" data-level="8.1.4" id="decl.accessor"><span class="secno">8.1.4. </span><span class="content">Accessors</span><a class="self-link" href="#decl.accessor"></a></h4>
   <h3 class="heading settled" data-level="8.2" id="decl.generic"><span class="secno">8.2. </span><span class="content">Generics</span><a class="self-link" href="#decl.generic"></a></h3>
   <h3 class="heading settled" data-level="8.3" id="decl.type"><span class="secno">8.3. </span><span class="content">Type Declarations</span><a class="self-link" href="#decl.type"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="type-declaration">type declaration</dfn> introduces a binding to a type.</p>
<pre class="language-.syntax">TypeDeclaration
    AggregateTypeDeclaration
    | EnumDeclaration
    | TypeAliasDeclaration
</pre>
   <h4 class="heading settled" data-level="8.3.1" id="decl.agg"><span class="secno">8.3.1. </span><span class="content">Aggregate Types</span><a class="self-link" href="#decl.agg"></a></h4>
<pre class="language-.syntax">AggregateTypeDeclaration
    (`struct` | `class` | `interface`) Identifier
    GenericParametersClause?
    BasesClause?
    GenericWhereClause?
    DeclarationBodyClause `;`?

DeclarationBodyClause
    `{` Declaration* `}` 
</pre>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="aggregate-type-declaration">aggregate type declaration</dfn> is either a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="struct-declaration"><code>struct</code> declaration</dfn>, a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="class-declaration"><code>class</code> declaration</dfn>, or an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="interface-declaration"><code>interface</code> declaration</dfn>.</p>
   <p>The declarations in the body clause of an aggregate type declaration are referred the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="direct-members">direct members</dfn> of that declaration.</p>
   <h5 class="heading settled" data-level="8.3.1.1" id="static"><span class="secno">8.3.1.1. </span><span class="content">Instance and Static Members</span><a class="self-link" href="#static"></a></h5>
   <p>Members of an aggregate type may me marked with a <code>static</code> modifier, in which case they are <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="static-members">static members</dfn> of the type.
Members not marked with <code>static</code> are <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="instance-members">instance members</dfn> of the type.</p>
   <p>Static members are referenced through the type itself.
Instance members are referened through values that are instances of the type.</p>
   <h5 class="heading settled" data-level="8.3.1.2" id="field"><span class="secno">8.3.1.2. </span><span class="content">Fields</span><a class="self-link" href="#field"></a></h5>
   <p>Variable declarations that are instance members of an aggregate type declaration are also referred to as the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="fields">fields</dfn> of the aggregate type declaration.</p>
   <h5 class="heading settled" data-level="8.3.1.3" id="method"><span class="secno">8.3.1.3. </span><span class="content">Methods</span><a class="self-link" href="#method"></a></h5>
   <p>Function declarations that are instance members of an aggregate type declaration are also referred to as <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="methods">methods</dfn>.</p>
   <p>By default, the implicit <code>this</code> parameter of a method acts has a direction of <code>in</code>.
A method of a <code>struct</code> type declaration may be modified with the <code>[mutating]</code> attribute, in which case the implicit <code>this</code> parameter has a direction of <code>inout</code>.</p>
   <h4 class="heading settled" data-level="8.3.2" id="decl.agg.bases"><span class="secno">8.3.2. </span><span class="content">Bases</span><a class="self-link" href="#decl.agg.bases"></a></h4>
<pre class="language-.syntax">BasesClause
    `:`Base (`,`Base)*

Base
    TypeExpression
</pre>
   <p>An aggregate type declaration has zero or more <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="bases">bases</dfn>.
If an aggregate type declaration has no bases clause, then it has zero bases;
otherwise, the bases of the aggregate type declaration are the types identified by eachBase in that clause.</p>
   <p>The list of bases of a <code>struct</code> declaration must consist of:</p>
   <ul>
    <li data-md>
     <p>at most one <code>struct</code> type</p>
    <li data-md>
     <p>zero or more interface types</p>
   </ul>
   <p>The list of bases of a <code>class</code> declaration must consist of:</p>
   <ul>
    <li data-md>
     <p>at most one <code>class</code> type</p>
    <li data-md>
     <p>zero or more interface types</p>
   </ul>
   <p>The list of bases of an <a data-link-type="dfn" href="#interface-declaration" id="ref-for-interface-declaration">interface declaration</a> must consist of:</p>
   <ul>
    <li data-md>
     <p>zero or more interface types</p>
   </ul>
   <h5 class="heading settled" data-level="8.3.2.1" id="decl.agg.syntax"><span class="secno">8.3.2.1. </span><span class="content">Traditional Syntax</span><a class="self-link" href="#decl.agg.syntax"></a></h5>
   <h6 class="heading settled" data-level="8.3.2.1.1" id="trailing-semicolon"><span class="secno">8.3.2.1.1. </span><span class="content">Trailing Semicolon #####</span><a class="self-link" href="#trailing-semicolon"></a></h6>
   <p>For compatibility, the body clause of an aggregate type declaration may end with a semicolon (<code>;</code>).
The body clause of an aggregate type declaration must end with a semicolon if there are any tokens between the closing <code>}</code> token and the next line break that follows it.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Put more simply: a closing <code>;</code> is not required on an aggregate type declaration so long as there is nothing but trivia after it on the same line.</p>
   <h6 class="heading settled" data-level="8.3.2.1.2" id="decl.agg.type-specifier"><span class="secno">8.3.2.1.2. </span><span class="content">Aggregate Type Specifiers</span><a class="self-link" href="#decl.agg.type-specifier"></a></h6>
   <p>An aggregate type declaration may be used as a type specififer in declarations using traditional syntax.</p>
   <p>When an aggregate type declaration is used as a type specififer, the closing <code>}</code> of its body must be followed by another token on the same line.</p>
   <h4 class="heading settled" data-level="8.3.3" id="decl.enum"><span class="secno">8.3.3. </span><span class="content"><code>enum</code> Declarations</span><a class="self-link" href="#decl.enum"></a></h4>
<pre class="language-.syntax">EnumDeclaration
    `enum` Identifier
    GenericParametersClause?
    BasesClause?
    GenericWhereClause?
    EnumBody `;`?

EnumBody
    TraditionalEnumBody
    | DeclarationBody
</pre>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="enum-declaration"><code>enum</code> declaration</dfn> introduces a binding for a type whose instances value into one or more cases.</p>
   <p>An <a data-link-type="dfn" href="#enum-declaration" id="ref-for-enum-declaration">enum declaration</a> that has a declaration body is a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="modern-enum-declaration">modern <code>enum</code> declaration</dfn>.
A <a data-link-type="dfn" href="#enum-declaration" id="ref-for-enum-declaration①">enum declaration</a> that has a traditional <code>enum</code> body is a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="traditional-enum-declaration">traditional <code>enum</code> declaration</dfn>.</p>
   <p>An <a data-link-type="dfn" href="#enum-declaration" id="ref-for-enum-declaration②">enum declaration</a> may have a bases clause, in which case the list of bases must consist of:</p>
   <ul>
    <li data-md>
     <p>at most one proper type; if present, this determines an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="underlying-type">underlying type</dfn> for the <code>enum</code> declaration.</p>
    <li data-md>
     <p>zero or more interface types</p>
   </ul>
   <p>A traditional <a data-link-type="dfn" href="#enum-declaration" id="ref-for-enum-declaration③">enum declaration</a> always has an underlying type.
If an underlying type is not specified in the bases list of a traditional <code>enum</code> declaration, then the underlying type of that declaration is <code>Int</code>.
The underlying type of a traditional <a data-link-type="dfn" href="#enum-declaration" id="ref-for-enum-declaration④">enum declaration</a> must be a built-in integer type.</p>
   <p>A modern <a data-link-type="dfn" href="#enum-declaration" id="ref-for-enum-declaration⑤">enum declaration</a> must not specify an underlying type.</p>
   <h5 class="heading settled" data-level="8.3.3.1" id="case"><span class="secno">8.3.3.1. </span><span class="content">Cases</span><a class="self-link" href="#case"></a></h5>
<pre class="language-.syntax">CaseDeclaration :
    `case` Identifier InitialValueClause?
        
TraditionalEnumBody :
    `{` (TraditionalCaseDeclaration `,`)* `}`

TraditionalCaseDeclaration :
    Identifier InitialValueClause?
</pre>
   <p>The possible values of an <code>enum</code> type are determined by the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="case-declarations">case declarations</dfn> in its body.
An <code>enum</code> type has one case for each case declaration in its body.</p>
   <p>The case declarations in a modern <a data-link-type="dfn" href="#enum-declaration" id="ref-for-enum-declaration⑥">enum declaration</a> are declared using the <code>case</code> keyword.
The case declarations in a traditional <code>enum</code> body are <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="traditional-case-declarations">traditional case declarations</dfn>.</p>
   <p>Each case of a traditional <a data-link-type="dfn" href="#enum-declaration" id="ref-for-enum-declaration⑦">enum declaration</a> has an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="underlying-value">underlying value</dfn>, that is a value of the underlying type of that <code>enum</code> declaration.
When a traditional case declaration includes an initial-value expression, its underlying value is the result of evaluating that expression, with the underlying type of the <a data-link-type="dfn" href="#enum-declaration" id="ref-for-enum-declaration⑧">enum declaration</a> as the expected type.
The underlying value of a traditional case declaration must be an compile-time-constant integer value.
If a traditional case declaration does not have an initial-value expression, then its underlying value is one greater than the underlying value of the preceding case declaration, or zero if there is no preceding case declaration.</p>
   <p>Case declarations are implicitly static.</p>
   <h4 class="heading settled" data-level="8.3.4" id="decl.type.alias"><span class="secno">8.3.4. </span><span class="content">Type Aliases</span><a class="self-link" href="#decl.type.alias"></a></h4>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="type-alias-declaration">type alias declaration</dfn> introduces a binding that resolves to some other type.</p>
<pre class="language-.syntax">TypeAliasDeclaration :
    ModernTypeAliasDeclaration
    | TraditionalTypeAliasDeclaration

ModernTypeAliasDeclaration :
    `typealias` Identifier
    GenericParametersClause?
    GenericWhereClause?
    `=` TypeExpression `;`
</pre>
<pre class="language-.checking">GIVEN identifier n, type t, context c
GIVEN t checks in c
THEN `typealias` n = t `;` checks in c
</pre>
   <h5 class="heading settled" data-level="8.3.4.1" id="decl.type.alias.syntax.traditional"><span class="secno">8.3.4.1. </span><span class="content">Traditional Syntax</span><a class="self-link" href="#decl.type.alias.syntax.traditional"></a></h5>
   <p>A type alias may also be declared using a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="traditional-type-alias-declaration">traditional type alias declaration</dfn>.</p>
<pre class="language-.syntax">TraditionalTypeAliasDeclaration :
    `typedef` TypeSpecifier Declarator `;`
</pre>
   <h4 class="heading settled" data-level="8.3.5" id="decl.type.associated"><span class="secno">8.3.5. </span><span class="content">Associated Types</span><a class="self-link" href="#decl.type.associated"></a></h4>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="associated-type-declaration">associated type declaration</dfn> introduces a type requirement to an <a data-link-type="dfn" href="#interface-declaration" id="ref-for-interface-declaration①">interface declaration</a>.</p>
<pre class="language-.syntax">AssociatedTypeDeclaration
    `associatedtype` Identifier
    GenericParametersClause?
    BasesClause?
    GenericWhereClause? `;`
</pre>
   <p>An associated type declaration may only appear as a member declaration of an <a data-link-type="dfn" href="#interface-declaration" id="ref-for-interface-declaration②">interface declaration</a>.</p>
   <p>An associated type is an interface requirement, and different implementations of an interface may provide different types that satisfy the same associated type interface requirement.</p>
   <h3 class="heading settled" data-level="8.4" id="decl.var"><span class="secno">8.4. </span><span class="content">Variables</span><a class="self-link" href="#decl.var"></a></h3>
<pre class="language-.syntax">VariableDeclaration :
    (`let` | `var`) Identifier
        TypeAscriptionClause?
        InitialValueClause? `;`

TypeAscriptionClause :
    `:` TypeExpression

InitialValueClause :
    `=` Expression
</pre>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="variable">variable</dfn> is a storage location that can hold a value.
Every variable has a type, and it can only hold values of that type.
Every variable is either immutable or mutable.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="variable-declaration">variable declaration</dfn> introduces a binding for the given Identifier, to a variable.
A variable declaration using the <code>let</code> keyword binds an immutable variable.
A variable declaration using the <code>var</code> keyword binds a mutable variable.</p>
   <p>Every variable declaration has a type, and the variable it binds is of the same type.</p>
   <p>A variable declaration must have either a TypeAscriptionClause or an InitialValueClause; a variable declaration may have both.</p>
   <p>If a variable declaration has a type ascription, then let <var>T</var> be the type that results from evaluating the type expression of that type ascription in the input environment of the declaration.</p>
   <p>If a variable declaration has a TypeAscriptionClause and no InitialValueClause, then the type of that variable declaration is <var>T</var>.</p>
   <p>If a variable declaration has both a TypeAscriptionClause and an InitialValueClause, then let <var>E</var> be the value that results from evaluating the expression of the initial value clause against the expected type <var>T</var> in the input environment of the declaration.
The type of the variable declaration is the type of <var>E</var>, and its initial value is <var>E</var>.</p>
   <p>If a variable declaration has an InitialValueClause but no TypeAscriptionClause, then let <var>E</var> be the value that results from evaluating the expression of the initial value clause in the input environment of the declaration.
The type of the variable declaration is the type of <var>E</var>, and its initial value is <var>E</var>.</p>
   <h4 class="heading settled" data-level="8.4.1" id="decl.var.traditional"><span class="secno">8.4.1. </span><span class="content">Traditional Variable Declarations</span><a class="self-link" href="#decl.var.traditional"></a></h4>
   <p>Variable declaration may also be declared using traditional syntax, which is similar to C:</p>
<pre class="language-.syntax">VariableDeclaration :
    LegacyVariableDeclaration

LegacyVariableDeclaration :
    TypeSpecifier InitDeclarator * `;`

InitDeclarator :
    Declarator InitialValueClause ?
</pre>
   <p>A legacy variable declaration introduces a binding for each InitDeclarator.
Let <var>S</var> be the type that results from evaluating the TypeSpecifier in the input environment.
The type <var>T</var> corresponding to each declarator is determined by evaluating the declarator in the input environment, against input type <var>S</var>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Slang does not support the equivalent of the <code>auto</code> type specifier in C++.
Variables declared using <code>let</code> and <code>var</code> can be used to fill a similar role.</p>
   <p>The variables introduced by a legacy variable declaration are immutable if the declaration has a <code>const</code> modifier; otherwise it is mutable.</p>
   <h4 class="heading settled" data-level="8.4.2" id="decl.var.global"><span class="secno">8.4.2. </span><span class="content">Variables at Global Scope</span><a class="self-link" href="#decl.var.global"></a></h4>
   <p>A variable declaration at global scope may be either a global constant, a static global variable, or a global shader parameter.</p>
   <p>Variables declared at global scope may be either a global constant, a static global variables, or a global shader parameters.</p>
   <h5 class="heading settled" data-level="8.4.2.1" id="const"><span class="secno">8.4.2.1. </span><span class="content">Global Constants</span><a class="self-link" href="#const"></a></h5>
   <p>A variable declared at global scope and marked with <code>static</code> and <code>const</code> is a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="global-constant">global constant</dfn>.</p>
   <p>A global constant must have an initial-value clause, and the initial-value expression must be a compile-time constant expression.</p>
   <p class="issue" id="issue-d245d890"><a class="self-link" href="#issue-d245d890"></a> Need a section to define what a "compile-time constant expression" is.</p>
   <h5 class="heading settled" data-level="8.4.2.2" id="global.static"><span class="secno">8.4.2.2. </span><span class="content">Static Global Variables</span><a class="self-link" href="#global.static"></a></h5>
   <p>A variable declared at global scope and marked with <code>static</code> but not with <code>const</code> is a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="static-global-variable">static global variable</dfn>.</p>
   <p>A static global variable provides storage for each invocation executing an entry point.
Writes to a static global variable from one invocation do not affect the value seen by other invocations.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The semantics of static global variable are similar to a "thread-local" variable in other programming models.</p>
   <p>A static global variable may include an initial-value expression; if an initial-value expression is included it is guaranteed to be evaluated and assigned to the variable before any other expression that references the variable is evaluated.
If a thread attempts to read from a static global variable during the evaluation of the initial-value expression for that variable, a runtime error is raised.</p>
   <p>There is no guarantee that the initial-value expression for a static global variable is evaluated before entry point execution begins, or even that the initial-value expression is evaluated at all (in cases where the variable might not be referenced at runtime).</p>
   <p class="note" role="note"><span class="marker">Note:</span> The above rules mean that an implementation may perform dead code elimination on static global variables, and may choose between eager and lazy initialization of those variables at its discretion.</p>
   <h5 class="heading settled" data-level="8.4.2.3" id="global.param"><span class="secno">8.4.2.3. </span><span class="content">Global Shader Parameters</span><a class="self-link" href="#global.param"></a></h5>
   <p>A variable declared at global scope and not marked with <code>static</code> is a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="global-shader-parameter">global shader parameter</dfn>.</p>
   <p>Global shader parameters are used to pass arguments from application code into invocations of an entry point.
The mechanisms for parameter passing are specific to each target platform.</p>
   <p>A global shader parameter may include an initial-value expression, but such an expression does not affect the semantics of the compiled program.</p>
   <p class="note" role="note"><span class="marker">Note:</span> An implementation may choose to provide ways to query the initial-value expression of a global shader parameter, or to evaluate it to a value.
Host applications may use such capabilities to establish a default value for global shader parameters.</p>
   <h4 class="heading settled" data-level="8.4.3" id="decl.var.func"><span class="secno">8.4.3. </span><span class="content">Variables at Function Scope</span><a class="self-link" href="#decl.var.func"></a></h4>
   <p>Variables declared at <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="function-scope">function scope</dfn> (in the body of a function, initializer, subscript acessor, etc.) may be either a function-scope constant, function-scope static variable, or a local variable.</p>
   <h5 class="heading settled" data-level="8.4.3.1" id="const①"><span class="secno">8.4.3.1. </span><span class="content">Function-Scope Constants</span><a class="self-link" href="#const①"></a></h5>
   <p>A variable declared at function scope and marked with both <code>static</code> and <code>const</code> is a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="function-scope-constant">function-scope constant</dfn>.
Semantically, a function-scope constant behaves like a global constant except that its name is only bound in the local scope.</p>
   <h5 class="heading settled" data-level="8.4.3.2" id="static①"><span class="secno">8.4.3.2. </span><span class="content">Function-Scope Static Variables</span><a class="self-link" href="#static①"></a></h5>
   <p>A variable declared at function scope and marked with <code>static</code> (but not <code>const</code>) is a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="function-scope-static-variable">function-scope static variable</dfn>.
Semantically, a function-scope static variable behaves like a global static variable except that its name is only visible in the local scope.</p>
   <p>The initial-value expression for a function-scope static variable may refer to non-static variables in the body of the function.
In these cases initialization of the variable is guaranteed not to occur until at least the first time the function body is evaluated for a given invocation.</p>
   <h5 class="heading settled" data-level="8.4.3.3" id="local"><span class="secno">8.4.3.3. </span><span class="content">Local Variables</span><a class="self-link" href="#local"></a></h5>
   <p>A variable declared at function scope and not marked with <code>static</code> (even if marked with <code>const</code>) is a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="local-variable">local variable</dfn>.
A local variable has unique storage for each activation of a function.</p>
   <p class="note" role="note"><span class="marker">Note:</span> When a function is called recursively, each call produces a distinct activation with its own copies of local variables.</p>
   <h3 class="heading settled" data-level="8.5" id="decl.func"><span class="secno">8.5. </span><span class="content">Functions</span><a class="self-link" href="#decl.func"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="function-declaration">function declaration</dfn> introduces a binding to a function.</p>
<pre class="language-.syntax">FunctionDeclaration :
    `func` Identifier
    GenericParametersClause?
    ParametersClause
    GenericWhereClause?
    ResultTypeClause?
    FunctionBodyClause
</pre>
   <h4 class="heading settled" data-level="8.5.1" id="decl.param①"><span class="secno">8.5.1. </span><span class="content">Parameters</span><a class="self-link" href="#decl.param①"></a></h4>
   <p>The parameters of a function declaration are determined by the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parameter-declarations">parameter declarations</dfn> in its parameters clause.</p>
<pre class="language-.syntax">ParametersClause
    `(` (ParameterDeclaration `,`)* `)`

ParameterDeclaration
    Identifier `:` Direction? TypeExpression DefaultValueClause?

DefaultValueClause
    `=` Expression
</pre>
   <p>A parameter declaration must include a type expression; the type of the parameter is the result of evaluating that type expression.</p>
   <p>A parameter declaration may include a default-value clause; it it does, the default value for that parameter is the result of evaluating the expression in that clause with an expected type that is the type of the parameter.</p>
   <h5 class="heading settled" data-level="8.5.1.1" id="dir"><span class="secno">8.5.1.1. </span><span class="content">Directions</span><a class="self-link" href="#dir"></a></h5>
   <p>Every parameter has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="direction">direction</dfn>, which determines how an argument provided at a call site is connected to that parameter.</p>
<pre class="language-.syntax">Direction
    `in`
    | `out`
    | `take`
    | `borrow`
    | `inout` | `in` `out`
    | `ref`
</pre>
   <p>If a parameter declaration includes a Direction, then that determines the direction of the parameter; otherwise the direction of the parameter is <code>in</code>.</p>
   <h6 class="heading settled" data-level="8.5.1.1.1" id="dir.in"><span class="secno">8.5.1.1.1. </span><span class="content"><code>in</code></span><a class="self-link" href="#dir.in"></a></h6>
   <p>The <code>in</code> direction indicates typical pass-by-value (copy-in) semantics.
The parameter in the callee binds to a copy of the argument value passed by the caller.</p>
   <h6 class="heading settled" data-level="8.5.1.1.2" id="out"><span class="secno">8.5.1.1.2. </span><span class="content"><code>out</code></span><a class="self-link" href="#out"></a></h6>
   <p>The <code>out</code> direction indicates copy-out semantics.
The parameter in the callee binds to a fresh storage location that is uninitialized on entry.
When the callee returns, the value in that location is moved to the storage location referenced by the argument.</p>
   <h6 class="heading settled" data-level="8.5.1.1.3" id="take"><span class="secno">8.5.1.1.3. </span><span class="content"><code>take</code></span><a class="self-link" href="#take"></a></h6>
   <p>The <code>take</code> direction indicates move-in semantics.
The argument provided by the caller is moved into the parameter of the callee, ending the lifetime of the argument.</p>
   <h6 class="heading settled" data-level="8.5.1.1.4" id="borrow"><span class="secno">8.5.1.1.4. </span><span class="content"><code>borrow</code></span><a class="self-link" href="#borrow"></a></h6>
   <p>The <code>borrow</code> direction indicates immutable borrow semantics.</p>
   <p>If the parameter has a noncopyable type, then the parameter in the callee binds to the storage location referenced by the argument.</p>
   <p>If the parameter has a copyable type, then the parameter in the callee may, at the discretion of the implementation, bind to either the storage location referenced by the argument, or a copy of the argument value.</p>
   <h6 class="heading settled" data-level="8.5.1.1.5" id="inout"><span class="secno">8.5.1.1.5. </span><span class="content"><code>inout</code></span><a class="self-link" href="#inout"></a></h6>
   <p>The <code>inout</code> direction indicates exclusive mutable borrow semantics.
The syntax <code>in</code> out} is equivalent to <code>inout</code></p>
   <p>If the parameter has a noncopyable type, then the parameter in the callee binds to the storage location referenced by the argument.</p>
   <p>If the parameter has a copyable type, then the parameter in the callee may, at the discretion of the implementation, bind to either:</p>
   <ul>
    <li data-md>
     <p>the storage location referenced by the argument</p>
    <li data-md>
     <p>a fresh storage location, in which case that location is initialized with a copy of the argument value on entry, and the value at that location is written to the argument on return from the function.</p>
   </ul>
   <h6 class="heading settled" data-level="8.5.1.1.6" id="ref"><span class="secno">8.5.1.1.6. </span><span class="content"><code>ref</code></span><a class="self-link" href="#ref"></a></h6>
   <p>The <code>ref</code> direction indicates pass-by-reference semantics.
The parameter in the callee binds to the storage location referenced by the argument.</p>
   <h4 class="heading settled" data-level="8.5.2" id="decl.func.result"><span class="secno">8.5.2. </span><span class="content">Result Type</span><a class="self-link" href="#decl.func.result"></a></h4>
<pre class="language-.syntax">ResultTypeClause :
    `->` TypeExpression
</pre>
   <p>Every function has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="result-type">result type</dfn>, which is the type of value that results from calling that function.
If a function declaration has a result type clause, then the result type of the function is the type that results from evaluating the type expression in that clause.
If a function declaration does not have a result type clause, then the result type of the function is <code>void</code>.</p>
   <h4 class="heading settled" data-level="8.5.3" id="decl.func.body"><span class="secno">8.5.3. </span><span class="content">Body</span><a class="self-link" href="#decl.func.body"></a></h4>
<pre class="language-.syntax">FunctionBodyClause :
    BlockStatement
    | `;`
</pre>
   <p>A function declaration may have a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="body">body</dfn>.
A function declaration with a body is a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="function-definition">function definition</dfn>.</p>
   <p>If the function body clause is a block statement, then that statement is the body of the function declaration.
If the function body clause is <code>;</code>, then that function declaration has no body.</p>
   <h4 class="heading settled" data-level="8.5.4" id="decl.func.traditional"><span class="secno">8.5.4. </span><span class="content">Traditional Function Declarations</span><a class="self-link" href="#decl.func.traditional"></a></h4>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="traditional-function-declaration">traditional function declaration</dfn> is a function declaration that uses traditional C-like syntax.</p>
<pre class="language-.syntax">TraditionalFunctionDeclaration :
    TypeSpecifier Declarator
    GenericParametersClause?
    TraditionalParametersClause
    GenericWhereClause?
    FunctionBodyClause

TraditionalParametersClause :
    `(` (TraditionalParameterDeclaration `,`) * `)`

TraditionalParameterDeclaration :
    Direction TypeSpecifier Declarator DefaultValueClause?
</pre>
   <h4 class="heading settled" data-level="8.5.5" id="decl.func.entry"><span class="secno">8.5.5. </span><span class="content">Entry Points</span><a class="self-link" href="#decl.func.entry"></a></h4>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="entry-point-declaration">entry point declaration</dfn> is a function declaration that can be used as the starting point of execution for a thread.</p>
   <h3 class="heading settled" data-level="8.6" id="decl.init"><span class="secno">8.6. </span><span class="content">Constructors</span><a class="self-link" href="#decl.init"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="constructor-declaration">constructor declaration</dfn> introduces logic for initializing an instance of the enclosing type declaration.
A constructor declaration is implicitly static.</p>
<pre class="language-.syntax">ConstructorDeclaration :
    `init`
    GenericParametersClause?
    ParametersClause
    FunctionBodyClause
</pre>
   <p>A constructor declaratin has an implicit <code>this</code> parameter, with a direction of <code>out</code>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Slang does not provide any equivalent to C++ destructors, which run automatically when an instance goes out of scope.</p>
   <h3 class="heading settled" data-level="8.7" id="decl.prop"><span class="secno">8.7. </span><span class="content">Properties</span><a class="self-link" href="#decl.prop"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="property-declaration">property declaration</dfn> introduces a binding that can have its behavior for read and write operations customized.</p>
<pre class="language-.syntax">PropertyDeclaration :
    `property`
    Identifier
    GenericParametersClause?
    TypeAscriptionClause
    GenericWhereClause
    PropertyBody

PropertyBody
    `{` AccessorDecl* `}`
</pre>
   <h4 class="heading settled" data-level="8.7.1" id="decl.accessor①"><span class="secno">8.7.1. </span><span class="content">Accessors</span><a class="self-link" href="#decl.accessor①"></a></h4>
<pre class="language-.syntax">AccessorDecl
    GetAccessorDecl
    SetAccessorDecl

GetAccessorDecl
    `get` FunctionBodyClause

SetAccessorDecl
    `set` ParametersClause? FunctionBodyClause
</pre>
   <h3 class="heading settled" data-level="8.8" id="decl.subscript"><span class="secno">8.8. </span><span class="content">Subscripts</span><a class="self-link" href="#decl.subscript"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="subscript-declaration">subscript declaration</dfn> introduces a way for the enclosing type to be used as the base expression of a subscript expression.</p>
<pre class="language-.syntax">SubscriptDeclaration :
    `subscript`
    GenericParametersClause?
    ParametersClause
    ResultTypeClause
    GenericWhereClause
    PropertyBody
</pre>
   <p class="note" role="note"><span class="marker">Note:</span> Unlike a function declaration, a subscript declaration cannot elide the result type clause.</p>
   <h3 class="heading settled" data-level="8.9" id="decl.extension"><span class="secno">8.9. </span><span class="content">Extensions</span><a class="self-link" href="#decl.extension"></a></h3>
   <p>An extension declaration is introduced with the <code>extension</code> keyword:</p>
<pre>extension MyVector
{
    float getLength() { return sqrt(x*x + y*y); }
    static int getDimensionality() { return 2; }
}
</pre>
   <p>An extension declaration adds behavior to an existing type.
In the example above, the <code>MyVector</code> type is extended with an instance method <code>getLength()</code>, and a static method <code>getDimensionality()</code>.</p>
   <p>An extension declaration names the type being extended after the <code>extension</code> keyword.
The body of an extension declaration may include type declarations, functions, initializers, and subscripts.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The body of an extension must <em>not</em> include variable declarations.
An extension cannot introduce members that would change the in-memory layout of the type being extended.</p>
   <p>The members of an extension are accessed through the type that is being extended.
For example, for the above extension of <code>MyVector</code>, the introduced methods are accessed as follows:</p>
<pre>MyVector v = ...;

float f = v.getLength();
int n = MyVector.getDimensionality();
</pre>
   <p>An extension declaration need not be placed in the same module as the type being extended; it is possible to extend a type from third-party or standard-library code.
The members of an extension are only visible inside of modules that <code>import</code> the module declaring the extension;
extension members are not automatically visible wherever the type being extended is visible.</p>
   <p>An extension declaration may include an inheritance clause:</p>
<pre>extension MyVector : IPrintable
{
    ...
}
</pre>
   <p>The inheritance clause of an extension declaration may only include interfaces.
When an extension declaration lists an interface in its inheritance clause, it asserts that the extension introduces a new conformance, such that the type being extended now conforms to the given interface.
The extension must ensure that the type being extended satisfies all the requirements of the interface.
Interface requirements may be satisfied by the members of the extension, members of the original type, or members introduced through other extensions visible at the point where the conformance was declared.</p>
   <p>It is an error for overlapping conformances (that is, of the same type to the same interface) to be visible at the same point.
This includes cases where two extensions declare the same conformance, as well as those where the original type and an extension both declare the same conformance.
The conflicting conformances may come from the same module or difference modules.</p>
   <div class="algorithm" data-algorithm="retroactive conformance">
     In order to avoid problems with conflicting conformances, when a module <var>M</var> introduces a conformance of type <var>T</var> to interface <var>I</var>, one of the following should be true: 
    <ul>
     <li data-md>
      <p>The type <var>T</var> is declared in module <var>M</var></p>
     <li data-md>
      <p>The interface <var>I</var> is declared in module <var>M</var></p>
    </ul>
    <p>Any conformance that does not follow these rules (that is, where both <var>T</var> and <var>I</var> are imported into module <var>M</var>) is called a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="retroactive-conformance">retroactive conformance</dfn>, and there is no way to guarantee that another module <var>N</var> will not introduce the same conformance.
The runtime behavior of programs that include overlapping retroactive conformances is currently undefined.</p>
   </div>
   <p>Currently, extension declarations can only apply to structure types.</p>
   <h3 class="heading settled" data-level="8.10" id="decl.generic①"><span class="secno">8.10. </span><span class="content">Generics</span><a class="self-link" href="#decl.generic①"></a></h3>
   <p>Many kinds of declarations can be made <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="generic">generic</dfn>: structure types, interfaces, extensions, functions, initializers, and subscripts.</p>
   <p>A generic declaration introduces a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="generic-parameter-list">generic parameter list</dfn> enclosed in angle brackets <code>&lt;></code>:</p>
<pre>T myFunction&lt;T>(T left, T right, bool condition)
{
    return condition ? left : right;
}
</pre>
   <h4 class="heading settled" data-level="8.10.1" id="decl.generic.param"><span class="secno">8.10.1. </span><span class="content">Generic Parameters</span><a class="self-link" href="#decl.generic.param"></a></h4>
   <p>A generic parameter list can include one or more parameters separated by commas.
The allowed forms for generic parameters are:</p>
   <ul>
    <li data-md>
     <p>A single identifier like <code>T</code> is used to declare a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="generic-type-parameter">generic type parameter</dfn> with no constraints.</p>
    <li data-md>
     <p>A clause like <code>T : IFoo</code> is used to introduce a generic type parameter <code>T</code> where the parameter is <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="constrained">constrained</dfn> so that it must conform to the <code>IFoo</code> interface.</p>
    <li data-md>
     <p>A clause like <code>let N : int</code> is used to introduce a generic value parameter <code>N</code>, which takes on values of type <code>int</code>.</p>
   </ul>
   <p class="note" role="note"><span class="marker">Note:</span> The syntax for generic value parameters is provisional and subject to possible change in the future.</p>
   <p>Generic parameters may declare a default value with <code>=</code>:</p>
<pre>T anotherFunction&lt;T = float, let N : int = 4>(vector&lt;T,N> v);
</pre>
   <p>For generic type parameters, the default value is a type to use if no argument is specified.
For generic value parameters, the default value is a value of the same type to use if no argument is specified.</p>
   <h4 class="heading settled" data-level="8.10.2" id="decl.generic.specialize.explicit"><span class="secno">8.10.2. </span><span class="content">Explicit Specialization</span><a class="self-link" href="#decl.generic.specialize.explicit"></a></h4>
   <p>A generic is <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="specialized">specialized</dfn> by applying it to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="generic-arguments">generic arguments</dfn> listed inside angle brackets <code>&lt;></code>:</p>
<pre>anotherFunction&lt;int, 3>
</pre>
   <p>Specialization produces a reference to the declaration with all generic parameters bound to concrete arguments.</p>
   <p>When specializing a generic, generic type parameters must be matched with type arguments that conform to the constraints on the parameter, if any.
Generic value parameters must be matched with value arguments of the appropriate type, and that are specialization-time constants.</p>
   <p>An explicitly specialized function, type, etc. may be used wherever a non-generic function, type, etc. is expected:</p>
<pre>int i = anotherFunction&lt;int,3>( int3(99) );
</pre>
   <h4 class="heading settled" data-level="8.10.3" id="decl.generic.specialize.implicit"><span class="secno">8.10.3. </span><span class="content">Implicit Specialization</span><a class="self-link" href="#decl.generic.specialize.implicit"></a></h4>
   <p>If a generic function/type/etc. is used where a non-generic function/type/etc. is expected, the compiler attempts <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="implicit-specialization">implicit specialization</dfn>.
Implicit specialization infers generic arguments from the context at the use site, as well as any default values specified for generic parameters.</p>
   <p>For example, if a programmer writes:</p>
<pre>int i = anotherFunction( int3(99) );
</pre>
   <p>The compiler will infer the generic arguments <code>&lt;int, 3></code> from the way that <code>anotherFunction</code> was applied to a value of type <code>int3</code>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Inference for generic arguments currently only takes the types of value arguments into account.
The expected result type does not currently affect inference.</p>
   <h4 class="heading settled" data-level="8.10.4" id="decl.generic.syntax"><span class="secno">8.10.4. </span><span class="content">Syntax Details</span><a class="self-link" href="#decl.generic.syntax"></a></h4>
   <p>The following examples show how generic declarations of different kinds are written:</p>
<pre>T genericFunction&lt;T>(T value);
funct genericFunction&lt;T>(value: T) -> T;

__init&lt;T>(T value);

__subscript&lt;T>(T value) -> X { ... }

struct GenericType&lt;T>
{
    T field;
}

interface IGenericInterface&lt;T> : IBase&lt;T>
{
}
</pre>
   <p class="note" role="note"><span class="marker">Note:</span> Currently there is no user-exposed syntax for writing a generic extension.</p>
   <h3 class="heading settled" data-level="8.11" id="decl.buffer"><span class="secno">8.11. </span><span class="content">Traditional Buffer Declarations</span><a class="self-link" href="#decl.buffer"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="traditional-buffer-declaration">traditional buffer declaration</dfn> is a shorthand for declaring a global-scope shader parameter.</p>
<pre class="language-.syntax">TraditionalBufferDeclaration :
    (`cbuffer` | `tbuffer`) Identifier DeclarationBody `;`?
</pre>
   <p>Given a traditional buffer declaration, an implementation shall behave as if the declaration were desugared into:</p>
   <ul>
    <li data-md>
     <p>A <code>struct</code> declaration with some unique name <var>S</var>, and with the declaration body of the buffer declaration.</p>
    <li data-md>
     <p>A global shader parameter declaration with some unique name <var>P</var>, where the type of the parameter is <code>ConstantBuffer&lt;S></code> in the case of a <code>cbuffer</code> declaration, or <code>TextureBuffer&lt;S></code> in the case of a <code>tbuffer</code> declaration.</p>
   </ul>
   <p>For each member declared in <var>S</var>, a traditional buffer declaration introduces a binding that refers to that member accessed through <var>P</var>.</p>
   <h2 class="heading settled" data-level="9" id="attribute"><span class="secno">9. </span><span class="content">Attributes</span><a class="self-link" href="#attribute"></a></h2>
   <p class="issue" id="issue-825e7e43"><a class="self-link" href="#issue-825e7e43"></a> This chapter needs to list the built-in attributes that impact the language semantics, and also to specify the rules for how user-define attributes are defined and used.</p>
   <h2 class="heading settled" data-level="10" id="vis"><span class="secno">10. </span><span class="content">Visibility Control</span><a class="self-link" href="#vis"></a></h2>
   <div class="issue" id="issue-7828c441">
    <a class="self-link" href="#issue-7828c441"></a> This chapter needs to explain the rules for: 
    <ul>
     <li data-md>
      <p>What declarations in a module are visible to modules that <code>import</code> it?</p>
     <li data-md>
      <p>What are the modifiers that can be used to control visibility (<code>public</code>, <code>internal</code>, <code>private</code>), and what are their semantics.</p>
     <li data-md>
      <p>What is the inferred visibility of a declaration without an explicit modifier?</p>
     <li data-md>
      <p>What are the rules about what modifiers are legal in what contexts?</p>
     <li data-md>
      <p>E.g., a <code>public</code> field should not be allowed in an <code>internal</code> type.</p>
     <li data-md>
      <p>E.g., a <code>public</code> function should not be allowed to have a non-<code>public</code> type used in its signature.</p>
     <li data-md>
      <p>How is visibility controlled for interface conformances?</p>
    </ul>
   </div>
   <h2 class="heading settled" data-level="11" id="stmt"><span class="secno">11. </span><span class="content">Statements</span><a class="self-link" href="#stmt"></a></h2>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="statement">statement</dfn> is an entity in the abstract syntax that describes actions to be taken by a thread.
Statements are executed for their effect, rather than evaluated to produce a value.</p>
<pre class="language-.syntax">Statement :
  ExpressionStatement
  | DeclarationStatement
  | BlockStatement
  | EmptyStatement
  | IfStatement
  | SwitchStatement
  | CaseStmt
  | ForStatement
  | WhileStatement
  | DoWhileStatement
  | BreakStatement
  | ContinueStatement
  | ReturnStatement
  | DiscardStatement
  | LabeledStatement
</pre>
   <h3 class="heading settled" data-level="11.1" id="stmt.expr"><span class="secno">11.1. </span><span class="content">Expression Statement</span><a class="self-link" href="#stmt.expr"></a></h3>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="expression-statement">expression statement</dfn> evaluates an expression, and then ignores the resulting value.</p>
<pre class="language-.syntax">ExpressionStatement :
  Expression `;`
</pre>
<pre class="language-.checking">GIVEN context c, expression e
GIVEN e synthesizes type t in context c
THEN e `;` checks in context c
</pre>
   <p>An implementation may diagnose a warning when execution of an expression statement cannot have side effects.</p>
   <h3 class="heading settled" data-level="11.2" id="expr.decl"><span class="secno">11.2. </span><span class="content">Declaration Statement</span><a class="self-link" href="#expr.decl"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="declaration-statement">declaration statement</dfn> introduces a declaration into the current scope.</p>
<pre class="language-.syntax">DeclarationStatement :
  Declaration
</pre>
<pre class="language-.checking">GIVEN context c, declaration d
GIVEN declaration d checks in context c
THEN statement d checks in context c
</pre>
   <p>Only the following types of declarations may be used in a declaration statement:</p>
   <ul>
    <li data-md>
     <p>VariableDeclaration}</p>
   </ul>
   <h3 class="heading settled" data-level="11.3" id="stmt.block"><span class="secno">11.3. </span><span class="content">Block Statement</span><a class="self-link" href="#stmt.block"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="block-statement">block statement</dfn> executes each of its constituent statements in order.</p>
<pre class="language-.syntax">BlockStatement :
  `{` Statement* `}`
</pre>
<pre class="language-.checking">
GIVEN context c
GIVEN statements s0,s1,...
GIVEN context d, a fresh sub-context of c
GIVEN s0,s1,... check in d
THEN `{` s0,s1,... `}` checks in c
</pre>
   <p class="note" role="note"><span class="marker">Note:</span> Declarations in a block statement are visible to later statements in the same block, but not to earlier statements in the block, or to code outside the block.</p>
   <h3 class="heading settled" data-level="11.4" id="stmt.empty"><span class="secno">11.4. </span><span class="content">Empty Statement</span><a class="self-link" href="#stmt.empty"></a></h3>
   <p>Executing an empty statement has no effect.</p>
<pre class="language-.syntax">EmptyStatement :
  `;`
</pre>
<pre class="language-.checking">GIVEN context c
THEN `;` checks in c
</pre>
   <h3 class="heading settled" data-level="11.5" id="stmt.cond"><span class="secno">11.5. </span><span class="content">Conditional Statements</span><a class="self-link" href="#stmt.cond"></a></h3>
   <h4 class="heading settled" data-level="11.5.1" id="stmt.if"><span class="secno">11.5.1. </span><span class="content">If Statement</span><a class="self-link" href="#stmt.if"></a></h4>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="if-statement"><code>if</code> statement</dfn> executes a sub-statement conditionally.</p>
<pre class="language-.syntax">IfStatement :
  `if` `(` IfCondition `)`
  Statement
  ElseClause?

IfCondition :
  Expression
  | LetDeclaration

ElseClause :
  `else` Statement
	
</pre>
<pre class="language-.checking">
GIVEN context c, expression e, statement t
GIVEN e checks against `Bool` in c
GIVEN t checks in C
THEN `if(` e `)` t checks in c

GIVEN context c, expression e, statement t
GIVEN e checks against `Bool` in c
GIVEN t checks in C
GIVEN f checks in C
THEN `if(` e `)` t `else` f checks in c  
</pre>
   <p>If the condition of an <code>if</code> statement is an expression, then it is evaluated against an expected type of <code>Bool</code> to yield a value <var>C</var>.
If <var>C</var> is <code>true</code>, then the ThenClause is executed.
If <var>C</var> is <code>false</code> and there is a ElseClause, then it is executed.</p>
   <p>If the condition of an <code>if</code> statement is a <code>let</code> declaration, then that declaration must have an initial-value expression.
That initial-value expression is evaluated against an expected type of <code>Optional&lt;T></code>, where <var>T</var> is a fresh type variable, to yield a value <var>D</var>.
If <var>D</var> is <code>Some(|C|)</code>, then the ThenClause is executed, in an environment where the name of the <code>let</code> declaration is bound to <var>C</var>.
If <var>D</var> is <code>null</code> and there is a ElseClause, then it is executed.</p>
   <h4 class="heading settled" data-level="11.5.2" id="stmt.switch"><span class="secno">11.5.2. </span><span class="content">Switch Statement</span><a class="self-link" href="#stmt.switch"></a></h4>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="switch-statement"><code>switch</code> statement</dfn> conditionally executes up to one of its <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="alternatives">alternatives</dfn>, based on the value of an expression.</p>
<pre class="language-.syntax">SwitchStatement :
  `switch` `(` Expression `)`
  `{` SwitchAlternative+ `}`

SwitchAlternative :
  SwitchAlternativeLabel+ Statement+

SwitchAlternativeLabel :
  CaseClause
  | DefaultClause

CaseClause :
  `case` Expression `:`

DefaultClause
  `default` `:`
</pre>
<pre class="language-.checking">GIVEN context c, expression e, switch alternatives a0,a1,...
GIVEN e synthesizes type t in c
GIVEN a0,a1,... check against t in c
THEN `switch(` e `) {` a0,a1,... `}` checks in c
</pre>
   <p class="note" role="note"><span class="marker">Note:</span> A <code>switch</code> statement is checked by first checking the expression, and then checking each of the alternatives against the type of that expression.</p>
<pre class="language-.checking">GIVEN context c, type t,
GIVEN switch alternative labels l0,l1,...
GIVEN statements s0,s1,...
GIVEN l0,l1,... check against t in c
GIVEN s0,s1,... check in c
THEN switch alternative l0,l1,... s0,s1,... checks in c

GIVEN context c, type t, expression e
GIVEN e checks against t in c
THEN `case` e `:` checks against t in c

GIVEN context c, type t
THEN `default:` checks against t in c
</pre>
   <p class="note" role="note"><span class="marker">Note:</span> A <code>case</code> clause is valid if its expression checks against the type of the control expressio nof the <code>switch</code> statement.</p>
   <p>A <code>switch</code> statement may have at most one <code>default</code> clause.</p>
   <p>If the type of the controlling expression of a <code>switch</code> statement is a built-in integer type, then:</p>
   <ul>
    <li data-md>
     <p>The expression of each <code>case</code> clause must be a compile-time constant expression.</p>
    <li data-md>
     <p>The constant value of the expression for each <code>case</code> clause must not be equal to that of any other <code>case</code> clause in the same <code>switch</code>.</p>
   </ul>
   <p>Each alternative of a <code>switch</code> statement must exit the <code>switch</code> statement via a <code>break</code> or other control transfer statement.
"Fall-through" from one switch case clause to another is not allowed.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Semantically, a <code>switch</code> statement is equivalent to an "<code>if</code> cascade" that compares the value of the conditional expression against each <code>case</code> clause,</p>
   <h3 class="heading settled" data-level="11.6" id="stmt.loop"><span class="secno">11.6. </span><span class="content">Loop Statements</span><a class="self-link" href="#stmt.loop"></a></h3>
   <h4 class="heading settled" data-level="11.6.1" id="stmt.for"><span class="secno">11.6.1. </span><span class="content">For Statement</span><a class="self-link" href="#stmt.for"></a></h4>
<pre class="language-.syntax">ForStatement :
  `for` `(`
  initial:Statement? `;`
  conditional:Expression? `;`
  sideEffect:Expression? `)`
  body:Statement
</pre>
<pre class="language-.checking">GIVEN init checks in c
GIVEN cond checks against `Bool` in c
GIVEN iter synthesizes type t in c
GIVEN body checks in c
THEN `for(init;cond;iter) body` checks in c
</pre>
   <p class="issue" id="issue-96675fd4"><a class="self-link" href="#issue-96675fd4"></a> The checking judgements above aren’t complete because they don’t handle the case where <var>cond</var> is absent, in which case it should be treated like it was <code>true</code>.</p>
   <h4 class="heading settled" data-level="11.6.2" id="stmt.while"><span class="secno">11.6.2. </span><span class="content">While Statement</span><a class="self-link" href="#stmt.while"></a></h4>
<pre class="language-.syntax">WhileStatement :
  `while` `(`
  conditional:Expression? `)`
  body:Statement
</pre>
<pre class="language-.checking">GIVEN cond checks against `Bool` in c
GIVEN body checks in c
THEN `while(cond) body` checks in c
</pre>
   <h4 class="heading settled" data-level="11.6.3" id="stmt.do-while"><span class="secno">11.6.3. </span><span class="content">Do-While Statement</span><a class="self-link" href="#stmt.do-while"></a></h4>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="do-while-statement">do-while statement</dfn> uses the following form:</p>
<pre class="language-.syntax">DoWhileStatement :
  `do` body:Statement
  `while` `(` conditional:Expression? `)` `;`    
</pre>
<pre class="language-.checking">GIVEN body checks in c
GIVEN cond checks againt `Bool` in c
THEN `do body while(cond);` checks in c
</pre>
   <p class="issue" id="issue-ee34b50f"><a class="self-link" href="#issue-ee34b50f"></a> These simplified prose checking rules are leaving out all the subtlties of sub-contexts, etc.</p>
   <h3 class="heading settled" data-level="11.7" id="stmt.control"><span class="secno">11.7. </span><span class="content">Control Transfer Statements</span><a class="self-link" href="#stmt.control"></a></h3>
   <h4 class="heading settled" data-level="11.7.1" id="stmt.break"><span class="secno">11.7.1. </span><span class="content"><code>break</code> Statement</span><a class="self-link" href="#stmt.break"></a></h4>
<pre class="language-.syntax">BreakStatement :
  `break` label:Identifier? `;`
</pre>
   <p>A [<a data-link-type="dfn">break statement</a>] without a [<a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#label" id="ref-for-label">label</a>] transfers control to after the end of the closest lexically enclosing [<a data-link-type="dfn" href="#switch-statement" id="ref-for-switch-statement">switch statement</a>] or [<a data-link-type="dfn">loop statement</a>].</p>
   <p>A [<a data-link-type="dfn">break statement</a>] with a [<a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#label" id="ref-for-label①">label</a>] transfers control to after the end of the lexically enclosing [<a data-link-type="dfn" href="#switch-statement" id="ref-for-switch-statement①">switch statement</a>] or [<a data-link-type="dfn">loop statement</a>] labeled with a matching [<a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#label" id="ref-for-label②">label</a>].</p>
<pre class="language-.checking">GIVEN context c
GIVEN lookup of BREAK_LABEL in c yields label l
THEN `break;` checks in context c

GIVEN context c, label l
GIVEN c contains an entry of the form BREAK_LABEL = l
THEN `break l;` checks in context c
</pre>
   <div class="issue" id="issue-ad42b03a">
    <a class="self-link" href="#issue-ad42b03a"></a> Issue: The checking rules for <code>break</code>-able statements should add a suitable item to the context used for checking their body statements, which will be matched by the rules above. 
    <p>We also need to define the context-containment rule that is being used to look up the <code>break</code> item in the context.</p>
   </div>
   <h4 class="heading settled" data-level="11.7.2" id="stmt.continue"><span class="secno">11.7.2. </span><span class="content">Continue Statement</span><a class="self-link" href="#stmt.continue"></a></h4>
<pre class="language-.syntax">ContinueStatement :
  `continue` label:Identifier? `;`
</pre>
   <p>A <code>continue</code> statement transfers control to the start of the next iteration of a loop statement.
In a <code>for</code> statement with a side effect expression, the side effect expression is evaluated when <code>continue</code> is used:</p>
<pre class="language-.checking">GIVEN context c
GIVEN lookup of CONTINUE_LABEL in c yields label l
THEN `continue;` checks in context c

GIVEN context c, label l
GIVEN c contains an entry of the form CONTINUE_LABEL = l
THEN `continue l;` checks in context c
</pre>
   <h4 class="heading settled" data-level="11.7.3" id="stmt.continue①"><span class="secno">11.7.3. </span><span class="content">Return Statement</span><a class="self-link" href="#stmt.continue①"></a></h4>
   <p>A <code>return</code> statement transfers control out of the current function.</p>
<pre class="language-.syntax">ReturnStatement :
  `return` Expression? `;`
</pre>
<pre class="language-.checking">GIVEN context c, expression e
GIVEN lookup of RESULT_TYPE in c yields type t
GIVEN e checks against t in c
THEN `return e;` checks in c
</pre>
<pre class="language-.checking">GIVEN context c
GIVEN lookup of RESULT_TYPE in c yield type t
GIVEN `Unit` is a subtype of t
THEN `return;` checks in c
</pre>
   <p class="note" role="note"><span class="marker">Note:</span> A <code>return</code> statement without an expression is equivalent to a <code>return</code> of a value of type <code>Unit</code>.</p>
   <h4 class="heading settled" data-level="11.7.4" id="stmt.discard"><span class="secno">11.7.4. </span><span class="content">Discard Statement</span><a class="self-link" href="#stmt.discard"></a></h4>
<pre class="language-.syntax">DiscardStatement :
  `discard` `;`
</pre>
   <p>A <code>discard</code> statement may only be used in the context of a fragment shader, in which case it causes the current invocation to terminate and the graphics system to discard the corresponding fragment so that it does not get combined with the framebuffer pixel at its coordinates.</p>
   <p>Operations with side effects that were executed by the invocation before a <code>discard</code> will still be performed and their results will become visible according to the rules of the platform.</p>
<pre class="language-.checking">GIVEN context c
GIVEN capability `fragment` is available in c
THEN `discard;` checks in c
</pre>
   <p class="issue" id="issue-d9240fe8"><a class="self-link" href="#issue-d9240fe8"></a> The intent of the above rule is that checking a <code>discard</code> statement will add the <code>fragment</code> capability to the context, so that it can be checked against the capabilities of the surrounding function/context.
However, the way the other statement rules handle the context, they do not allow for anything in the context to flow upward/outward in that fashion.
It may be simplest to have the process of collecting the capabilities required by a function body be a different judgement than the type checking rules.</p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="conformance"><span class="content"> Conformance</span><a class="self-link" href="#conformance"></a></h2>
   <p> Conformance requirements are expressed with a combination of descriptive assertions and RFC 2119 terminology.
            The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
            in the normative parts of this document
            are to be interpreted as described in RFC 2119.
            However, for readability,
            these words do not appear in all uppercase letters in this specification. </p>
   <p> All of the text of this specification is normative
            except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p> Examples in this specification are introduced with the words “for example”
            or are set apart from the normative text with <code>class="example"</code>, like this: </p>
   <div class="example" id="example-example"><a class="self-link" href="#example-example"></a> This is an example of an informative example. </div>
   <p> Informative notes begin with the word “Note”
            and are set apart from the normative text with <code>class="note"</code>, like this: </p>
   <p class="note" role="note"> Note, this is an informative note.</p>
  </div>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don't scroll to compensate for the ToC if we're above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don't know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn't exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn't standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don't have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we're at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can't find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#accesses">accesses</a><span>, in § 6</span>
   <li><a href="#activation">activation</a><span>, in § 6</span>
   <li><a href="#aggregate-type-declaration">aggregate type declaration</a><span>, in § 8.3.1</span>
   <li><a href="#alternatives">alternatives</a><span>, in § 11.5.2</span>
   <li><a href="#associated-type-declaration">associated type declaration</a><span>, in § 8.3.5</span>
   <li><a href="#balanced">balanced</a><span>, in § 5.2.2</span>
   <li><a href="#bases">bases</a><span>, in § 8.3.2</span>
   <li><a href="#binary-literal">binary literal</a><span>, in § 2.4.2.2.1</span>
   <li><a href="#binding">binding</a><span>, in § 8</span>
   <li><a href="#bindings">bindings</a><span>, in § 4.1</span>
   <li><a href="#binds">binds</a><span>, in § 4.1</span>
   <li><a href="#block-comment">block comment</a><span>, in § 2.4.1.2</span>
   <li><a href="#block-statement">block statement</a><span>, in § 11.3</span>
   <li><a href="#body">body</a><span>, in § 8.5.3</span>
   <li><a href="#case-declarations">case declarations</a><span>, in § 8.3.3.1</span>
   <li><a href="#character">character</a><span>, in § 2.1</span>
   <li><a href="#character-literal">character literal</a><span>, in § 2.4.3.2</span>
   <li><a href="#checking-judgement">checking judgement</a><span>, in § 4.2.2</span>
   <li><a href="#checks">checks</a><span>, in § 4.3</span>
   <li><a href="#checks-against">checks against</a><span>, in § 4.2.2</span>
   <li><a href="#class-declaration">class declaration</a><span>, in § 8.3.1</span>
   <li><a href="#comment①">comment</a><span>, in § 2.4.1.2</span>
   <li><a href="#constrained">constrained</a><span>, in § 8.10.1</span>
   <li><a href="#constructor-declaration">constructor declaration</a><span>, in § 8.6</span>
   <li><a href="#context">context</a><span>, in § 4.1</span>
   <li><a href="#context-entries">context entries</a><span>, in § 4.1</span>
   <li><a href="#convergent">convergent</a><span>, in § 6</span>
   <li><a href="#decimal-literal">decimal literal</a><span>, in § 2.4.2.2.1</span>
   <li><a href="#declaration">declaration</a><span>, in § 8</span>
   <li><a href="#declaration-statement">declaration statement</a><span>, in § 11.2</span>
   <li><a href="#devices">devices</a><span>, in § 6</span>
   <li><a href="#digits">digits</a><span>, in § 2.4.2.2.1</span>
   <li><a href="#direction">direction</a><span>, in § 8.5.1.1</span>
   <li><a href="#direct-members">direct members</a><span>, in § 8.3.1</span>
   <li><a href="#do-while-statement">do-while statement</a><span>, in § 11.6.3</span>
   <li><a href="#empty-environment">empty environment</a><span>, in § 8</span>
   <li><a href="#entry-point-declaration">entry point declaration</a><span>, in § 8.5.5</span>
   <li><a href="#enum-declaration">enum declaration</a><span>, in § 8.3.3</span>
   <li><a href="#environment">environment</a><span>, in § 8</span>
   <li><a href="#escaped-line-break">escaped line break</a><span>, in § 2.4.1.1.1</span>
   <li><a href="#exponent">exponent</a><span>, in § 2.4.2.4</span>
   <li><a href="#expression-statement">expression statement</a><span>, in § 11.1</span>
   <li><a href="#fields">fields</a><span>, in § 8.3.1.2</span>
   <li><a href="#floating-point-literal">floating-point literal</a><span>, in § 2.4.2.4</span>
   <li><a href="#function-declaration">function declaration</a><span>, in § 8.5</span>
   <li><a href="#function-definition">function definition</a><span>, in § 8.5.3</span>
   <li><a href="#function-scope">function scope</a><span>, in § 8.4.3</span>
   <li><a href="#function-scope-constant">function-scope constant</a><span>, in § 8.4.3.1</span>
   <li><a href="#function-scope-static-variable">function-scope static variable</a><span>, in § 8.4.3.2</span>
   <li><a href="#generic">generic</a><span>, in § 8.10</span>
   <li><a href="#generic-arguments">generic arguments</a><span>, in § 8.10.2</span>
   <li><a href="#generic-parameter-list">generic parameter list</a><span>, in § 8.10</span>
   <li><a href="#generic-type-parameter">generic type parameter</a><span>, in § 8.10.1</span>
   <li><a href="#global-constant">global constant</a><span>, in § 8.4.2.1</span>
   <li><a href="#global-shader-parameter">global shader parameter</a><span>, in § 8.4.2.3</span>
   <li><a href="#hexadecimal-literal">hexadecimal literal</a><span>, in § 2.4.2.2.1</span>
   <li><a href="#horizontal-whitespace">Horizontal whitespace</a><span>, in § 2.4.1.1</span>
   <li><a href="#if-statement">if statement</a><span>, in § 11.5.1</span>
   <li><a href="#implementing-declaration">implementing declaration</a><span>, in § 7.2.2</span>
   <li><a href="#implicit-specialization">implicit specialization</a><span>, in § 8.10.3</span>
   <li><a href="#include-declarations">include declarations</a><span>, in § 7.2.1</span>
   <li><a href="#initial-context">initial context</a><span>, in § 5.1</span>
   <li><a href="#input-environment">input environment</a><span>, in § 8</span>
   <li><a href="#instance-members">instance members</a><span>, in § 8.3.1.1</span>
   <li><a href="#integer-literal">integer literal</a><span>, in § 2.4.2.3</span>
   <li><a href="#interface-declaration">interface declaration</a><span>, in § 8.3.1</span>
   <li><a href="#introduces">introduces</a><span>, in § 8</span>
   <li><a href="#kernels">kernels</a><span>, in § 6</span>
   <li><a href="#lexeme">lexeme</a><span>, in § 2.4</span>
   <li><a href="#lexing">Lexing</a><span>, in § 2.4</span>
   <li><a href="#line-break">line break</a><span>, in § 2.4.1.1.1</span>
   <li><a href="#line-comment">line comment</a><span>, in § 2.4.1.2</span>
   <li><a href="#lines">lines</a><span>, in § 2.4.1.1.1</span>
   <li><a href="#local-scope">local scope</a><span>, in § 8</span>
   <li><a href="#local-variable">local variable</a><span>, in § 8.4.3.3</span>
   <li><a href="#locations">locations</a><span>, in § 6</span>
   <li><a href="#memory-spaces">memory spaces</a><span>, in § 6</span>
   <li><a href="#methods">methods</a><span>, in § 8.3.1.3</span>
   <li><a href="#modern-enum-declaration">modern enum declaration</a><span>, in § 8.3.3</span>
   <li><a href="#module①">module</a><span>, in § 7</span>
   <li><a href="#module-declaration">module declaration</a><span>, in § 7.1</span>
   <li><a href="#numeric-literal">numeric literal</a><span>, in § 2.4.2.2.1</span>
   <li><a href="#numeric-literal-suffix">numeric literal suffix</a><span>, in § 2.4.2.2.1</span>
   <li><a href="#objects">objects</a><span>, in § 6</span>
   <li><a href="#ordered">ordered</a><span>, in § 5.2.1</span>
   <li><a href="#output-environment">output environment</a><span>, in § 8</span>
   <li><a href="#parameter-declarations">parameter declarations</a><span>, in § 8.5.1</span>
   <li><a href="#parent-environment">parent environment</a><span>, in § 8</span>
   <li><a href="#parsing">Parsing</a><span>, in § 5</span>
   <li><a href="#pipelines">pipelines</a><span>, in § 6</span>
   <li><a href="#primary-source-unit">primary source unit</a><span>, in § 7.1</span>
   <li><a href="#property-declaration">property declaration</a><span>, in § 8.7</span>
   <li><a href="#radix-specifier">radix specifier</a><span>, in § 2.4.2.2.1</span>
   <li><a href="#result-type">result type</a><span>, in § 8.5.2</span>
   <li><a href="#retroactive-conformance">retroactive conformance</a><span>, in § 8.9</span>
   <li><a href="#scope">scope</a><span>, in § 8</span>
   <li><a href="#secondary-source-units">secondary source units</a><span>, in § 7.2</span>
   <li><a href="#sign">sign</a><span>, in § 2.4.2.4</span>
   <li><a href="#source-unit">source unit</a><span>, in § 2.1</span>
   <li><a href="#specialized">specialized</a><span>, in § 8.10.2</span>
   <li><a href="#stages">stages</a><span>, in § 6</span>
   <li><a href="#standard-library">standard library</a><span>, in § 1.3</span>
   <li><a href="#statement">statement</a><span>, in § 11</span>
   <li><a href="#static-global-variable">static global variable</a><span>, in § 8.4.2.2</span>
   <li><a href="#static-members">static members</a><span>, in § 8.3.1.1</span>
   <li><a href="#string-literal">string literal</a><span>, in § 2.4.3.1</span>
   <li><a href="#struct-declaration">struct declaration</a><span>, in § 8.3.1</span>
   <li><a href="#subscript-declaration">subscript declaration</a><span>, in § 8.8</span>
   <li><a href="#switch-statement">switch statement</a><span>, in § 11.5.2</span>
   <li><a href="#synthesis-judgement">synthesis judgement</a><span>, in § 4.2.1</span>
   <li><a href="#synthesizes">synthesizes</a><span>, in § 4.2.1</span>
   <li><a href="#tokens">Tokens</a><span>, in § 2.4.2</span>
   <li><a href="#traditional-buffer-declaration">traditional buffer declaration</a><span>, in § 8.11</span>
   <li><a href="#traditional-case-declarations">traditional case declarations</a><span>, in § 8.3.3.1</span>
   <li><a href="#traditional-enum-declaration">traditional enum declaration</a><span>, in § 8.3.3</span>
   <li><a href="#traditional-function-declaration">traditional function declaration</a><span>, in § 8.5.4</span>
   <li><a href="#traditional-type-alias-declaration">traditional type alias declaration</a><span>, in § 8.3.4.1</span>
   <li><a href="#trivia①">Trivia</a><span>, in § 2.4.1</span>
   <li><a href="#type-alias-declaration">type alias declaration</a><span>, in § 8.3.4</span>
   <li><a href="#type-declaration">type declaration</a><span>, in § 8.3</span>
   <li><a href="#underlying-type">underlying type</a><span>, in § 8.3.3</span>
   <li><a href="#underlying-value">underlying value</a><span>, in § 8.3.3.1</span>
   <li><a href="#uniform">uniform</a><span>, in § 6</span>
   <li><a href="#unordered">unordered</a><span>, in § 5.2.2</span>
   <li><a href="#variable">variable</a><span>, in § 8.4</span>
   <li><a href="#variable-declaration">variable declaration</a><span>, in § 8.4</span>
   <li><a href="#varying">varying</a><span>, in § 6</span>
   <li><a href="#whitespace①">Whitespace</a><span>, in § 2.4.1.1</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[CSS-VALUES-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="9dc6ce48">identifier</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="2aedacbb">type</span>
    </ul>
   <li>
    <a data-link-type="biblio">[ENCODING]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="db96183f">label</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-css-values-4">[CSS-VALUES-4]
   <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://drafts.csswg.org/css-values-4/"><cite>CSS Values and Units Module Level 4</cite></a>. URL: <a href="https://drafts.csswg.org/css-values-4/">https://drafts.csswg.org/css-values-4/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-encoding">[ENCODING]
   <dd>Anne van Kesteren. <a href="https://encoding.spec.whatwg.org/"><cite>Encoding Standard</cite></a>. Living Standard. URL: <a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-unicode">[Unicode]
   <dd><a href="https://www.unicode.org/versions/latest/"><cite>The Unicode Standard</cite></a>. URL: <a href="https://www.unicode.org/versions/latest/">https://www.unicode.org/versions/latest/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> Need to turn that into a link. <a class="issue-return" href="#issue-cebba3e7" title="Jump to section">↵</a></div>
   <div class="issue"> Need to document supported escape sequences. <a class="issue-return" href="#issue-9b572b04" title="Jump to section">↵</a></div>
   <div class="issue"> We either need to pick a normative reference here for some existing preprocessor (and thus bind ourselves to eventually supporting the semantics of that normative reference), or we need to take the time to fully document what the semantics of our current preprocessor are. <a class="issue-return" href="#issue-c15d86ec" title="Jump to section">↵</a></div>
   <div class="issue"> At the very least we need to document support for the GLSL <code>#version</code> directive, if we intend to keep it. <a class="issue-return" href="#issue-29446511" title="Jump to section">↵</a></div>
   <div class="issue">
     The intention of this chapter is to establish the formalisms and notations that will be used for expressing typing judgements and other semantic-checking rules in this specification. 
    <p>The notation being used here is aligned with how papers in the PLT world on type theory, semantics, etc. present a language.</p>
     <a class="issue-return" href="#issue-60092464" title="Jump to section">↵</a>
   </div>
   <div class="issue"> We need to describe here the process by which an identifier resolves to a binding, including overloaded, etc.
The discussion here will have to be a forward reference to the algorithms to be given later. <a class="issue-return" href="#issue-0b447306" title="Jump to section">↵</a></div>
   <div class="issue"> as written here, a synthesis judgement might actually have <em>side effects</em> on the context.
That needs to be specified somehow. <a class="issue-return" href="#issue-0774e2d2" title="Jump to section">↵</a></div>
   <div class="issue">
     The intention of this chapter is to establish the overall rules for the recursive-descent parsing strategy needed for Slang’s grammar. 
    <p>Slang attempts to thread the needle by supporting the familiar C-like syntax of existing shading languages, while also support out-of-order declarations.
The parsing strategy is necessarily complicated as a result, but we hope to isolate most of the details to this chapter so that the grammar for each construct can be presented in its simplest possible fashion.</p>
     <a class="issue-return" href="#issue-29cd4b9f" title="Jump to section">↵</a>
   </div>
   <div class="issue">
     Even if we don’t define a completely formal runtime semantics, we need sufficient terminology to be able to explain the intended semantics of language constructs, including things like <code>discard</code>, shared memory, wave-level ops, etc. 
    <p>Key concepts that this chapter will need to discuss:</p>
    <ul>
     <li data-md>
      <p>A concept of systems that might be comprised of multiple <span>devices</span>, and which might have multiple distinct <span>memory spaces</span> that may or may not be shared.</p>
     <li data-md>
      <p>The notion of a thread or invocation that runs Slang code in a largely scalar/sequential fashion.</p>
     <li data-md>
      <p>Any notions of groupings of threads (quads, subgroups/waves/warps, thread blocks/workgroups, dispatches/grids/draws, etc.) that might have semantic consequences</p>
     <li data-md>
      <p>A definition of what it means for execution to be <span>convergent</span> for a grouping of threads, and what it means for data to be <span>uniform</span> across such groups.</p>
     <li data-md>
      <p>A definition of what memory <span>objects</span> and/or <span>locations</span> are, and the kinds of <span>accesses</span> that may be performed to them (reads, writes, atomics, etc.).</p>
     <li data-md>
      <p>Definitions of what an <span>activation</span> of a function is, and how those activations comprise the call stack of a thread.</p>
     <li data-md>
      <p>A definition of core GPU rendering concepts such as <span>pipelines</span>, <span>stages</span>, <span>kernels</span>, <span>varying</span> input/output, <a data-link-type="dfn" href="#uniform">uniform</a> shader parameters, etc.</p>
    </ul>
     <a class="issue-return" href="#issue-fa20f1ae" title="Jump to section">↵</a>
   </div>
   <div class="issue"> Need a section to define what a "compile-time constant expression" is. <a class="issue-return" href="#issue-d245d890" title="Jump to section">↵</a></div>
   <div class="issue"> This chapter needs to list the built-in attributes that impact the language semantics, and also to specify the rules for how user-define attributes are defined and used. <a class="issue-return" href="#issue-825e7e43" title="Jump to section">↵</a></div>
   <div class="issue">
     This chapter needs to explain the rules for: 
    <ul>
     <li data-md>
      <p>What declarations in a module are visible to modules that <code>import</code> it?</p>
     <li data-md>
      <p>What are the modifiers that can be used to control visibility (<code>public</code>, <code>internal</code>, <code>private</code>), and what are their semantics.</p>
     <li data-md>
      <p>What is the inferred visibility of a declaration without an explicit modifier?</p>
     <li data-md>
      <p>What are the rules about what modifiers are legal in what contexts?</p>
     <li data-md>
      <p>E.g., a <code>public</code> field should not be allowed in an <code>internal</code> type.</p>
     <li data-md>
      <p>E.g., a <code>public</code> function should not be allowed to have a non-<code>public</code> type used in its signature.</p>
     <li data-md>
      <p>How is visibility controlled for interface conformances?</p>
    </ul>
     <a class="issue-return" href="#issue-7828c441" title="Jump to section">↵</a>
   </div>
   <div class="issue"> The checking judgements above aren’t complete because they don’t handle the case where <var>cond</var> is absent, in which case it should be treated like it was <code>true</code>. <a class="issue-return" href="#issue-96675fd4" title="Jump to section">↵</a></div>
   <div class="issue"> These simplified prose checking rules are leaving out all the subtlties of sub-contexts, etc. <a class="issue-return" href="#issue-ee34b50f" title="Jump to section">↵</a></div>
   <div class="issue">
     Issue: The checking rules for <code>break</code>-able statements should add a suitable item to the context used for checking their body statements, which will be matched by the rules above. 
    <p>We also need to define the context-containment rule that is being used to look up the <code>break</code> item in the context.</p>
     <a class="issue-return" href="#issue-ad42b03a" title="Jump to section">↵</a>
   </div>
   <div class="issue"> The intent of the above rule is that checking a <code>discard</code> statement will add the <code>fragment</code> capability to the context, so that it can be checked against the capabilities of the surrounding function/context.
However, the way the other statement rules handle the context, they do not allow for anything in the context to flow upward/outward in that fashion.
It may be simplest to have the process of collecting the capabilities required by a function body be a different judgement than the type checking rules. <a class="issue-return" href="#issue-d9240fe8" title="Jump to section">↵</a></div>
  </div>
<script>/* Boilerplate: script-dom-helper */
"use strict";
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
let dfnPanelData = {
"2aedacbb": {"dfnID":"2aedacbb","dfnText":"type","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-document-type"}],"title":"4.2.1. Synthesis"},{"refs":[{"id":"ref-for-concept-document-type\u2460"}],"title":"4.2.2. Checking"},{"refs":[{"id":"ref-for-concept-document-type\u2461"}],"title":"5.2.1. Ordered"}],"url":"https://dom.spec.whatwg.org/#concept-document-type"},
"9dc6ce48": {"dfnID":"9dc6ce48","dfnText":"identifier","external":true,"refSections":[{"refs":[{"id":"ref-for-css-css-identifier"}],"title":"4.1. Contexts"},{"refs":[{"id":"ref-for-css-css-identifier\u2460"}],"title":"5.3.1.2. Unordered Mode"}],"url":"https://drafts.csswg.org/css-values-4/#css-css-identifier"},
"accesses": {"dfnID":"accesses","dfnText":"accesses","external":false,"refSections":[],"url":"#accesses"},
"activation": {"dfnID":"activation","dfnText":"activation","external":false,"refSections":[],"url":"#activation"},
"aggregate-type-declaration": {"dfnID":"aggregate-type-declaration","dfnText":"aggregate type declaration","external":false,"refSections":[],"url":"#aggregate-type-declaration"},
"alternatives": {"dfnID":"alternatives","dfnText":"alternatives","external":false,"refSections":[],"url":"#alternatives"},
"associated-type-declaration": {"dfnID":"associated-type-declaration","dfnText":"associated type declaration","external":false,"refSections":[],"url":"#associated-type-declaration"},
"balanced": {"dfnID":"balanced","dfnText":"balanced","external":false,"refSections":[],"url":"#balanced"},
"bases": {"dfnID":"bases","dfnText":"bases","external":false,"refSections":[],"url":"#bases"},
"binary-literal": {"dfnID":"binary-literal","dfnText":"binary literal","external":false,"refSections":[],"url":"#binary-literal"},
"binding": {"dfnID":"binding","dfnText":"binding","external":false,"refSections":[],"url":"#binding"},
"bindings": {"dfnID":"bindings","dfnText":"bindings","external":false,"refSections":[{"refs":[{"id":"ref-for-bindings"}],"title":"4.1. Contexts"}],"url":"#bindings"},
"binds": {"dfnID":"binds","dfnText":"binds","external":false,"refSections":[],"url":"#binds"},
"block-comment": {"dfnID":"block-comment","dfnText":"block comment","external":false,"refSections":[{"refs":[{"id":"ref-for-block-comment"},{"id":"ref-for-block-comment\u2460"},{"id":"ref-for-block-comment\u2461"},{"id":"ref-for-block-comment\u2462"},{"id":"ref-for-block-comment\u2463"}],"title":"2.4.1.2. Comments"}],"url":"#block-comment"},
"block-statement": {"dfnID":"block-statement","dfnText":"block statement","external":false,"refSections":[],"url":"#block-statement"},
"body": {"dfnID":"body","dfnText":"body","external":false,"refSections":[],"url":"#body"},
"case-declarations": {"dfnID":"case-declarations","dfnText":"case declarations","external":false,"refSections":[],"url":"#case-declarations"},
"character": {"dfnID":"character","dfnText":"character","external":false,"refSections":[{"refs":[{"id":"ref-for-character"}],"title":"2.1. Source Units"},{"refs":[{"id":"ref-for-character\u2460"}],"title":"2.3. Phases"},{"refs":[{"id":"ref-for-character\u2461"}],"title":"2.4.1.1.1. Line Breaks"},{"refs":[{"id":"ref-for-character\u2462"}],"title":"2.4.1.2. Comments"}],"url":"#character"},
"character-literal": {"dfnID":"character-literal","dfnText":"character literal","external":false,"refSections":[],"url":"#character-literal"},
"checking-judgement": {"dfnID":"checking-judgement","dfnText":"checking judgement","external":false,"refSections":[{"refs":[{"id":"ref-for-checking-judgement"}],"title":"4.3. Statements"},{"refs":[{"id":"ref-for-checking-judgement\u2460"}],"title":"4.4. Declarations"}],"url":"#checking-judgement"},
"checks": {"dfnID":"checks","dfnText":"checks","external":false,"refSections":[{"refs":[{"id":"ref-for-checks"}],"title":"4.4. Declarations"}],"url":"#checks"},
"checks-against": {"dfnID":"checks-against","dfnText":"checks against","external":false,"refSections":[],"url":"#checks-against"},
"class-declaration": {"dfnID":"class-declaration","dfnText":"class declaration","external":false,"refSections":[],"url":"#class-declaration"},
"comment①": {"dfnID":"comment\u2460","dfnText":"comment","external":false,"refSections":[],"url":"#comment\u2460"},
"constrained": {"dfnID":"constrained","dfnText":"constrained","external":false,"refSections":[],"url":"#constrained"},
"constructor-declaration": {"dfnID":"constructor-declaration","dfnText":"constructor declaration","external":false,"refSections":[],"url":"#constructor-declaration"},
"context": {"dfnID":"context","dfnText":"context","external":false,"refSections":[{"refs":[{"id":"ref-for-context"}],"title":"4.2.1. Synthesis"},{"refs":[{"id":"ref-for-context\u2460"}],"title":"4.2.2. Checking"},{"refs":[{"id":"ref-for-context\u2461"}],"title":"4.3. Statements"},{"refs":[{"id":"ref-for-context\u2462"}],"title":"4.4. Declarations"},{"refs":[{"id":"ref-for-context\u2463"}],"title":"5.1. Contexts"}],"url":"#context"},
"context-entries": {"dfnID":"context-entries","dfnText":"context entries","external":false,"refSections":[],"url":"#context-entries"},
"convergent": {"dfnID":"convergent","dfnText":"convergent","external":false,"refSections":[],"url":"#convergent"},
"db96183f": {"dfnID":"db96183f","dfnText":"label","external":true,"refSections":[{"refs":[{"id":"ref-for-label"},{"id":"ref-for-label\u2460"},{"id":"ref-for-label\u2461"}],"title":"11.7.1. break Statement"}],"url":"https://encoding.spec.whatwg.org/#label"},
"decimal-literal": {"dfnID":"decimal-literal","dfnText":"decimal literal","external":false,"refSections":[],"url":"#decimal-literal"},
"declaration": {"dfnID":"declaration","dfnText":"declaration","external":false,"refSections":[{"refs":[{"id":"ref-for-declaration"}],"title":"4.4. Declarations"},{"refs":[{"id":"ref-for-declaration\u2460"}],"title":"5.2.1. Ordered"},{"refs":[{"id":"ref-for-declaration\u2461"}],"title":"5.2.2. Unordered"}],"url":"#declaration"},
"declaration-statement": {"dfnID":"declaration-statement","dfnText":"declaration statement","external":false,"refSections":[],"url":"#declaration-statement"},
"devices": {"dfnID":"devices","dfnText":"devices","external":false,"refSections":[],"url":"#devices"},
"digits": {"dfnID":"digits","dfnText":"digits","external":false,"refSections":[],"url":"#digits"},
"direct-members": {"dfnID":"direct-members","dfnText":"direct members","external":false,"refSections":[],"url":"#direct-members"},
"direction": {"dfnID":"direction","dfnText":"direction","external":false,"refSections":[],"url":"#direction"},
"do-while-statement": {"dfnID":"do-while-statement","dfnText":"do-while statement","external":false,"refSections":[],"url":"#do-while-statement"},
"empty-environment": {"dfnID":"empty-environment","dfnText":"empty environment","external":false,"refSections":[],"url":"#empty-environment"},
"entry-point-declaration": {"dfnID":"entry-point-declaration","dfnText":"entry point declaration","external":false,"refSections":[],"url":"#entry-point-declaration"},
"enum-declaration": {"dfnID":"enum-declaration","dfnText":"enum declaration","external":false,"refSections":[{"refs":[{"id":"ref-for-enum-declaration"},{"id":"ref-for-enum-declaration\u2460"},{"id":"ref-for-enum-declaration\u2461"},{"id":"ref-for-enum-declaration\u2462"},{"id":"ref-for-enum-declaration\u2463"},{"id":"ref-for-enum-declaration\u2464"}],"title":"8.3.3. enum Declarations"},{"refs":[{"id":"ref-for-enum-declaration\u2465"},{"id":"ref-for-enum-declaration\u2466"},{"id":"ref-for-enum-declaration\u2467"}],"title":"8.3.3.1. Cases"}],"url":"#enum-declaration"},
"environment": {"dfnID":"environment","dfnText":"environment","external":false,"refSections":[],"url":"#environment"},
"escaped-line-break": {"dfnID":"escaped-line-break","dfnText":"escaped line break","external":false,"refSections":[{"refs":[{"id":"ref-for-escaped-line-break"},{"id":"ref-for-escaped-line-break\u2460"}],"title":"2.3. Phases"}],"url":"#escaped-line-break"},
"exponent": {"dfnID":"exponent","dfnText":"exponent","external":false,"refSections":[],"url":"#exponent"},
"expression-statement": {"dfnID":"expression-statement","dfnText":"expression statement","external":false,"refSections":[],"url":"#expression-statement"},
"fields": {"dfnID":"fields","dfnText":"fields","external":false,"refSections":[],"url":"#fields"},
"floating-point-literal": {"dfnID":"floating-point-literal","dfnText":"floating-point literal","external":false,"refSections":[{"refs":[{"id":"ref-for-floating-point-literal"}],"title":"2.4.2.2.1. Numeric Literals"}],"url":"#floating-point-literal"},
"function-declaration": {"dfnID":"function-declaration","dfnText":"function declaration","external":false,"refSections":[],"url":"#function-declaration"},
"function-definition": {"dfnID":"function-definition","dfnText":"function definition","external":false,"refSections":[],"url":"#function-definition"},
"function-scope": {"dfnID":"function-scope","dfnText":"function scope","external":false,"refSections":[],"url":"#function-scope"},
"function-scope-constant": {"dfnID":"function-scope-constant","dfnText":"function-scope constant","external":false,"refSections":[],"url":"#function-scope-constant"},
"function-scope-static-variable": {"dfnID":"function-scope-static-variable","dfnText":"function-scope static variable","external":false,"refSections":[],"url":"#function-scope-static-variable"},
"generic": {"dfnID":"generic","dfnText":"generic","external":false,"refSections":[],"url":"#generic"},
"generic-arguments": {"dfnID":"generic-arguments","dfnText":"generic arguments","external":false,"refSections":[{"refs":[{"id":"ref-for-generic-arguments"}],"title":"5.3.1.2. Unordered Mode"},{"refs":[{"id":"ref-for-generic-arguments\u2460"}],"title":"5.3.2. Closing Angle Brackets"}],"url":"#generic-arguments"},
"generic-parameter-list": {"dfnID":"generic-parameter-list","dfnText":"generic parameter list","external":false,"refSections":[],"url":"#generic-parameter-list"},
"generic-type-parameter": {"dfnID":"generic-type-parameter","dfnText":"generic type parameter","external":false,"refSections":[],"url":"#generic-type-parameter"},
"global-constant": {"dfnID":"global-constant","dfnText":"global constant","external":false,"refSections":[],"url":"#global-constant"},
"global-shader-parameter": {"dfnID":"global-shader-parameter","dfnText":"global shader parameter","external":false,"refSections":[],"url":"#global-shader-parameter"},
"hexadecimal-literal": {"dfnID":"hexadecimal-literal","dfnText":"hexadecimal literal","external":false,"refSections":[],"url":"#hexadecimal-literal"},
"horizontal-whitespace": {"dfnID":"horizontal-whitespace","dfnText":"Horizontal whitespace","external":false,"refSections":[{"refs":[{"id":"ref-for-horizontal-whitespace"}],"title":"2.4.1.1. Whitespace"}],"url":"#horizontal-whitespace"},
"if-statement": {"dfnID":"if-statement","dfnText":"if statement","external":false,"refSections":[],"url":"#if-statement"},
"implementing-declaration": {"dfnID":"implementing-declaration","dfnText":"implementing declaration","external":false,"refSections":[{"refs":[{"id":"ref-for-implementing-declaration"},{"id":"ref-for-implementing-declaration\u2460"},{"id":"ref-for-implementing-declaration\u2461"},{"id":"ref-for-implementing-declaration\u2462"}],"title":"7.2.2. Implementing Declarations"}],"url":"#implementing-declaration"},
"implicit-specialization": {"dfnID":"implicit-specialization","dfnText":"implicit specialization","external":false,"refSections":[],"url":"#implicit-specialization"},
"include-declarations": {"dfnID":"include-declarations","dfnText":"include declarations","external":false,"refSections":[{"refs":[{"id":"ref-for-include-declarations"},{"id":"ref-for-include-declarations\u2460"},{"id":"ref-for-include-declarations\u2461"}],"title":"7.2.1. Include Declarations"}],"url":"#include-declarations"},
"initial-context": {"dfnID":"initial-context","dfnText":"initial context","external":false,"refSections":[],"url":"#initial-context"},
"input-environment": {"dfnID":"input-environment","dfnText":"input environment","external":false,"refSections":[],"url":"#input-environment"},
"instance-members": {"dfnID":"instance-members","dfnText":"instance members","external":false,"refSections":[],"url":"#instance-members"},
"integer-literal": {"dfnID":"integer-literal","dfnText":"integer literal","external":false,"refSections":[{"refs":[{"id":"ref-for-integer-literal"}],"title":"2.4.2.2.1. Numeric Literals"}],"url":"#integer-literal"},
"interface-declaration": {"dfnID":"interface-declaration","dfnText":"interface declaration","external":false,"refSections":[{"refs":[{"id":"ref-for-interface-declaration"}],"title":"8.3.2. Bases"},{"refs":[{"id":"ref-for-interface-declaration\u2460"},{"id":"ref-for-interface-declaration\u2461"}],"title":"8.3.5. Associated Types"}],"url":"#interface-declaration"},
"introduces": {"dfnID":"introduces","dfnText":"introduces","external":false,"refSections":[],"url":"#introduces"},
"kernels": {"dfnID":"kernels","dfnText":"kernels","external":false,"refSections":[],"url":"#kernels"},
"lexeme": {"dfnID":"lexeme","dfnText":"lexeme","external":false,"refSections":[{"refs":[{"id":"ref-for-lexeme"}],"title":"2. Lexical Structure"},{"refs":[{"id":"ref-for-lexeme\u2460"},{"id":"ref-for-lexeme\u2461"}],"title":"2.4. Lexemes"},{"refs":[{"id":"ref-for-lexeme\u2462"},{"id":"ref-for-lexeme\u2463"}],"title":"2.4.1. Trivia"}],"url":"#lexeme"},
"lexing": {"dfnID":"lexing","dfnText":"Lexing","external":false,"refSections":[],"url":"#lexing"},
"line-break": {"dfnID":"line-break","dfnText":"line break","external":false,"refSections":[{"refs":[{"id":"ref-for-line-break"}],"title":"2.3. Phases"},{"refs":[{"id":"ref-for-line-break\u2460"}],"title":"2.4.1.1. Whitespace"},{"refs":[{"id":"ref-for-line-break\u2461"},{"id":"ref-for-line-break\u2462"}],"title":"2.4.1.1.1. Line Breaks"},{"refs":[{"id":"ref-for-line-break\u2463"},{"id":"ref-for-line-break\u2464"},{"id":"ref-for-line-break\u2465"}],"title":"2.4.1.2. Comments"}],"url":"#line-break"},
"line-comment": {"dfnID":"line-comment","dfnText":"line comment","external":false,"refSections":[{"refs":[{"id":"ref-for-line-comment"},{"id":"ref-for-line-comment\u2460"}],"title":"2.4.1.2. Comments"}],"url":"#line-comment"},
"lines": {"dfnID":"lines","dfnText":"lines","external":false,"refSections":[],"url":"#lines"},
"local-scope": {"dfnID":"local-scope","dfnText":"local scope","external":false,"refSections":[],"url":"#local-scope"},
"local-variable": {"dfnID":"local-variable","dfnText":"local variable","external":false,"refSections":[],"url":"#local-variable"},
"locations": {"dfnID":"locations","dfnText":"locations","external":false,"refSections":[],"url":"#locations"},
"memory-spaces": {"dfnID":"memory-spaces","dfnText":"memory spaces","external":false,"refSections":[],"url":"#memory-spaces"},
"methods": {"dfnID":"methods","dfnText":"methods","external":false,"refSections":[],"url":"#methods"},
"modern-enum-declaration": {"dfnID":"modern-enum-declaration","dfnText":"modern enum declaration","external":false,"refSections":[],"url":"#modern-enum-declaration"},
"module-declaration": {"dfnID":"module-declaration","dfnText":"module declaration","external":false,"refSections":[{"refs":[{"id":"ref-for-module-declaration"},{"id":"ref-for-module-declaration\u2460"},{"id":"ref-for-module-declaration\u2461"},{"id":"ref-for-module-declaration\u2462"}],"title":"7.1. Primary Source Unit"},{"refs":[{"id":"ref-for-module-declaration\u2463"}],"title":"7.2.2. Implementing Declarations"}],"url":"#module-declaration"},
"module①": {"dfnID":"module\u2460","dfnText":"module","external":false,"refSections":[{"refs":[{"id":"ref-for-module\u2460"}],"title":"7.2.1. Include Declarations"}],"url":"#module\u2460"},
"numeric-literal": {"dfnID":"numeric-literal","dfnText":"numeric literal","external":false,"refSections":[],"url":"#numeric-literal"},
"numeric-literal-suffix": {"dfnID":"numeric-literal-suffix","dfnText":"numeric literal suffix","external":false,"refSections":[],"url":"#numeric-literal-suffix"},
"objects": {"dfnID":"objects","dfnText":"objects","external":false,"refSections":[],"url":"#objects"},
"ordered": {"dfnID":"ordered","dfnText":"ordered","external":false,"refSections":[],"url":"#ordered"},
"output-environment": {"dfnID":"output-environment","dfnText":"output environment","external":false,"refSections":[],"url":"#output-environment"},
"parameter-declarations": {"dfnID":"parameter-declarations","dfnText":"parameter declarations","external":false,"refSections":[],"url":"#parameter-declarations"},
"parent-environment": {"dfnID":"parent-environment","dfnText":"parent environment","external":false,"refSections":[],"url":"#parent-environment"},
"parsing": {"dfnID":"parsing","dfnText":"Parsing","external":false,"refSections":[],"url":"#parsing"},
"pipelines": {"dfnID":"pipelines","dfnText":"pipelines","external":false,"refSections":[],"url":"#pipelines"},
"primary-source-unit": {"dfnID":"primary-source-unit","dfnText":"primary source unit","external":false,"refSections":[{"refs":[{"id":"ref-for-primary-source-unit"},{"id":"ref-for-primary-source-unit\u2460"},{"id":"ref-for-primary-source-unit\u2461"},{"id":"ref-for-primary-source-unit\u2462"}],"title":"7.1. Primary Source Unit"},{"refs":[{"id":"ref-for-primary-source-unit\u2463"}],"title":"7.2. Seconary Source Units"}],"url":"#primary-source-unit"},
"property-declaration": {"dfnID":"property-declaration","dfnText":"property declaration","external":false,"refSections":[],"url":"#property-declaration"},
"radix-specifier": {"dfnID":"radix-specifier","dfnText":"radix specifier","external":false,"refSections":[],"url":"#radix-specifier"},
"result-type": {"dfnID":"result-type","dfnText":"result type","external":false,"refSections":[],"url":"#result-type"},
"retroactive-conformance": {"dfnID":"retroactive-conformance","dfnText":"retroactive conformance","external":false,"refSections":[],"url":"#retroactive-conformance"},
"scope": {"dfnID":"scope","dfnText":"scope","external":false,"refSections":[],"url":"#scope"},
"secondary-source-units": {"dfnID":"secondary-source-units","dfnText":"secondary source units","external":false,"refSections":[{"refs":[{"id":"ref-for-secondary-source-units"},{"id":"ref-for-secondary-source-units\u2460"}],"title":"7.2.2. Implementing Declarations"}],"url":"#secondary-source-units"},
"sign": {"dfnID":"sign","dfnText":"sign","external":false,"refSections":[],"url":"#sign"},
"source-unit": {"dfnID":"source-unit","dfnText":"source unit","external":false,"refSections":[{"refs":[{"id":"ref-for-source-unit"}],"title":"2. Lexical Structure"},{"refs":[{"id":"ref-for-source-unit\u2460"}],"title":"2.1. Source Units"},{"refs":[{"id":"ref-for-source-unit\u2461"},{"id":"ref-for-source-unit\u2462"}],"title":"2.2. Encoding"},{"refs":[{"id":"ref-for-source-unit\u2463"},{"id":"ref-for-source-unit\u2464"}],"title":"2.3. Phases"},{"refs":[{"id":"ref-for-source-unit\u2465"},{"id":"ref-for-source-unit\u2466"}],"title":"2.4. Lexemes"},{"refs":[{"id":"ref-for-source-unit\u2467"},{"id":"ref-for-source-unit\u2468"}],"title":"2.4.1.1.1. Line Breaks"},{"refs":[{"id":"ref-for-source-unit\u2460\u24ea"},{"id":"ref-for-source-unit\u2460\u2460"},{"id":"ref-for-source-unit\u2460\u2461"}],"title":"2.4.1.2. Comments"},{"refs":[{"id":"ref-for-source-unit\u2460\u2462"},{"id":"ref-for-source-unit\u2460\u2463"}],"title":"3. Preprocessor"},{"refs":[{"id":"ref-for-source-unit\u2460\u2464"},{"id":"ref-for-source-unit\u2460\u2465"},{"id":"ref-for-source-unit\u2460\u2466"},{"id":"ref-for-source-unit\u2460\u2467"},{"id":"ref-for-source-unit\u2460\u2468"},{"id":"ref-for-source-unit\u2461\u24ea"}],"title":"7.1. Primary Source Unit"},{"refs":[{"id":"ref-for-source-unit\u2461\u2460"}],"title":"7.2. Seconary Source Units"},{"refs":[{"id":"ref-for-source-unit\u2461\u2461"},{"id":"ref-for-source-unit\u2461\u2462"},{"id":"ref-for-source-unit\u2461\u2463"},{"id":"ref-for-source-unit\u2461\u2464"},{"id":"ref-for-source-unit\u2461\u2465"},{"id":"ref-for-source-unit\u2461\u2466"},{"id":"ref-for-source-unit\u2461\u2467"}],"title":"7.2.1. Include Declarations"},{"refs":[{"id":"ref-for-source-unit\u2461\u2468"},{"id":"ref-for-source-unit\u2462\u24ea"},{"id":"ref-for-source-unit\u2462\u2460"},{"id":"ref-for-source-unit\u2462\u2461"},{"id":"ref-for-source-unit\u2462\u2462"},{"id":"ref-for-source-unit\u2462\u2463"},{"id":"ref-for-source-unit\u2462\u2464"}],"title":"7.2.2. Implementing Declarations"},{"refs":[{"id":"ref-for-source-unit\u2462\u2465"},{"id":"ref-for-source-unit\u2462\u2466"},{"id":"ref-for-source-unit\u2462\u2467"},{"id":"ref-for-source-unit\u2462\u2468"},{"id":"ref-for-source-unit\u2463\u24ea"}],"title":"7.3. Import Declarations"},{"refs":[{"id":"ref-for-source-unit\u2463\u2460"}],"title":"8. Declarations"}],"url":"#source-unit"},
"specialized": {"dfnID":"specialized","dfnText":"specialized","external":false,"refSections":[],"url":"#specialized"},
"stages": {"dfnID":"stages","dfnText":"stages","external":false,"refSections":[],"url":"#stages"},
"standard-library": {"dfnID":"standard-library","dfnText":"standard library","external":false,"refSections":[],"url":"#standard-library"},
"statement": {"dfnID":"statement","dfnText":"statement","external":false,"refSections":[{"refs":[{"id":"ref-for-statement"}],"title":"4.3. Statements"},{"refs":[{"id":"ref-for-statement\u2460"}],"title":"5.2.1. Ordered"}],"url":"#statement"},
"static-global-variable": {"dfnID":"static-global-variable","dfnText":"static global variable","external":false,"refSections":[],"url":"#static-global-variable"},
"static-members": {"dfnID":"static-members","dfnText":"static members","external":false,"refSections":[],"url":"#static-members"},
"string-literal": {"dfnID":"string-literal","dfnText":"string literal","external":false,"refSections":[],"url":"#string-literal"},
"struct-declaration": {"dfnID":"struct-declaration","dfnText":"struct declaration","external":false,"refSections":[],"url":"#struct-declaration"},
"subscript-declaration": {"dfnID":"subscript-declaration","dfnText":"subscript declaration","external":false,"refSections":[],"url":"#subscript-declaration"},
"switch-statement": {"dfnID":"switch-statement","dfnText":"switch statement","external":false,"refSections":[{"refs":[{"id":"ref-for-switch-statement"},{"id":"ref-for-switch-statement\u2460"}],"title":"11.7.1. break Statement"}],"url":"#switch-statement"},
"synthesis-judgement": {"dfnID":"synthesis-judgement","dfnText":"synthesis judgement","external":false,"refSections":[],"url":"#synthesis-judgement"},
"synthesizes": {"dfnID":"synthesizes","dfnText":"synthesizes","external":false,"refSections":[],"url":"#synthesizes"},
"tokens": {"dfnID":"tokens","dfnText":"Tokens","external":false,"refSections":[{"refs":[{"id":"ref-for-tokens"},{"id":"ref-for-tokens\u2460"}],"title":"2.3. Phases"},{"refs":[{"id":"ref-for-tokens\u2461"}],"title":"2.4. Lexemes"}],"url":"#tokens"},
"traditional-buffer-declaration": {"dfnID":"traditional-buffer-declaration","dfnText":"traditional buffer declaration","external":false,"refSections":[],"url":"#traditional-buffer-declaration"},
"traditional-case-declarations": {"dfnID":"traditional-case-declarations","dfnText":"traditional case declarations","external":false,"refSections":[],"url":"#traditional-case-declarations"},
"traditional-enum-declaration": {"dfnID":"traditional-enum-declaration","dfnText":"traditional enum declaration","external":false,"refSections":[],"url":"#traditional-enum-declaration"},
"traditional-function-declaration": {"dfnID":"traditional-function-declaration","dfnText":"traditional function declaration","external":false,"refSections":[],"url":"#traditional-function-declaration"},
"traditional-type-alias-declaration": {"dfnID":"traditional-type-alias-declaration","dfnText":"traditional type alias declaration","external":false,"refSections":[],"url":"#traditional-type-alias-declaration"},
"trivia①": {"dfnID":"trivia\u2460","dfnText":"Trivia","external":false,"refSections":[{"refs":[{"id":"ref-for-trivia\u2460"}],"title":"2.4. Lexemes"},{"refs":[{"id":"ref-for-trivia\u2460\u2460"}],"title":"2.4.1. Trivia"}],"url":"#trivia\u2460"},
"type-alias-declaration": {"dfnID":"type-alias-declaration","dfnText":"type alias declaration","external":false,"refSections":[],"url":"#type-alias-declaration"},
"type-declaration": {"dfnID":"type-declaration","dfnText":"type declaration","external":false,"refSections":[],"url":"#type-declaration"},
"underlying-type": {"dfnID":"underlying-type","dfnText":"underlying type","external":false,"refSections":[],"url":"#underlying-type"},
"underlying-value": {"dfnID":"underlying-value","dfnText":"underlying value","external":false,"refSections":[],"url":"#underlying-value"},
"uniform": {"dfnID":"uniform","dfnText":"uniform","external":false,"refSections":[{"refs":[{"id":"ref-for-uniform"}],"title":"6. Execution Model"}],"url":"#uniform"},
"unordered": {"dfnID":"unordered","dfnText":"unordered","external":false,"refSections":[],"url":"#unordered"},
"variable": {"dfnID":"variable","dfnText":"variable","external":false,"refSections":[],"url":"#variable"},
"variable-declaration": {"dfnID":"variable-declaration","dfnText":"variable declaration","external":false,"refSections":[],"url":"#variable-declaration"},
"varying": {"dfnID":"varying","dfnText":"varying","external":false,"refSections":[],"url":"#varying"},
"whitespace①": {"dfnID":"whitespace\u2460","dfnText":"Whitespace","external":false,"refSections":[],"url":"#whitespace\u2460"},
};

document.addEventListener("DOMContentLoaded", ()=>{
    genAllDfnPanels();

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });
});

window.addEventListener("resize", () => {
    // Pin any visible dfn panel
    queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>positionDfnPanel(el));
});

function genAllDfnPanels() {
    for(const panelData of Object.values(dfnPanelData)) {
        const dfnID = panelData.dfnID;
        const dfn = document.getElementById(dfnID);
        if(!dfn) {
            console.log(`Can't find dfn#${dfnID}.`, panelData);
            continue;
        }
        dfn.panelData = panelData;
        insertDfnPopupAction(dfn);
    }
}

function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
    const dfnPanel = mk.aside({
        class: "dfn-panel on",
        id: `infopanel-for-${dfnID}`,
        "data-for": dfnID,
        "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
        },
        mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
            `Info about the '${dfnText}' ${external?"external":""} reference.`),
        mk.a({href:url, class:"dfn-link"}, url),
        refSections.length == 0 ? [] :
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({ href: `#${ref.id}` },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        genLinkingSyntaxes(dfn),
    );

    dfnPanel.addEventListener('click', (event) => {
        if (event.target.nodeName == 'A') {
            scrollToTargetAndHighlight(event);
            pinDfnPanel(dfnPanel);
        }
        event.stopPropagation();
        refocusOnTarget(event);
    });
    dfnPanel.addEventListener('keydown', (event) => {
        if(event.keyCode == 27) { // Escape key
            hideDfnPanel({dfnPanel});
            event.stopPropagation();
            event.preventDefault();
        }
    });

    dfnPanel.dfn = dfn;
    dfn.dfnPanel = dfnPanel;
    return dfnPanel;
}



function hideAllDfnPanels() {
    // Delete the currently-active dfn panel.
    queryAll(".dfn-panel").forEach(dfnPanel=>hideDfnPanel({dfnPanel}));
}

function showDfnPanel(dfn) {
    hideAllDfnPanels(); // Only display one at a time.

    dfn.setAttribute("aria-expanded", "true");

    const dfnPanel = genDfnPanel(dfn, dfn.panelData);

    // Give the dfn a unique tabindex, and then
    // give all the tabbable panel bits successive indexes.
    let tabIndex = 100;
    dfn.tabIndex = tabIndex++;
    const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
    for (const el of tabbable) {
        el.tabIndex = tabIndex++;
    }

    append(document.body, dfnPanel);
    positionDfnPanel(dfnPanel);
}

function positionDfnPanel(dfnPanel) {
    const dfn = dfnPanel.dfn;
    const dfnPos = getBounds(dfn);
    dfnPanel.style.top = dfnPos.bottom + "px";
    dfnPanel.style.left = dfnPos.left + "px";

    const panelPos = dfnPanel.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
        dfnPanel.style.left = newLeft + "px";
    }
}

function pinDfnPanel(dfnPanel) {
    // Switch it to "activated" state, which pins it.
    dfnPanel.classList.add("activated");
    dfnPanel.style.position = "fixed";
    dfnPanel.style.left = null;
    dfnPanel.style.top = null;
}

function hideDfnPanel({dfn, dfnPanel}) {
    if(!dfnPanel) dfnPanel = dfn.dfnPanel;
    if(!dfn) dfn = dfnPanel.dfn;
    dfn.dfnPanel = undefined;
    dfnPanel.dfn = undefined;
    dfn.setAttribute("aria-expanded", "false");
    dfn.tabIndex = undefined;
    dfnPanel.remove()
}

function toggleDfnPanel(dfn) {
    if(dfn.dfnPanel) {
        hideDfnPanel(dfn);
    } else {
        showDfnPanel(dfn);
    }
}

function insertDfnPopupAction(dfn) {
    dfn.setAttribute('role', 'button');
    dfn.setAttribute('aria-expanded', 'false')
    dfn.tabIndex = 0;
    dfn.classList.add('has-dfn-panel');
    dfn.addEventListener('click', (event) => {
        toggleDfnPanel(dfn);
        event.stopPropagation();
    });
    dfn.addEventListener('keypress', (event) => {
        const kc = event.keyCode;
        // 32->Space, 13->Enter
        if(kc == 32 || kc == 13) {
            toggleDfnPanel(dfn);
            event.stopPropagation();
            event.preventDefault();
        }
    });
}

function refocusOnTarget(event) {
    const target = event.target;
    setTimeout(() => {
        // Refocus on the event.target element.
        // This is needed after browser scrolls to the destination.
        target.focus();
    });
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function scrollToTargetAndHighlight(event) {
    let hash = event.target.hash;
    if (hash) {
        hash = decodeURIComponent(hash.substring(1));
        const dest = document.getElementById(hash);
        if (dest) {
            dest.classList.add('highlighted');
            setTimeout(() => dest.classList.remove('highlighted'), 1000);
        }
    }
}

// Functions, divided by link type, that wrap an autolink's
// contents with the appropriate outer syntax.
// Alternately, a string naming another type they format
// the same as.
function needsFor(type) {
    switch(type) {
        case "descriptor":
        case "value":
        case "element-attr":
        case "attr-value":
        case "element-state":
        case "method":
        case "constructor":
        case "argument":
        case "attribute":
        case "const":
        case "dict-member":
        case "event":
        case "enum-value":
        case "stringifier":
        case "serializer":
        case "iterator":
        case "maplike":
        case "setlike":
        case "state":
        case "mode":
        case "context":
        case "facet": return true;

        default: return false;
    }
}
function refusesFor(type) {
    switch(type) {
        case "property":
        case "element":
        case "interface":
        case "namespace":
        case "callback":
        case "dictionary":
        case "enum":
        case "exception":
        case "typedef":
        case "http-header":
        case "permission": return true;

        default: return false;
    }
}
function linkFormatterFromType(type) {
    switch(type) {
        case 'scheme':
        case 'permission':
        case 'dfn': return (text) => `[=${text}=]`;

        case 'abstract-op': return (text) => `[\$${text}\$]`;

        case 'function':
        case 'at-rule':
        case 'selector':
        case 'value': return (text) => `''${text}''`;

        case 'http-header': return (text) => `[:${text}:]`;

        case 'interface':
        case 'constructor':
        case 'method':
        case 'argument':
        case 'attribute':
        case 'callback':
        case 'dictionary':
        case 'dict-member':
        case 'enum':
        case 'enum-value':
        case 'exception':
        case 'const':
        case 'typedef':
        case 'stringifier':
        case 'serializer':
        case 'iterator':
        case 'maplike':
        case 'setlike':
        case 'extended-attribute':
        case 'event':
        case 'idl': return (text) => `{{${text}}}`;

        case 'element-state':
        case 'element-attr':
        case 'attr-value':
        case 'element': return (element) => `<{${element}}>`;

        case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

        case 'type': return (text)=> `<<${text}>>`;

        case 'descriptor':
        case 'property': return (text) => `'${text}'`;

        default: return;
    };
};

function genLinkingSyntaxes(dfn) {
    if(dfn.tagName != "DFN") return;

    const type = dfn.getAttribute('data-dfn-type');
    if(!type) {
        console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
        return [];
    }

    // Return a function that wraps link text based on the type
    const linkFormatter = linkFormatterFromType(type);
    if(!linkFormatter) {
        console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
        return [];
    }

    let ltAlts;
    if(dfn.hasAttribute('data-lt')) {
        ltAlts = dfn.getAttribute('data-lt')
            .split("|")
            .map(x=>x.trim());
    } else {
        ltAlts = [dfn.textContent.trim()];
    }
    if(type == "type") {
        // lt of "<foo>", but "foo" is the interior;
        // <<foo/bar>> is how you write it with a for,
        // not <foo/<bar>> or whatever.
        for(var i = 0; i < ltAlts.length; i++) {
            const lt = ltAlts[i];
            const match = /<(.*)>/.exec(lt);
            if(match) { ltAlts[i] = match[1]; }
        }
    }

    let forAlts;
    if(dfn.hasAttribute('data-dfn-for')) {
        forAlts = dfn.getAttribute('data-dfn-for')
            .split(",")
            .map(x=>x.trim());
    } else {
        forAlts = [''];
    }

    let linkingSyntaxes = [];
    if(!needsFor(type)) {
        for(const lt of ltAlts) {
            linkingSyntaxes.push(linkFormatter(lt));
        }
    }
    if(!refusesFor(type)) {
        for(const f of forAlts) {
            linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
        }
    }
    return [
        mk.b({}, 'Possible linking syntaxes:'),
        mk.ul({},
            ...linkingSyntaxes.map(link => {
                const copyLink = async () =>
                    await navigator.clipboard.writeText(link);
                return mk.li({},
                    mk.div({ class: 'link-item' },
                        mk.button({
                            class: 'copy-icon', title: 'Copy',
                            type: 'button',
                            _onclick: copyLink,
                            tabindex: 0,
                        }, mk.span({ class: 'icon' }) ),
                        mk.span({}, link)
                    )
                );
            })
        )
    ];
}
}
</script>
<script>/* Boilerplate: script-ref-hints */
"use strict";
{
let refsData = {
"#bindings": {"displayText":"bindings","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"bindings","type":"dfn","url":"#bindings"},
"#block-comment": {"displayText":"block comment","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"block comment","type":"dfn","url":"#block-comment"},
"#character": {"displayText":"character","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"character","type":"dfn","url":"#character"},
"#checking-judgement": {"displayText":"checking judgement","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"checking judgement","type":"dfn","url":"#checking-judgement"},
"#checks": {"displayText":"checks","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"checks","type":"dfn","url":"#checks"},
"#context": {"displayText":"context","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"context","type":"dfn","url":"#context"},
"#declaration": {"displayText":"declaration","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"declaration","type":"dfn","url":"#declaration"},
"#enum-declaration": {"displayText":"enum declaration","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"enum declaration","type":"dfn","url":"#enum-declaration"},
"#escaped-line-break": {"displayText":"escaped line break","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"escaped line break","type":"dfn","url":"#escaped-line-break"},
"#floating-point-literal": {"displayText":"floating-point literal","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"floating-point literal","type":"dfn","url":"#floating-point-literal"},
"#generic-arguments": {"displayText":"generic arguments","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"generic arguments","type":"dfn","url":"#generic-arguments"},
"#horizontal-whitespace": {"displayText":"horizontal whitespace","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"horizontal whitespace","type":"dfn","url":"#horizontal-whitespace"},
"#implementing-declaration": {"displayText":"implementing declaration","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"implementing declaration","type":"dfn","url":"#implementing-declaration"},
"#include-declarations": {"displayText":"include declarations","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"include declarations","type":"dfn","url":"#include-declarations"},
"#integer-literal": {"displayText":"integer literal","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"integer literal","type":"dfn","url":"#integer-literal"},
"#interface-declaration": {"displayText":"interface declaration","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"interface declaration","type":"dfn","url":"#interface-declaration"},
"#lexeme": {"displayText":"lexeme","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"lexeme","type":"dfn","url":"#lexeme"},
"#line-break": {"displayText":"line break","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"line break","type":"dfn","url":"#line-break"},
"#line-comment": {"displayText":"line comment","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"line comment","type":"dfn","url":"#line-comment"},
"#module-declaration": {"displayText":"module declaration","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"module declaration","type":"dfn","url":"#module-declaration"},
"#module①": {"displayText":"module","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"module","type":"dfn","url":"#module\u2460"},
"#primary-source-unit": {"displayText":"primary source unit","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"primary source unit","type":"dfn","url":"#primary-source-unit"},
"#secondary-source-units": {"displayText":"secondary source units","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"secondary source units","type":"dfn","url":"#secondary-source-units"},
"#source-unit": {"displayText":"source unit","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"source unit","type":"dfn","url":"#source-unit"},
"#statement": {"displayText":"statement","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"statement","type":"dfn","url":"#statement"},
"#switch-statement": {"displayText":"switch statement","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"switch statement","type":"dfn","url":"#switch-statement"},
"#tokens": {"displayText":"tokens","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"tokens","type":"dfn","url":"#tokens"},
"#trivia①": {"displayText":"trivia","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"trivia","type":"dfn","url":"#trivia\u2460"},
"#uniform": {"displayText":"uniform","export":true,"for_":[],"level":"1","normative":true,"shortname":"slang-language","spec":"slang-language-1","status":"local","text":"uniform","type":"dfn","url":"#uniform"},
"https://dom.spec.whatwg.org/#concept-document-type": {"displayText":"type","export":true,"for_":["Document"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"type","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-document-type"},
"https://drafts.csswg.org/css-values-4/#css-css-identifier": {"displayText":"identifier","export":true,"for_":["CSS"],"level":"4","normative":true,"shortname":"css-values","spec":"css-values-4","status":"current","text":"identifier","type":"dfn","url":"https://drafts.csswg.org/css-values-4/#css-css-identifier"},
"https://encoding.spec.whatwg.org/#label": {"displayText":"label","export":true,"for_":["encoding"],"level":"1","normative":true,"shortname":"encoding","spec":"encoding","status":"current","text":"label","type":"dfn","url":"https://encoding.spec.whatwg.org/#label"},
};

function mkRefHint(link, ref) {
    const linkText = link.textContent;
    let dfnTextElements = '';
    if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
        // Give the original term if it's being displayed in a different way.
        // But allow casing differences, they're insignificant.
        dfnTextElements =
            mk.li({},
                mk.b({}, "Term: "),
                mk.span({}, ref.displayText)
            );
    }
    const forList = ref.for_;
    let forListElements;
    if(forList.length == 0) {
        forListElements = [];
    } else if(forList.length == 1) {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.span({}, forList[0]),
        );
    } else {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.ul({},
                ...forList.map(forItem =>
                    mk.li({},
                        mk.span({}, forItem)
                    ),
                ),
            ),
        );
    }
    const url = ref.url;
    const safeUrl = encodeURIComponent(url);
    const hintPanel = mk.aside({
        class: "ref-hint",
        id: `ref-hint-for-${safeUrl}`,
        "data-for": url,
        "aria-labelled-by": `ref-hint-for-${safeUrl}`,
    },
        mk.ul({},
            dfnTextElements,
            mk.li({},
                mk.b({}, "URL: "),
                mk.a({ href: url, class: "ref" }, url),
            ),
            mk.li({},
                mk.b({}, "Type: "),
                mk.span({}, `${ref.type}`),
            ),
            mk.li({},
                mk.b({}, "Spec: "),
                mk.span({}, `${ref.spec ? ref.spec : ''}`),
            ),
            forListElements
        ),
    );
    hintPanel.forLink = link;
    setupRefHintEventListeners(link, hintPanel);
    return hintPanel;
}

function hideAllRefHints() {
    queryAll(".ref-hint").forEach(el=>hideRefHint(el));
}

function hideRefHint(refHint) {
    const link = refHint.forLink;
    link.setAttribute("aria-expanded", "false");
    if(refHint.teardownEventListeners) {
        refHint.teardownEventListeners();
    }
    refHint.remove();
}

function showRefHint(link) {
    if(link.classList.contains("dfn-link")) return;
    const url = link.getAttribute("href");
    const ref = refsData[url];
    if(!ref) return;

    hideAllRefHints(); // Only display one at this time.

    const refHint = mkRefHint(link, ref);
    append(document.body, refHint);
    link.setAttribute("aria-expanded", "true");
    positionRefHint(refHint);
}

function setupRefHintEventListeners(link, refHint) {
    if (refHint.teardownEventListeners) return;
    // Add event handlers to hide the refHint after the user moves away
    // from both the link and refHint, if not hovering either within one second.
    let timeout = null;
    const startHidingRefHint = (event) => {
        if (timeout) {
            clearTimeout(timeout);
        }
        timeout = setTimeout(() => {
            hideRefHint(refHint);
        }, 1000);
    }
    const resetHidingRefHint = (event) => {
        if (timeout) clearTimeout(timeout);
        timeout = null;
    };
    link.addEventListener("mouseleave", startHidingRefHint);
    link.addEventListener("mouseenter", resetHidingRefHint);
    link.addEventListener("blur", startHidingRefHint);
    link.addEventListener("focus", resetHidingRefHint);
    refHint.addEventListener("mouseleave", startHidingRefHint);
    refHint.addEventListener("mouseenter", resetHidingRefHint);
    refHint.addEventListener("blur", startHidingRefHint);
    refHint.addEventListener("focus", resetHidingRefHint);

    refHint.teardownEventListeners = () => {
        // remove event listeners
        resetHidingRefHint();
        link.removeEventListener("mouseleave", startHidingRefHint);
        link.removeEventListener("mouseenter", resetHidingRefHint);
        link.removeEventListener("blur", startHidingRefHint);
        link.removeEventListener("focus", resetHidingRefHint);
        refHint.removeEventListener("mouseleave", startHidingRefHint);
        refHint.removeEventListener("mouseenter", resetHidingRefHint);
        refHint.removeEventListener("blur", startHidingRefHint);
        refHint.removeEventListener("focus", resetHidingRefHint);
    };
}

function positionRefHint(refHint) {
    const link = refHint.forLink;
    const linkPos = getBounds(link);
    refHint.style.top = linkPos.bottom + "px";
    refHint.style.left = linkPos.left + "px";

    const panelPos = refHint.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
        refHint.style.left = newLeft + "px";
    }
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function showRefHintListener(e) {
    // If the target isn't in a link (or is a link),
    // just ignore it.
    let link = e.target.closest("a");
    if(!link) return;

    // If the target is in a ref-hint panel
    // (aka a link in the already-open one),
    // also just ignore it.
    if(link.closest(".ref-hint")) return;

    // Otherwise, show the panel for the link.
    showRefHint(link);
}

function hideAllHintsListener(e) {
    // If the click is inside a ref-hint panel, ignore it.
    if(e.target.closest(".ref-hint")) return;
    // Otherwise, close all the current panels.
    hideAllRefHints();
}

document.addEventListener("DOMContentLoaded", () => {
    document.body.addEventListener("mousedown", showRefHintListener);
    document.body.addEventListener("focus", showRefHintListener);

    document.body.addEventListener("click", hideAllHintsListener);
});

window.addEventListener("resize", () => {
    // Hide any open ref hint.
    hideAllRefHints();
});
}
</script>
<script>/* Boilerplate: script-var-click-highlighting */
"use strict";
{
/*
Color-choosing design:

* Colors are ordered by goodness.
* On clicking a var, give it the earliest color
    with the lowest usage in the algorithm.
* On re-clicking, re-use the var's most recent color
    if that's not currently being used elsewhere.
*/

const COLOR_COUNT = 7;

document.addEventListener("click", e=>{
    if(e.target.nodeName == "VAR") {
        highlightSameAlgoVars(e.target);
    }
});

function highlightSameAlgoVars(v) {
    // Find the algorithm container.
    let algoContainer = findAlgoContainer(v);

    // Not highlighting document-global vars,
    // too likely to be unrelated.
    if(algoContainer == null) return;

    const varName = nameFromVar(v);
    if(!v.hasAttribute("data-var-color")) {
        const newColor = chooseHighlightColor(algoContainer, v);
        for(const el of algoContainer.querySelectorAll("var")) {
            if(nameFromVar(el) == varName) {
                el.setAttribute("data-var-color", newColor);
                el.setAttribute("data-var-last-color", newColor);
            }
        }
    } else {
        for(const el of algoContainer.querySelectorAll("var")) {
            if(nameFromVar(el) == varName) {
                el.removeAttribute("data-var-color");
            }
        }
    }
}
function findAlgoContainer(el) {
    while(el != document.body) {
        if(el.hasAttribute("data-algorithm")) return el;
        el = el.parentNode;
    }
    return null;
}
function nameFromVar(el) {
    return el.textContent.replace(/(\s|\xa0)+/g, " ").trim();
}
function colorCountsFromContainer(container) {
    const namesFromColor = Array.from({length:COLOR_COUNT}, x=>new Set());
    for(let v of container.querySelectorAll("var[data-var-color]")) {
        let color = +v.getAttribute("data-var-color");
        namesFromColor[color].add(nameFromVar(v));
    }

    return namesFromColor.map(x=>x.size);
}
function leastUsedColor(colors) {
    // Find the earliest color with the lowest count.
    let minCount = Infinity;
    let minColor = null;
    for(var i = 0; i < colors.length; i++) {
        if(colors[i] < minCount) {
            minColor = i;
            minCount = colors[i];
        }
    }
    return minColor;
}
function chooseHighlightColor(container, v) {
    const colorCounts = colorCountsFromContainer(container);
    if(v.hasAttribute("data-var-last-color")) {
        let color = +v.getAttribute("data-var-last-color");
        if(colorCounts[color] == 0) return color;
    }
    return leastUsedColor(colorCounts);
}
}
</script>